# 3.6 `tvc()` Helper

## Table of Contents
- [3.1 `cls()` Function](./3.1-cls-function.md)
- [3.2 `extend()` Method](./3.2-extend-method.md)
- [3.3 `contract()` Helper](./3.3-contract-helper.md)
- [3.4 `use()` Method](./3.4-use-method.md)
- [3.5 `merge()` Utility](./3.5-merge-utility.md)
- [3.6 `tvc()` Helper](./3.6-tvc-helper.md) *(current)*
- [3.7 What Utility](./3.7-what-utility.md)
- [3.8 Definition Helpers](./3.8-definition-helpers.md)
- [3.9 Override Helpers](./3.9-override-helpers.md)
- [3.10 Override System Deep Dive](./3.10-override-system-deep-dive.md)

---

The `tvc()` helper is CLS's **class string merger** - it's a wrapper around `tailwind-merge` that provides intelligent class deduplication and conflict resolution! Think of it as a "smart class combiner" that knows how to handle Tailwind CSS conflicts and deduplication. Let's explore how it works! üéØ

## Function Signature üìã

```typescript
function tvc(...classes: (string | undefined | null | false)[]): string
```

**Parameters:**
- `...classes`: Class strings to merge (can include undefined, null, or false for conditional classes)

**Returns:** A deduplicated and conflict-resolved class string

## Basic Usage üöÄ

### Simple Class Merging

```typescript
import { tvc } from "@use-pico/cls";

// Basic class merging
const classes = tvc(
  "px-4 py-2",
  "bg-blue-500",
  "text-white",
  "rounded-lg"
);
// Result: "px-4 py-2 bg-blue-500 text-white rounded-lg"

// Handle conditional classes
const isActive = true;
const isDisabled = false;

const buttonClasses = tvc(
  "px-4 py-2 rounded",
  isActive && "bg-blue-500 text-white",
  isDisabled && "bg-gray-300 text-gray-500 cursor-not-allowed"
);
// Result: "px-4 py-2 rounded bg-blue-500 text-white"
```

## Tailwind Conflict Resolution üîÑ

### Automatic Conflict Resolution

```typescript
import { tvc } from "@use-pico/cls";

// Tailwind conflicts are automatically resolved
const classes = tvc(
  "px-4 py-2",      // padding
  "px-6 py-3"       // conflicting padding (overrides previous)
);
// Result: "px-6 py-3" (later classes win)

// Color conflicts
const buttonClasses = tvc(
  "bg-blue-500 text-white",
  "bg-red-500"      // overrides bg-blue-500
);
// Result: "bg-red-500 text-white"

// Size conflicts
const textClasses = tvc(
  "text-sm font-medium",
  "text-lg"         // overrides text-sm
);
// Result: "text-lg font-medium"
```

### Complex Conflict Scenarios

```typescript
import { tvc } from "@use-pico/cls";

// Multiple conflicts resolved intelligently
const classes = tvc(
  "px-4 py-2 bg-blue-500 text-white rounded",
  "px-6 bg-red-500",           // overrides px-4, bg-blue-500
  "py-3 text-black"            // overrides py-2, text-white
);
// Result: "px-6 py-3 bg-red-500 text-black rounded"

// Responsive conflicts
const responsiveClasses = tvc(
  "text-sm md:text-base lg:text-lg",
  "text-lg md:text-xl"         // overrides all responsive variants
);
// Result: "text-lg md:text-xl"

// State conflicts
const stateClasses = tvc(
  "bg-blue-500 hover:bg-blue-600 focus:bg-blue-700",
  "hover:bg-red-600 focus:bg-red-700"  // overrides hover and focus states
);
// Result: "bg-blue-500 hover:bg-red-600 focus:bg-red-700"
```

## Integration with CLS üé®

### Using tvc() in CLS Definitions

```typescript
import { cls, tvc } from "@use-pico/cls";

const ButtonCls = cls({
  tokens: {
    "color.bg": ["default", "primary", "danger"],
    "color.text": ["default", "primary", "danger"]
  },
  slot: ["root", "label"],
  variant: {
    size: ["sm", "md", "lg"],
    tone: ["default", "primary", "danger"]
  }
}, ({ what, def }) => ({
  token: def.token({
    "color.bg": {
      default: ["bg-gray-100"],
      primary: ["bg-blue-600"],
      danger: ["bg-red-500"]
    },
    "color.text": {
      default: ["text-gray-900"],
      primary: ["text-white"],
      danger: ["text-white"]
    }
  }),
  rules: [
    def.root({
      root: what.both(
        ["inline-flex", "items-center", "rounded"],
        ["color.bg.default", "color.text.default"]
      ),
      label: what.css(["font-medium"])
    }),
    def.rule(
      what.variant({ tone: "primary" }),
      { 
        root: what.token(["color.bg.primary", "color.text.primary"]),
        label: what.css(["font-semibold"])
      }
    )
  ],
  defaults: def.defaults({
    size: "md",
    tone: "default"
  })
}));

// Using tvc() to merge CLS classes with additional classes
const buttonClasses = ButtonCls.create(({ what }) => ({
  variant: what.variant({ tone: "primary", size: "lg" })
}));

// Merge with additional classes
const finalClasses = tvc(
  buttonClasses.root(),
  "shadow-lg",           // Add shadow
  "hover:shadow-xl",     // Add hover effect
  "focus:ring-2"         // Add focus ring
);
```

### Conditional Styling with tvc()

```typescript
import { cls, tvc } from "@use-pico/cls";

const CardCls = cls({
  tokens: {
    "color.bg": ["default", "primary", "secondary"],
    "spacing.padding": ["sm", "md", "lg"]
  },
  slot: ["root"],
  variant: {
    tone: ["default", "primary", "secondary"],
    elevated: ["bool"]
  }
}, ({ what, def }) => ({
  token: def.token({
    "color.bg": {
      default: ["bg-white"],
      primary: ["bg-blue-50"],
      secondary: ["bg-gray-50"]
    },
    "spacing.padding": {
      sm: ["p-3"],
      md: ["p-4"],
      lg: ["p-6"]
    }
  }),
  rules: [
    def.root({
      root: what.both(
        ["rounded-lg", "border", "border-gray-200"],
        ["color.bg.default", "spacing.padding.md"]
      )
    }),
    def.rule(
      what.variant({ elevated: true }),
      { root: what.css(["shadow-lg"]) }
    )
  ],
  defaults: def.defaults({
    tone: "default",
    elevated: false
  })
}));

// Dynamic styling with tvc()
const renderCard = (props: { tone: string; elevated: boolean; customClass?: string }) => {
  const cardClasses = CardCls.create(({ what }) => ({
    variant: what.variant({ 
      tone: props.tone as any, 
      elevated: props.elevated 
    })
  }));

  return tvc(
    cardClasses.root(),
    props.customClass,                    // Optional custom class
    props.elevated && "hover:shadow-xl",  // Conditional hover effect
    props.tone === "primary" && "border-blue-200" // Conditional border
  );
};
```

## Advanced Usage üåü

### Complex Conditional Logic

```typescript
import { tvc } from "@use-pico/cls";

const getButtonClasses = (props: {
  variant: "primary" | "secondary" | "danger";
  size: "sm" | "md" | "lg";
  disabled: boolean;
  loading: boolean;
  fullWidth: boolean;
}) => {
  return tvc(
    // Base classes
    "inline-flex items-center justify-center rounded font-medium transition-colors",
    
    // Size variants
    props.size === "sm" && "px-3 py-1.5 text-sm",
    props.size === "md" && "px-4 py-2 text-base",
    props.size === "lg" && "px-6 py-3 text-lg",
    
    // Variant colors
    props.variant === "primary" && "bg-blue-600 text-white hover:bg-blue-700",
    props.variant === "secondary" && "bg-gray-200 text-gray-900 hover:bg-gray-300",
    props.variant === "danger" && "bg-red-600 text-white hover:bg-red-700",
    
    // State classes
    props.disabled && "opacity-50 cursor-not-allowed",
    props.loading && "opacity-75 cursor-wait",
    
    // Layout classes
    props.fullWidth && "w-full",
    
    // Override disabled hover states
    props.disabled && "hover:bg-blue-600 hover:bg-gray-200 hover:bg-red-600"
  );
};
```

### Responsive and State Combinations

```typescript
import { tvc } from "@use-pico/cls";

const getResponsiveClasses = (props: {
  mobile: boolean;
  tablet: boolean;
  desktop: boolean;
}) => {
  return tvc(
    // Base mobile classes
    "text-sm px-3 py-2",
    
    // Tablet overrides
    props.tablet && "md:text-base md:px-4 md:py-3",
    
    // Desktop overrides
    props.desktop && "lg:text-lg lg:px-6 lg:py-4",
    
    // Responsive state combinations
    props.mobile && "bg-blue-500 md:bg-green-500 lg:bg-red-500",
    props.tablet && "md:bg-yellow-500 lg:bg-purple-500",
    props.desktop && "lg:bg-pink-500"
  );
};
```

## Performance Considerations ‚ö°

### Efficient Class Merging

```typescript
import { tvc } from "@use-pico/cls";

// ‚úÖ Good: tvc() is optimized for performance
const classes = tvc(
  "px-4 py-2",
  "bg-blue-500",
  "text-white"
);
// Fast merging with intelligent deduplication

// ‚úÖ Good: Handle conditional classes efficiently
const buttonClasses = tvc(
  "base-classes",
  isActive && "active-classes",
  isDisabled && "disabled-classes"
);
// Only processes truthy values

// ‚ùå Bad: Don't pre-process arrays unnecessarily
const classArray = ["px-4", "py-2", "bg-blue-500"];
const classes = tvc(...classArray); // Unnecessary spread
```

### Caching Considerations

```typescript
import { tvc } from "@use-pico/cls";

// ‚úÖ Good: tvc() results can be cached
const getCachedClasses = (() => {
  const cache = new Map();
  
  return (key: string, ...classes: string[]) => {
    if (cache.has(key)) {
      return cache.get(key);
    }
    
    const result = tvc(...classes);
    cache.set(key, result);
    return result;
  };
})();

// ‚ùå Bad: Don't recreate tvc() calls unnecessarily
const getClasses = (props) => {
  return tvc(
    "base-classes",
    props.variant === "primary" && "primary-classes"
  ); // Called every time
};
```

## Best Practices üí°

### 1. **Use tvc() for Class Merging**
```typescript
// ‚úÖ Good: Use tvc() for merging class strings
const classes = tvc(
  baseClasses,
  conditionalClasses,
  additionalClasses
);

// ‚ùå Bad: Don't manually concatenate classes
const classes = `${baseClasses} ${conditionalClasses} ${additionalClasses}`;
```

### 2. **Handle Conditional Classes Properly**
```typescript
// ‚úÖ Good: Use logical operators for conditional classes
const classes = tvc(
  "base-classes",
  isActive && "active-classes",
  isDisabled && "disabled-classes"
);

// ‚ùå Bad: Don't use ternary operators unnecessarily
const classes = tvc(
  "base-classes",
  isActive ? "active-classes" : "",
  isDisabled ? "disabled-classes" : ""
);
```

### 3. **Order Classes Logically**
```typescript
// ‚úÖ Good: Logical order (base, variants, states, overrides)
const classes = tvc(
  "base-classes",                    // Base styles
  variantClasses,                    // Variant styles
  stateClasses,                      // State styles (hover, focus, etc.)
  overrideClasses                    // Override styles
);

// ‚ùå Bad: Random order makes it hard to understand
const classes = tvc(
  overrideClasses,
  baseClasses,
  stateClasses,
  variantClasses
);
```

### 4. **Use tvc() with CLS Results**
```typescript
// ‚úÖ Good: Merge CLS results with additional classes
const clsClasses = ButtonCls.create(({ what }) => ({
  variant: what.variant({ tone: "primary" })
}));

const finalClasses = tvc(
  clsClasses.root(),
  "custom-additional-classes"
);

// ‚ùå Bad: Don't manually merge CLS results
const finalClasses = `${clsClasses.root()} custom-additional-classes`;
```

## The Bottom Line üí°

The `tvc()` helper is CLS's **smart class merger**:

- **Intelligent deduplication**: Automatically resolves Tailwind conflicts
- **Conditional support**: Handles undefined, null, and false values gracefully
- **Performance optimized**: Fast merging with intelligent caching
- **CLS integration**: Perfect companion for CLS class results
- **Type safe**: Full TypeScript support

Think of `tvc()` as **"smart glue"** - it intelligently combines your class strings while resolving conflicts! üéâ

---

**Previous:** [3.5 `merge()` Utility](./3.5-merge-utility.md) | **Next:** [3.7 What Utility](./3.7-what-utility.md)
