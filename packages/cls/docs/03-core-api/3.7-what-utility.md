# 3.7 What Utility

## Table of Contents
- [3.1 `cls()` Function](./3.1-cls-function.md)
- [3.2 `extend()` Method](./3.2-extend-method.md)
- [3.3 `contract()` Helper](./3.3-contract-helper.md)
- [3.4 `use()` Method](./3.4-use-method.md)
- [3.5 `merge()` Utility](./3.5-merge-utility.md)
- [3.6 `tvc()` Helper](./3.6-tvc-helper.md)
- [3.7 What Utility](./3.7-what-utility.md) *(current)*
- [3.8 Definition Helpers](./3.8-definition-helpers.md)
- [3.9 Override Helpers](./3.9-override-helpers.md)
- [3.10 Override System Deep Dive](./3.10-override-system-deep-dive.md)

---

The `what` utility is CLS's **type-safe styling helper** - it provides a collection of methods for creating type-safe styling configurations! Think of it as your "styling toolkit" that ensures all your styling decisions are validated by TypeScript. Let's explore all the `what` methods! üéØ

## What is the What Utility? ü§î

The `what` utility is passed to your definition function and provides type-safe helpers for:

- **CSS classes**: `what.css()` - Direct CSS class strings
- **Token references**: `what.token()` - References to design tokens
- **Variant configurations**: `what.variant()` - Variant combinations
- **Combined styling**: `what.both()` - Mix CSS and tokens together

## what.css() - Direct CSS Classes üé®

### Basic Usage

```typescript
import { cls } from "@use-pico/cls";

const ButtonCls = cls({
  tokens: {
    "color.bg": ["default", "primary", "danger"]
  },
  slot: ["root", "label"],
  variant: {
    size: ["sm", "md", "lg"]
  }
}, ({ what, def }) => ({
  rules: [
    def.root({
      root: what.css(["inline-flex", "items-center", "rounded", "font-medium"]),
      label: what.css(["font-medium"])
    }),
    def.rule(
      what.variant({ size: "lg" }),
      { root: what.css(["px-6", "py-3", "text-lg"]) }
    )
  ]
}));
```

### When to Use what.css()

```typescript
// ‚úÖ Good: Use what.css() for static CSS classes
def.root({
  root: what.css(["inline-flex", "items-center", "rounded"]),
  label: what.css(["font-medium"])
})

// ‚úÖ Good: Use what.css() for utility classes
def.rule(
  what.variant({ disabled: true }),
  { root: what.css(["opacity-50", "cursor-not-allowed"]) }
)

// ‚ùå Bad: Don't use what.css() for token references
def.root({
  root: what.css(["color.bg.primary"]) // Wrong! Use what.token() instead
})
```

## what.token() - Design Token References üé®

### Basic Usage

```typescript
import { cls } from "@use-pico/cls";

const ButtonCls = cls({
  tokens: {
    "color.bg": ["default", "primary", "danger"],
    "color.text": ["default", "primary", "danger"],
    "spacing.padding": ["sm", "md", "lg"]
  },
  slot: ["root"],
  variant: {
    tone: ["default", "primary", "danger"]
  }
}, ({ what, def }) => ({
  token: def.token({
    "color.bg": {
      default: ["bg-gray-100"],
      primary: ["bg-blue-600"],
      danger: ["bg-red-500"]
    },
    "color.text": {
      default: ["text-gray-900"],
      primary: ["text-white"],
      danger: ["text-white"]
    },
    "spacing.padding": {
      sm: ["px-2", "py-1"],
      md: ["px-4", "py-2"],
      lg: ["px-6", "py-3"]
    }
  }),
  rules: [
    def.root({
      root: what.token(["color.bg.default", "color.text.default", "spacing.padding.md"])
    }),
    def.rule(
      what.variant({ tone: "primary" }),
      { root: what.token(["color.bg.primary", "color.text.primary"]) }
    ),
    def.rule(
      what.variant({ tone: "danger" }),
      { root: what.token(["color.bg.danger", "color.text.danger"]) }
    )
  ]
}));
```

### Type-Safe Token References

```typescript
// ‚úÖ TypeScript knows exactly which tokens are available
def.root({
  root: what.token([
    "color.bg.default",    // ‚úÖ Valid token
    "color.text.primary",  // ‚úÖ Valid token
    "spacing.padding.lg"   // ‚úÖ Valid token
    // "color.bg.invalid"  // ‚ùå TypeScript error - token doesn't exist
  ])
})
```

### When to Use what.token()

```typescript
// ‚úÖ Good: Use what.token() for design token references
def.root({
  root: what.token(["color.bg.default", "color.text.default"])
})

// ‚úÖ Good: Use what.token() for semantic styling
def.rule(
  what.variant({ tone: "primary" }),
  { root: what.token(["color.bg.primary", "color.text.primary"]) }
)

// ‚ùå Bad: Don't use what.token() for direct CSS classes
def.root({
  root: what.token(["inline-flex", "items-center"]) // Wrong! Use what.css() instead
})
```

## what.variant() - Variant Configurations üéõÔ∏è

### Basic Usage

```typescript
import { cls } from "@use-pico/cls";

const ButtonCls = cls({
  tokens: {
    "color.bg": ["default", "primary", "danger"]
  },
  slot: ["root"],
  variant: {
    size: ["sm", "md", "lg"],
    tone: ["default", "primary", "danger"],
    disabled: ["bool"]
  }
}, ({ what, def }) => ({
  rules: [
    def.root({
      root: what.token(["color.bg.default"])
    }),
    def.rule(
      what.variant({ tone: "primary" }),
      { root: what.token(["color.bg.primary"]) }
    ),
    def.rule(
      what.variant({ size: "lg" }),
      { root: what.css(["px-6", "py-3", "text-lg"]) }
    ),
    def.rule(
      what.variant({ disabled: true }),
      { root: what.css(["opacity-50", "cursor-not-allowed"]) }
    )
  ]
}));
```

### Complex Variant Combinations

```typescript
// ‚úÖ Multiple variants in one rule
def.rule(
  what.variant({ 
    size: "lg", 
    tone: "primary", 
    disabled: true 
  }),
  { 
    root: what.both(
      what.token(["color.bg.primary"]),
      what.css(["px-6", "py-3", "text-lg", "opacity-50", "cursor-not-allowed"])
    )
  }
)

// ‚úÖ Partial variant combinations
def.rule(
  what.variant({ size: "lg", tone: "primary" }),
  { root: what.css(["px-6", "py-3", "text-lg"]) }
)

def.rule(
  what.variant({ tone: "primary", disabled: true }),
  { root: what.css(["opacity-50", "cursor-not-allowed"]) }
)
```

### Type-Safe Variant Values

```typescript
// ‚úÖ TypeScript validates variant values
def.rule(
  what.variant({ 
    size: "lg",        // ‚úÖ Valid size value
    tone: "primary",   // ‚úÖ Valid tone value
    disabled: true     // ‚úÖ Valid boolean value
    // size: "xl",     // ‚ùå TypeScript error - invalid size
    // tone: "invalid" // ‚ùå TypeScript error - invalid tone
  }),
  { root: what.css(["custom-styles"]) }
)
```

## what.both() - Combined Styling üé®

### Basic Usage

```typescript
import { cls } from "@use-pico/cls";

const ButtonCls = cls({
  tokens: {
    "color.bg": ["default", "primary", "danger"],
    "color.text": ["default", "primary", "danger"]
  },
  slot: ["root"],
  variant: {
    tone: ["default", "primary", "danger"]
  }
}, ({ what, def }) => ({
  token: def.token({
    "color.bg": {
      default: ["bg-gray-100"],
      primary: ["bg-blue-600"],
      danger: ["bg-red-500"]
    },
    "color.text": {
      default: ["text-gray-900"],
      primary: ["text-white"],
      danger: ["text-white"]
    }
  }),
  rules: [
    def.root({
      root: what.both(
        // CSS classes
        ["inline-flex", "items-center", "rounded", "font-medium"],
        // Token references
        ["color.bg.default", "color.text.default"]
      )
    }),
    def.rule(
      what.variant({ tone: "primary" }),
      { 
        root: what.both(
          what.css(["border-transparent"]),
          what.token(["color.bg.primary", "color.text.primary"])
        )
      }
    )
  ]
}));
```

### Complex Combinations

```typescript
// ‚úÖ Mix CSS classes and token references
def.root({
  root: what.both(
    // Layout and structure
    ["inline-flex", "items-center", "justify-center", "rounded"],
    // Typography
    ["font-medium", "transition-colors"],
    // Design tokens
    ["color.bg.default", "color.text.default", "spacing.padding.md"]
  )
})

// ‚úÖ Combine with variant-specific styling
def.rule(
  what.variant({ size: "lg", tone: "primary" }),
  { 
    root: what.both(
      // Base styles (from tokens)
      ["color.bg.primary", "color.text.primary"],
      // Size-specific styles (direct CSS)
      ["px-6", "py-3", "text-lg"],
      // Additional styling
      ["shadow-lg", "hover:shadow-xl"]
    )
  }
)
```

### When to Use what.both()

```typescript
// ‚úÖ Good: Use what.both() when mixing CSS and tokens
def.root({
  root: what.both(
    ["inline-flex", "items-center"],           // CSS classes
    ["color.bg.default", "color.text.default"] // Token references
  )
})

// ‚úÖ Good: Use what.both() for complex styling combinations
def.rule(
  what.variant({ tone: "primary" }),
  { 
    root: what.both(
      what.css(["border-transparent"]),
      what.token(["color.bg.primary", "color.text.primary"])
    )
  }
)

// ‚ùå Bad: Don't use what.both() for single type of styling
def.root({
  root: what.both(["inline-flex", "items-center"]) // Just use what.css() instead
})
```

## Advanced What Utility Patterns üåü

### Conditional Styling

```typescript
// ‚úÖ Use what.both() for conditional styling
def.rule(
  what.variant({ disabled: true }),
  { 
    root: what.both(
      what.css(["opacity-50", "cursor-not-allowed"]),
      // Override hover states when disabled
      what.css(["hover:bg-gray-100", "hover:bg-blue-600", "hover:bg-red-500"])
    )
  }
)
```

### Responsive Design

```typescript
// ‚úÖ Use what.css() for responsive classes
def.rule(
  what.variant({ size: "lg" }),
  { 
    root: what.both(
      what.token(["spacing.padding.lg"]),
      what.css([
        "text-base",
        "md:text-lg",
        "lg:text-xl"
      ])
    )
  }
)
```

### State Combinations

```typescript
// ‚úÖ Complex state combinations
def.rule(
  what.variant({ 
    tone: "primary", 
    disabled: true,
    size: "lg" 
  }),
  { 
    root: what.both(
      // Base token styles
      ["color.bg.primary", "color.text.primary"],
      // Size styles
      ["px-6", "py-3", "text-lg"],
      // Disabled state overrides
      ["opacity-50", "cursor-not-allowed"],
      // Disabled hover overrides
      ["hover:bg-blue-600", "hover:bg-blue-700"]
    )
  }
)
```

## Type Safety Features üîí

### Automatic Type Inference

```typescript
const ButtonCls = cls({
  tokens: {
    "color.bg": ["default", "primary", "danger"],
    "color.text": ["default", "primary", "danger"]
  },
  variant: {
    size: ["sm", "md", "lg"],
    tone: ["default", "primary", "danger"]
  }
}, ({ what, def }) => ({
  // TypeScript knows exactly what's available
  rules: [
    def.rule(
      what.variant({ 
        size: "lg",     // ‚úÖ TypeScript knows this is valid
        tone: "primary" // ‚úÖ TypeScript knows this is valid
        // size: "xl"   // ‚ùå TypeScript error - invalid value
      }),
      { 
        root: what.token([
          "color.bg.primary",  // ‚úÖ TypeScript knows this token exists
          "color.text.primary" // ‚úÖ TypeScript knows this token exists
          // "color.bg.invalid" // ‚ùå TypeScript error - token doesn't exist
        ])
      }
    )
  ]
}));
```

### IntelliSense Support

```typescript
// ‚úÖ Full IntelliSense support
def.rule(
  what.variant({ 
    // IntelliSense shows: "sm" | "md" | "lg"
    size: "lg",
    // IntelliSense shows: "default" | "primary" | "danger"
    tone: "primary"
  }),
  { 
    root: what.token([
      // IntelliSense shows all available tokens
      "color.bg.primary"
    ])
  }
)
```

## Best Practices üí°

### 1. **Use the Right Method for the Job**
```typescript
// ‚úÖ Good: Use what.css() for direct CSS classes
def.root({
  root: what.css(["inline-flex", "items-center", "rounded"])
})

// ‚úÖ Good: Use what.token() for design token references
def.root({
  root: what.token(["color.bg.default", "color.text.default"])
})

// ‚úÖ Good: Use what.both() when mixing both
def.root({
  root: what.both(
    ["inline-flex", "items-center"],           // CSS classes
    ["color.bg.default", "color.text.default"] // Token references
  )
})
```

### 2. **Keep Variant Combinations Logical**
```typescript
// ‚úÖ Good: Logical variant combinations
def.rule(
  what.variant({ size: "lg", tone: "primary" }),
  { root: what.css(["px-6", "py-3", "text-lg"]) }
)

// ‚ùå Bad: Avoid overly complex combinations
def.rule(
  what.variant({ 
    size: "lg", 
    tone: "primary", 
    disabled: true,
    // Too many variants make rules hard to understand
  }),
  { root: what.css(["complex-styles"]) }
)
```

### 3. **Use Arrays for Class Lists**
```typescript
// ‚úÖ Good: Use arrays for class lists
def.root({
  root: what.css(["inline-flex", "items-center", "rounded"])
})

// ‚ùå Bad: Don't use single strings
def.root({
  root: what.css("inline-flex items-center rounded") // Wrong format
})
```

### 4. **Leverage Type Safety**
```typescript
// ‚úÖ Good: Let TypeScript guide you
def.rule(
  what.variant({ 
    // TypeScript will show available options
    size: "lg",
    tone: "primary"
  }),
  { 
    root: what.token([
      // TypeScript will show available tokens
      "color.bg.primary"
    ])
  }
)
```

## The Bottom Line üí°

The `what` utility is CLS's **type-safe styling toolkit**:

- **`what.css()`**: Direct CSS class strings
- **`what.token()`**: Design token references
- **`what.variant()`**: Variant configurations
- **`what.both()`**: Combined CSS and token styling
- **Type safe**: Full TypeScript validation and IntelliSense
- **Intuitive**: Clear, purpose-built methods for different styling needs

Think of the `what` utility as your **"styling Swiss Army knife"** - it has the right tool for every styling job! üéâ

---

**Previous:** [3.6 `tvc()` Helper](./3.6-tvc-helper.md) | **Next:** [3.8 Definition Helpers](./3.8-definition-helpers.md)
