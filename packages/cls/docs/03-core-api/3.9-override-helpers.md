# 3.9 Override Helpers

## Table of Contents
- [3.1 `cls()` Function](./3.1-cls-function.md)
- [3.2 `extend()` Method](./3.2-extend-method.md)
- [3.3 `contract()` Helper](./3.3-contract-helper.md)
- [3.4 `use()` Method](./3.4-use-method.md)
- [3.5 `merge()` Utility](./3.5-merge-utility.md)
- [3.6 `tvc()` Helper](./3.6-tvc-helper.md)
- [3.7 What Utility](./3.7-what-utility.md)
- [3.8 Definition Helpers](./3.8-definition-helpers.md)
- [3.9 Override Helpers](./3.9-override-helpers.md) *(current)*
- [3.10 Override System Deep Dive](./3.10-override-system-deep-dive.md)

---

The **Override Helpers** are CLS's **explicit override system** - they let you completely replace styles instead of appending to them! Think of them as your "override toolkit" for when you need to start fresh or completely replace existing styles. Let's explore when and how to use each override helper! ðŸŽ¯

## What are Override Helpers? ðŸ¤”

The `override` helpers serve different purposes depending on where they're used:

- **`override.root()`**: Used in **definitions** to reset all base slot styles
- **`override.rule()`**: Used in **definitions** to completely replace rules (including root styles)
- **`override.token()`**: Used in **runtime calls** (`.create()` or slot calls) to override token values

## `override.root()` - Reset Base Styles in Definitions ðŸŽ¨

### When to Use

Use `override.root()` in your definition when you want to **completely reset all base slot styles** and start fresh. This is useful when extending a module and you want to replace the entire base styling approach.

### Basic Usage

```typescript
import { cls } from "@use-pico/cls";

const BaseButtonCls = cls({
  tokens: {
    "color.bg": ["default", "primary", "danger"],
    "spacing.padding": ["sm", "md", "lg"]
  },
  slot: ["root", "label"],
  variant: {
    tone: ["default", "primary", "danger"]
  }
}, ({ what, def }) => ({
  token: def.token({
    "color.bg": {
      default: ["bg-gray-100"],
      primary: ["bg-blue-600"],
      danger: ["bg-red-500"]
    },
    "spacing.padding": {
      sm: ["px-2", "py-1"],
      md: ["px-4", "py-2"],
      lg: ["px-6", "py-3"]
    }
  }),
  rules: [
    def.root({
      root: what.both(
        ["inline-flex", "items-center", "rounded", "font-medium"],
        ["color.bg.default", "spacing.padding.md"]
      ),
      label: what.css(["font-medium"])
    }),
    def.rule(
      what.variant({ tone: "primary" }),
      { root: what.token(["color.bg.primary"]) }
    )
  ],
  defaults: def.defaults({
    tone: "default"
  })
}));

// Extend with completely new base styles
const CustomButtonCls = BaseButtonCls.extend({
  slot: ["root", "label", "icon"]
}, ({ what, def, override }) => ({
  token: def.token({
    "color.bg": {
      default: ["bg-gray-200"],
      primary: ["bg-green-600"],
      danger: ["bg-red-600"]
    }
  }),
  rules: [
    // Completely reset base styles - start fresh
    override.root({
      root: what.both(
        ["flex", "items-center", "justify-center", "rounded-lg", "font-semibold", "transition-all"],
        ["color.bg.default", "spacing.padding.md"]
      ),
      label: what.css(["font-semibold", "text-gray-800"]),
      icon: what.css(["ml-2", "w-4", "h-4"])
    }),
    def.rule(
      what.variant({ tone: "primary" }),
      { 
        root: what.token(["color.bg.primary"]),
        label: what.css(["text-white"])
      }
    )
  ],
  defaults: def.defaults({
    tone: "default"
  })
}));
```

### Complete Style Reset

```typescript
// âœ… Completely replace all base slot styles
override.root({
  root: what.both(
    ["flex", "items-center", "justify-center", "rounded-lg", "font-semibold", "transition-all"],
    ["color.bg.default", "spacing.padding.md"]
  ),
  label: what.css(["font-semibold", "text-gray-800"]),
  icon: what.css(["ml-2", "w-4", "h-4"])
  // Any slots not defined here will have no base styles
})
```

### Partial Style Reset

```typescript
// âœ… Reset only specific slots, keep others
override.root({
  root: what.both(
    ["flex", "items-center", "justify-center", "rounded-lg"],
    ["color.bg.default", "spacing.padding.md"]
  ),
  label: what.css(["font-semibold", "text-gray-800"])
  // Other slots (like icon) keep their inherited base styles
})
```

## `override.rule()` - Replace Rules in Definitions ðŸŽ›ï¸

### When to Use

Use `override.rule()` in your definition when you want to **completely replace a rule** and all its styles, including any root styles that might be applied. This is useful when you want to start fresh with a specific variant combination.

### Basic Usage

```typescript
import { cls } from "@use-pico/cls";

const ButtonCls = cls({
  tokens: {
    "color.bg": ["default", "primary", "danger"],
    "color.text": ["default", "primary", "danger"]
  },
  slot: ["root", "label"],
  variant: {
    size: ["sm", "md", "lg"],
    tone: ["default", "primary", "danger"]
  }
}, ({ what, def }) => ({
  token: def.token({
    "color.bg": {
      default: ["bg-gray-100"],
      primary: ["bg-blue-600"],
      danger: ["bg-red-500"]
    },
    "color.text": {
      default: ["text-gray-900"],
      primary: ["text-white"],
      danger: ["text-white"]
    }
  }),
  rules: [
    def.root({
      root: what.both(
        ["inline-flex", "items-center", "rounded", "font-medium"],
        ["color.bg.default", "color.text.default"]
      ),
      label: what.css(["font-medium"])
    }),
    def.rule(
      what.variant({ tone: "primary" }),
      { 
        root: what.token(["color.bg.primary", "color.text.primary"]),
        label: what.css(["font-semibold"])
      }
    ),
    def.rule(
      what.variant({ size: "lg" }),
      { root: what.css(["px-6", "py-3", "text-lg"]) }
    )
  ],
  defaults: def.defaults({
    size: "md",
    tone: "default"
  })
}));

// Extend with completely new rules
const CustomButtonCls = ButtonCls.extend({
  variant: {
    size: ["sm", "md", "lg"],
    tone: ["default", "primary", "danger", "success"]
  }
}, ({ what, def, override }) => ({
  token: def.token({
    "color.bg": {
      success: ["bg-green-600"]
    },
    "color.text": {
      success: ["text-white"]
    }
  }),
  rules: [
    // Completely replace the primary tone rule
    override.rule(
      what.variant({ tone: "primary" }),
      { 
        root: what.css(["bg-green-600", "text-white", "border", "border-green-700", "rounded-lg"]),
        label: what.css(["font-bold", "text-green-50"])
      }
    ),
    // Completely replace the large size rule
    override.rule(
      what.variant({ size: "lg" }),
      { root: what.css(["px-8", "py-4", "text-xl", "rounded-lg", "shadow-lg"]) }
    ),
    // Add new rule for success tone
    def.rule(
      what.variant({ tone: "success" }),
      { 
        root: what.token(["color.bg.success", "color.text.success"]),
        label: what.css(["font-bold"])
      }
    )
  ],
  defaults: def.defaults({
    size: "md",
    tone: "default"
  })
}));
```

### Rule Replacement Behavior

```typescript
// âœ… Override completely replaces the rule and all its styles
override.rule(
  what.variant({ tone: "primary" }),
  { 
    root: what.css(["bg-green-600", "text-white", "border", "border-green-700"]),
    label: what.css(["font-bold", "text-green-50"])
  }
)
// This completely replaces any existing rule for tone: "primary"
// Previous styles (including root styles) are discarded, only new styles are applied
```

### Complex Rule Replacements

```typescript
// âœ… Replace complex variant combinations
override.rule(
  what.variant({ 
    size: "lg", 
    tone: "primary" 
  }),
  { 
    root: what.css([
      "px-8", "py-4", "text-xl", "rounded-lg", "shadow-lg",
      "bg-green-600", "text-white", "border", "border-green-700"
    ]),
    label: what.css(["font-bold", "text-green-50"])
  }
)
```

## `override.token()` - Runtime Token Overrides ðŸŽ¨

### When to Use

Use `override.token()` in **runtime calls** (`.create()` or slot calls) when you want to override specific token values for a particular instance. This is useful for dynamic theming, user preferences, or contextual styling.

### Basic Usage

```typescript
import { cls } from "@use-pico/cls";

const ButtonCls = cls({
  tokens: {
    "color.bg": ["default", "primary", "danger"],
    "color.text": ["default", "primary", "danger"]
  },
  slot: ["root", "label"],
  variant: {
    tone: ["default", "primary", "danger"]
  }
}, ({ what, def }) => ({
  token: def.token({
    "color.bg": {
      default: ["bg-gray-100"],
      primary: ["bg-blue-600"],
      danger: ["bg-red-500"]
    },
    "color.text": {
      default: ["text-gray-900"],
      primary: ["text-white"],
      danger: ["text-white"]
    }
  }),
  rules: [
    def.root({
      root: what.token(["color.bg.default", "color.text.default"]),
      label: what.css(["font-medium"])
    }),
    def.rule(
      what.variant({ tone: "primary" }),
      { root: what.token(["color.bg.primary", "color.text.primary"]) }
    )
  ],
  defaults: def.defaults({
    tone: "default"
  })
}));

// Runtime token overrides
const button = ButtonCls.create(({ what, override }) => ({
  variant: what.variant({ tone: "primary" }),
  token: override.token({
    "color.bg": {
      primary: ["bg-green-600"]  // Override primary color at runtime
    },
    "color.text": {
      primary: ["text-green-50"]  // Override primary text color at runtime
    }
  })
}));

console.log(button.root()); // Uses green background instead of blue
```

### Dynamic Theme Overrides

```typescript
// âœ… Dynamic runtime overrides based on theme
const getThemeOverrides = (theme: "light" | "dark") => {
  if (theme === "dark") {
    return {
      token: {
        "color.bg": {
          default: ["bg-gray-800"],
          primary: ["bg-blue-700"],
          danger: ["bg-red-700"]
        },
        "color.text": {
          default: ["text-gray-100"],
          primary: ["text-white"],
          danger: ["text-white"]
        }
      }
    };
  }
  
  return {
    token: {
      "color.bg": {
        default: ["bg-white"],
        primary: ["bg-blue-600"],
        danger: ["bg-red-500"]
      }
    }
  };
};

// Runtime usage with theme overrides
const darkThemeButton = ButtonCls.create(({ what, override }) => ({
  variant: what.variant({ tone: "primary" }),
  token: override.token(getThemeOverrides("dark").token)
}));

const lightThemeButton = ButtonCls.create(({ what, override }) => ({
  variant: what.variant({ tone: "primary" }),
  token: override.token(getThemeOverrides("light").token)
}));
```

### Slot-Specific Token Overrides

```typescript
// âœ… Override tokens for specific slots
const button = ButtonCls.create(({ what, override }) => ({
  variant: what.variant({ tone: "primary" }),
  token: override.token({
    "color.bg": {
      primary: ["bg-green-600"]
    }
  })
}));

// Use in specific slot calls
console.log(button.root()); // Uses green background
console.log(button.label()); // Uses green background for label too
```

## Override vs Definition Comparison ðŸ”„

### Definition Helpers (Append Behavior)

```typescript
// âœ… def.* helpers append to existing styles during definition
def.token({
  "color.bg": {
    primary: ["bg-green-600"]  // Adds to existing tokens
  }
})

def.rule(
  what.variant({ tone: "primary" }),
  { root: what.css(["border", "border-green-700"]) }  // Adds to existing rule
)

def.root({
  root: what.css(["rounded-lg"])  // Adds to existing base styles
})
```

### Override Helpers (Replace Behavior)

```typescript
// âœ… override.root() and override.rule() replace styles in definitions
override.root({
  root: what.css(["rounded-lg", "border"])  // Replaces existing base styles
})

override.rule(
  what.variant({ tone: "primary" }),
  { root: what.css(["bg-green-600", "text-white"]) }  // Replaces existing rule
)

// âœ… override.token() replaces tokens at runtime
const button = ButtonCls.create(({ what, override }) => ({
  variant: what.variant({ tone: "primary" }),
  token: override.token({
    "color.bg": {
      primary: ["bg-green-600"]  // Replaces token at runtime
    }
  })
}));
```

## Best Practices ðŸ’¡

### 1. **Use override.root() for Complete Style Resets**
```typescript
// âœ… Good: Use override.root() when you want to completely reset base styles
const CustomButtonCls = BaseButtonCls.extend({
  slot: ["root", "label", "icon"]
}, ({ what, def, override }) => ({
  rules: [
    // Completely new base styling approach
    override.root({
      root: what.css(["flex", "items-center", "justify-center", "rounded-lg", "font-semibold"]),
      label: what.css(["font-semibold", "text-gray-800"]),
      icon: what.css(["ml-2", "w-4", "h-4"])
    })
  ]
}));

// âŒ Bad: Don't use override.root() for small additions
const CustomButtonCls = BaseButtonCls.extend({
  slot: ["root", "label"]
}, ({ what, def, override }) => ({
  rules: [
    override.root({
      root: what.css(["border"])  // Just adding border, use def.root instead
    })
  ]
}));
```

### 2. **Use override.rule() for Complete Rule Replacements**
```typescript
// âœ… Good: Use override.rule() when you want to completely replace a rule
const CustomButtonCls = ButtonCls.extend({
  variant: {
    tone: ["default", "primary", "danger"]
  }
}, ({ what, def, override }) => ({
  rules: [
    // Completely new primary button design
    override.rule(
      what.variant({ tone: "primary" }),
      { 
        root: what.css(["bg-green-600", "text-white", "border", "border-green-700", "rounded-lg"]),
        label: what.css(["font-bold", "text-green-50"])
      }
    )
  ]
}));

// âŒ Bad: Don't use override.rule() for small additions
const CustomButtonCls = ButtonCls.extend({
  variant: {
    tone: ["default", "primary", "danger"]
  }
}, ({ what, def, override }) => ({
  rules: [
    override.rule(
      what.variant({ tone: "primary" }),
      { root: what.css(["border"]) }  // Just adding border, use def.rule instead
    )
  ]
}));
```

### 3. **Use override.token() for Runtime Dynamic Styling**
```typescript
// âœ… Good: Use override.token() for dynamic runtime changes
const darkButton = ButtonCls.create(({ what, override }) => ({
  variant: what.variant({ tone: "primary" }),
  token: override.token({
    "color.bg": {
      primary: ["bg-blue-700"]
    }
  })
}));

// User preferences
const userButton = ButtonCls.create(({ what, override }) => ({
  variant: what.variant({ tone: "primary" }),
  token: override.token({
    "color.bg": {
      primary: ["bg-purple-600"]  // User's preferred color
    }
  })
}));

// âŒ Bad: Don't use override.token() in definitions
const CustomButtonCls = ButtonCls.extend({
  variant: {
    tone: ["default", "primary", "danger"]
  }
}, ({ what, def, override }) => ({
  // This is wrong - override.token() is for runtime, not definitions
  token: override.token({
    "color.bg": {
      primary: ["bg-green-600"]
    }
  })
}));
```

### 4. **Document Override Intentions**
```typescript
// âœ… Good: Clear documentation of override intentions
const CustomButtonCls = ButtonCls.extend({
  slot: ["root", "label", "icon"]
}, ({ what, def, override }) => {
  // Override Strategy:
  // 1. Reset base styles for new design system
  // 2. Replace primary button with brand colors
  // 3. Add icon support
  
  return {
    rules: [
      // 1. Complete base style reset
      override.root({
        root: what.css(["flex", "items-center", "justify-center", "rounded-lg", "font-semibold"]),
        label: what.css(["font-semibold", "text-gray-800"]),
        icon: what.css(["ml-2", "w-4", "h-4"])
      }),
      // 2. Replace primary button design
      override.rule(
        what.variant({ tone: "primary" }),
        { 
          root: what.css(["bg-green-600", "text-white", "border", "border-green-700"]),
          label: what.css(["font-bold", "text-green-50"])
        }
      )
    ],
    defaults: def.defaults({
      tone: "default"
    })
  };
});
```

## The Bottom Line ðŸ’¡

The Override Helpers are CLS's **explicit override system**:

- **`override.root()`**: Reset all base slot styles in **definitions**
- **`override.rule()`**: Completely replace rules in **definitions**
- **`override.token()`**: Override token values at **runtime**
- **Replace behavior**: Overrides completely replace existing styles
- **Type safe**: Full TypeScript validation and IntelliSense
- **Clear separation**: Definition-time vs runtime overrides

Think of the Override Helpers as your **"override toolkit"** - they give you complete control when you need to replace rather than extend! ðŸŽ‰

---

**Previous:** [3.8 Definition Helpers](./3.8-definition-helpers.md) | **Next:** [3.10 Override System Deep Dive](./3.10-override-system-deep-dive.md)
