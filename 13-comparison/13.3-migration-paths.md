# 13.3 Migration Paths

## Table of Contents
- [13.1 Feature Table](./13.1-feature-table.md)
- [13.2 Code Comparisons](./13.2-code-comparisons.md)
- [13.3 Migration Paths](./13.3-migration-paths.md) *(current)*
- [13.4 vs CVA (Class Variance Authority)](./13.4-vs-cva-class-variance-authority.md)
- [13.5 vs TV (Tailwind Variants)](./13.5-vs-tv-tailwind-variants.md)
- [13.6 vs Stitches](./13.6-vs-stitches.md)
- [13.7 vs Vanilla Extract](./13.7-vs-vanilla-extract.md)

---

This chapter provides **step-by-step migration guides** for moving from other styling solutions to CLS. Each migration path includes **before/after examples**, **common challenges**, and **best practices** for a smooth transition.

## **Migration Strategy Overview** üéØ

### **Why Migrate to CLS?** ü§î

- **Type safety** - Compile-time validation and IntelliSense
- **Design system scalability** - Multi-level inheritance and composition
- **Runtime flexibility** - Dynamic theming and user customization
- **Framework agnostic** - Works with any framework or no framework
- **Developer experience** - Predictable APIs and excellent tooling

### **Migration Phases** üìã

1. **Assessment** - Evaluate current styling solution and identify migration scope
2. **Planning** - Design CLS architecture and migration strategy
3. **Foundation** - Set up CLS infrastructure and design tokens
4. **Component Migration** - Migrate components one by one
5. **Testing** - Validate functionality and performance
6. **Cleanup** - Remove old styling dependencies

### **Migration Complexity Levels** üìä

| From | Complexity | Timeline | Key Challenges |
|------|------------|----------|----------------|
| **CVA** | üü° Medium | 2-4 weeks | Learning contracts and tokens |
| **TV** | üü° Medium | 2-4 weeks | Understanding inheritance system |
| **Stitches** | üü° Medium | 3-5 weeks | Moving from CSS-in-JS to class-based |
| **Vanilla Extract** | üî¥ High | 4-8 weeks | Moving from build-time to runtime |
| **CSS Modules** | üü¢ Easy | 1-2 weeks | Learning CLS concepts |
| **Tailwind CSS** | üü° Medium | 2-4 weeks | Understanding design tokens |

## **Migration from CVA** üì¶

### **Step 1: Install CLS** üì•

```bash
npm install @use-pico/cls
# or
yarn add @use-pico/cls
# or
bun add @use-pico/cls
```

### **Step 2: Analyze Current CVA Components** üîç

**Before (CVA):**

```typescript
import { cva, type VariantProps } from "class-variance-authority";
import { cn } from "@/lib/utils";

const buttonVariants = cva(
  "inline-flex items-center justify-center rounded font-medium transition-colors",
  {
    variants: {
      size: {
        sm: "px-3 py-1.5 text-sm",
        md: "px-4 py-2 text-base",
        lg: "px-6 py-3 text-lg",
      },
      tone: {
        primary: "bg-blue-600 text-white focus:ring-blue-500",
        secondary: "bg-gray-600 text-white focus:ring-gray-500",
        danger: "bg-red-600 text-white focus:ring-red-500",
      },
    },
    defaultVariants: {
      size: "md",
      tone: "primary",
    },
  }
);

interface ButtonProps
  extends React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {
  children: React.ReactNode;
}

function Button({ children, size, tone, className, ...props }: ButtonProps) {
  return (
    <button
      className={cn(buttonVariants({ size, tone }), className)}
      {...props}
    >
      {children}
    </button>
  );
}
```

### **Step 3: Create CLS Contract** üìù

**After (CLS):**

```typescript
import { cls } from "@use-pico/cls";
import { useCls } from "@use-pico/cls/react";
import type { Component } from "@use-pico/cls";

// Define the CLS instance
const ButtonCls = cls({
  slot: ["root"],
  variant: {
    size: ["sm", "md", "lg"],
    tone: ["primary", "secondary", "danger"]
  }
}, ({ what, def }) => ({
  token: def.token({
    "color.bg.primary": ["bg-blue-600"],
    "color.bg.secondary": ["bg-gray-600"],
    "color.bg.danger": ["bg-red-600"],
    "color.text.primary": ["text-white"],
    "color.text.secondary": ["text-white"],
    "color.text.danger": ["text-white"],
    "spacing.sm": ["px-3 py-1.5"],
    "spacing.md": ["px-4 py-2"],
    "spacing.lg": ["px-6 py-3"]
  }),
  rules: [
    def.root({
      root: what.css([
        "inline-flex items-center justify-center rounded font-medium transition-colors"
      ])
    }),
    def.rule({
      variant: { size: "sm" },
      root: what.css(["text-sm", "spacing.sm"])
    }),
    def.rule({
      variant: { size: "md" },
      root: what.css(["text-base", "spacing.md"])
    }),
    def.rule({
      variant: { size: "lg" },
      root: what.css(["text-lg", "spacing.lg"])
    }),
    def.rule({
      variant: { tone: "primary" },
      root: what.css(["color.bg.primary", "color.text.primary", "focus:ring-blue-500"])
    }),
    def.rule({
      variant: { tone: "secondary" },
      root: what.css(["color.bg.secondary", "color.text.secondary", "focus:ring-gray-500"])
    }),
    def.rule({
      variant: { tone: "danger" },
      root: what.css(["color.bg.danger", "color.text.danger", "focus:ring-red-500"])
    })
  ],
  defaults: def.defaults({
    size: "md",
    tone: "primary"
  })
}));

// React component
interface ButtonProps extends Component<typeof ButtonCls, React.ButtonHTMLAttributes<HTMLButtonElement>> {
  children: React.ReactNode;
  size?: "sm" | "md" | "lg";
  tone?: "primary" | "secondary" | "danger";
}

function Button({
  children,
  size = "md",
  tone = "primary",
  tva = ButtonCls,
  cls,
  ...props
}: ButtonProps) {
  const buttonClasses = useCls(tva, cls, ({ what }) => ({
    variant: what.variant({
      size,
      tone
    })
  }));

  return (
    <button className={buttonClasses.root()} {...props}>
      {children}
    </button>
  );
}
```

### **Step 4: Key Differences** üîÑ

| CVA Concept | CLS Equivalent | Notes |
|-------------|----------------|-------|
| `cva()` | `cls()` | Main function for creating styling instances |
| `variants` | `variant` in contract | Define available variant options |
| `defaultVariants` | `defaults` | Set default variant values |
| `cn()` utility | `useCls()` hook | Class name generation and composition |
| `VariantProps<T>` | `Component<T>` | TypeScript interface for component props |

### **Step 5: Migration Checklist** ‚úÖ

- [ ] **Install CLS** and remove CVA dependency
- [ ] **Create CLS contracts** for each component
- [ ] **Define design tokens** for consistent values
- [ ] **Migrate component interfaces** to use `Component<T>`
- [ ] **Replace `cn()` calls** with `useCls()` hook
- [ ] **Update prop types** to match CLS variants
- [ ] **Test all variant combinations** work correctly
- [ ] **Remove CVA imports** and clean up dependencies

## **Migration from TV (Tailwind Variants)** üé®

### **Step 1: Install CLS** üì•

```bash
npm install @use-pico/cls
```

### **Step 2: Analyze Current TV Components** üîç

**Before (TV):**

```typescript
import { tv, type VariantProps } from "tailwind-variants";

const button = tv({
  base: "inline-flex items-center justify-center rounded font-medium transition-colors",
  variants: {
    size: {
      sm: "px-3 py-1.5 text-sm",
      md: "px-4 py-2 text-base",
      lg: "px-6 py-3 text-lg",
    },
    tone: {
      primary: "bg-blue-600 text-white focus:ring-blue-500",
      secondary: "bg-gray-600 text-white focus:ring-gray-500",
      danger: "bg-red-600 text-white focus:ring-red-500",
    },
  },
  defaultVariants: {
    size: "md",
    tone: "primary",
  },
});

interface ButtonProps
  extends React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof button> {
  children: React.ReactNode;
}

function Button({ children, size, tone, className, ...props }: ButtonProps) {
  return (
    <button className={button({ size, tone, className })} {...props}>
      {children}
    </button>
  );
}
```

### **Step 3: Create CLS Contract** üìù

**After (CLS):**

```typescript
import { cls } from "@use-pico/cls";
import { useCls } from "@use-pico/cls/react";
import type { Component } from "@use-pico/cls";

// Define the CLS instance
const ButtonCls = cls({
  slot: ["root"],
  variant: {
    size: ["sm", "md", "lg"],
    tone: ["primary", "secondary", "danger"]
  }
}, ({ what, def }) => ({
  token: def.token({
    "color.bg.primary": ["bg-blue-600"],
    "color.bg.secondary": ["bg-gray-600"],
    "color.bg.danger": ["bg-red-600"],
    "color.text.primary": ["text-white"],
    "color.text.secondary": ["text-white"],
    "color.text.danger": ["text-white"],
    "spacing.sm": ["px-3 py-1.5"],
    "spacing.md": ["px-4 py-2"],
    "spacing.lg": ["px-6 py-3"]
  }),
  rules: [
    def.root({
      root: what.css([
        "inline-flex items-center justify-center rounded font-medium transition-colors"
      ])
    }),
    def.rule({
      variant: { size: "sm" },
      root: what.css(["text-sm", "spacing.sm"])
    }),
    def.rule({
      variant: { size: "md" },
      root: what.css(["text-base", "spacing.md"])
    }),
    def.rule({
      variant: { size: "lg" },
      root: what.css(["text-lg", "spacing.lg"])
    }),
    def.rule({
      variant: { tone: "primary" },
      root: what.css(["color.bg.primary", "color.text.primary", "focus:ring-blue-500"])
    }),
    def.rule({
      variant: { tone: "secondary" },
      root: what.css(["color.bg.secondary", "color.text.secondary", "focus:ring-gray-500"])
    }),
    def.rule({
      variant: { tone: "danger" },
      root: what.css(["color.bg.danger", "color.text.danger", "focus:ring-red-500"])
    })
  ],
  defaults: def.defaults({
    size: "md",
    tone: "primary"
  })
}));

// React component
interface ButtonProps extends Component<typeof ButtonCls, React.ButtonHTMLAttributes<HTMLButtonElement>> {
  children: React.ReactNode;
  size?: "sm" | "md" | "lg";
  tone?: "primary" | "secondary" | "danger";
}

function Button({
  children,
  size = "md",
  tone = "primary",
  tva = ButtonCls,
  cls,
  ...props
}: ButtonProps) {
  const buttonClasses = useCls(tva, cls, ({ what }) => ({
    variant: what.variant({
      size,
      tone
    })
  }));

  return (
    <button className={buttonClasses.root()} {...props}>
      {children}
    </button>
  );
}
```

### **Step 4: Key Differences** üîÑ

| TV Concept | CLS Equivalent | Notes |
|------------|----------------|-------|
| `tv()` | `cls()` | Main function for creating styling instances |
| `base` | `def.root()` | Base styles for the component |
| `variants` | `variant` in contract | Define available variant options |
| `defaultVariants` | `defaults` | Set default variant values |
| `button({ size, tone })` | `useCls(tva, cls, ...)` | Class name generation |
| `VariantProps<T>` | `Component<T>` | TypeScript interface for component props |

### **Step 5: Migration Checklist** ‚úÖ

- [ ] **Install CLS** and remove TV dependency
- [ ] **Create CLS contracts** for each component
- [ ] **Convert `base` styles** to `def.root()` rules
- [ ] **Migrate component interfaces** to use `Component<T>`
- [ ] **Replace `tv()` calls** with `useCls()` hook
- [ ] **Update prop types** to match CLS variants
- [ ] **Test all variant combinations** work correctly
- [ ] **Remove TV imports** and clean up dependencies

## **Migration from Stitches** üßµ

### **Step 1: Install CLS** üì•

```bash
npm install @use-pico/cls
```

### **Step 2: Analyze Current Stitches Components** üîç

**Before (Stitches):**

```typescript
import { styled } from "@stitches/react";

const StyledButton = styled("button", {
  display: "inline-flex",
  alignItems: "center",
  justifyContent: "center",
  borderRadius: "0.375rem",
  fontWeight: "500",
  transition: "colors",
  outline: "none",
  cursor: "pointer",
  
  "&:focus": {
    boxShadow: "0 0 0 2px $colors$blue500, 0 0 0 4px $colors$white",
  },
  
  "&:disabled": {
    opacity: 0.5,
    cursor: "not-allowed",
  },

  variants: {
    size: {
      sm: {
        padding: "$2 $3",
        fontSize: "$sm",
      },
      md: {
        padding: "$2 $4",
        fontSize: "$base",
      },
      lg: {
        padding: "$3 $6",
        fontSize: "$lg",
      },
    },
    tone: {
      primary: {
        backgroundColor: "$blue600",
        color: "$white",
        "&:focus": {
          boxShadow: "0 0 0 2px $colors$blue500, 0 0 0 4px $colors$white",
        },
      },
      secondary: {
        backgroundColor: "$gray600",
        color: "$white",
        "&:focus": {
          boxShadow: "0 0 0 2px $colors$gray500, 0 0 0 4px $colors$white",
        },
      },
    },
  },
  
  defaultVariants: {
    size: "md",
    tone: "primary",
  },
});

interface ButtonProps extends React.ComponentProps<typeof StyledButton> {
  children: React.ReactNode;
}

function Button({ children, ...props }: ButtonProps) {
  return <StyledButton {...props}>{children}</StyledButton>;
}
```

### **Step 3: Create CLS Contract** üìù

**After (CLS):**

```typescript
import { cls } from "@use-pico/cls";
import { useCls } from "@use-pico/cls/react";
import type { Component } from "@use-pico/cls";

// Define the CLS instance
const ButtonCls = cls({
  slot: ["root"],
  variant: {
    size: ["sm", "md", "lg"],
    tone: ["primary", "secondary"]
  }
}, ({ what, def }) => ({
  token: def.token({
    "color.bg.primary": ["bg-blue-600"],
    "color.bg.secondary": ["bg-gray-600"],
    "color.text.primary": ["text-white"],
    "color.text.secondary": ["text-white"],
    "spacing.sm": ["px-3 py-1.5"],
    "spacing.md": ["px-4 py-2"],
    "spacing.lg": ["px-6 py-3"]
  }),
  rules: [
    def.root({
      root: what.css([
        "inline-flex items-center justify-center rounded font-medium transition-colors",
        "outline-none cursor-pointer",
        "focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",
        "disabled:opacity-50 disabled:cursor-not-allowed"
      ])
    }),
    def.rule({
      variant: { size: "sm" },
      root: what.css(["text-sm", "spacing.sm"])
    }),
    def.rule({
      variant: { size: "md" },
      root: what.css(["text-base", "spacing.md"])
    }),
    def.rule({
      variant: { size: "lg" },
      root: what.css(["text-lg", "spacing.lg"])
    }),
    def.rule({
      variant: { tone: "primary" },
      root: what.css(["color.bg.primary", "color.text.primary", "focus:ring-blue-500"])
    }),
    def.rule({
      variant: { tone: "secondary" },
      root: what.css(["color.bg.secondary", "color.text.secondary", "focus:ring-gray-500"])
    })
  ],
  defaults: def.defaults({
    size: "md",
    tone: "primary"
  })
}));

// React component
interface ButtonProps extends Component<typeof ButtonCls, React.ButtonHTMLAttributes<HTMLButtonElement>> {
  children: React.ReactNode;
  size?: "sm" | "md" | "lg";
  tone?: "primary" | "secondary";
}

function Button({
  children,
  size = "md",
  tone = "primary",
  tva = ButtonCls,
  cls,
  ...props
}: ButtonProps) {
  const buttonClasses = useCls(tva, cls, ({ what }) => ({
    variant: what.variant({
      size,
      tone
    })
  }));

  return (
    <button className={buttonClasses.root()} {...props}>
      {children}
    </button>
  );
}
```

### **Step 4: Key Differences** üîÑ

| Stitches Concept | CLS Equivalent | Notes |
|------------------|----------------|-------|
| `styled()` | `cls()` | Main function for creating styling instances |
| CSS-in-JS styles | Tailwind CSS classes | Convert CSS properties to utility classes |
| `variants` | `variant` in contract | Define available variant options |
| `defaultVariants` | `defaults` | Set default variant values |
| `$colors$` tokens | `def.token()` | Design token system |
| `&:focus`, `&:disabled` | Tailwind pseudo-classes | Convert CSS pseudo-classes to Tailwind |

### **Step 5: Migration Checklist** ‚úÖ

- [ ] **Install CLS** and remove Stitches dependency
- [ ] **Convert CSS-in-JS styles** to Tailwind CSS classes
- [ ] **Create CLS contracts** for each component
- [ ] **Migrate design tokens** from `$colors$` to `def.token()`
- [ ] **Convert CSS pseudo-classes** to Tailwind equivalents
- [ ] **Migrate component interfaces** to use `Component<T>`
- [ ] **Replace styled components** with `useCls()` hook
- [ ] **Test all variant combinations** work correctly
- [ ] **Remove Stitches imports** and clean up dependencies

## **Migration from Vanilla Extract** üç¶

### **Step 1: Install CLS** üì•

```bash
npm install @use-pico/cls
```

### **Step 2: Analyze Current Vanilla Extract Components** üîç

**Before (Vanilla Extract):**

```typescript
import { style, styleVariants } from "@vanilla-extract/css";
import { recipe } from "@vanilla-extract/recipes";

const base = style({
  display: "inline-flex",
  alignItems: "center",
  justifyContent: "center",
  borderRadius: "0.375rem",
  fontWeight: "500",
  transition: "colors",
  outline: "none",
  cursor: "pointer",
  
  ":focus": {
    boxShadow: "0 0 0 2px #3b82f6, 0 0 0 4px #ffffff",
  },
  
  ":disabled": {
    opacity: 0.5,
    cursor: "not-allowed",
  },
});

const sizes = styleVariants({
  sm: {
    padding: "0.375rem 0.75rem",
    fontSize: "0.875rem",
  },
  md: {
    padding: "0.5rem 1rem",
    fontSize: "1rem",
  },
  lg: {
    padding: "0.75rem 1.5rem",
    fontSize: "1.125rem",
  },
});

const tones = styleVariants({
  primary: {
    backgroundColor: "#2563eb",
    color: "#ffffff",
    ":focus": {
      boxShadow: "0 0 0 2px #3b82f6, 0 0 0 4px #ffffff",
    },
  },
  secondary: {
    backgroundColor: "#4b5563",
    color: "#ffffff",
    ":focus": {
      boxShadow: "0 0 0 2px #6b7280, 0 0 0 4px #ffffff",
    },
  },
});

const buttonRecipe = recipe({
  base,
  variants: {
    size: sizes,
    tone: tones,
  },
  defaultVariants: {
    size: "md",
    tone: "primary",
  },
});

interface ButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {
  children: React.ReactNode;
  size?: keyof typeof sizes;
  tone?: keyof typeof tones;
}

function Button({
  children,
  size = "md",
  tone = "primary",
  className,
  ...props
}: ButtonProps) {
  return (
    <button
      className={buttonRecipe({ size, tone, className })}
      {...props}
    >
      {children}
    </button>
  );
}
```

### **Step 3: Create CLS Contract** üìù

**After (CLS):**

```typescript
import { cls } from "@use-pico/cls";
import { useCls } from "@use-pico/cls/react";
import type { Component } from "@use-pico/cls";

// Define the CLS instance
const ButtonCls = cls({
  slot: ["root"],
  variant: {
    size: ["sm", "md", "lg"],
    tone: ["primary", "secondary"]
  }
}, ({ what, def }) => ({
  token: def.token({
    "color.bg.primary": ["bg-blue-600"],
    "color.bg.secondary": ["bg-gray-600"],
    "color.text.primary": ["text-white"],
    "color.text.secondary": ["text-white"],
    "spacing.sm": ["px-3 py-1.5"],
    "spacing.md": ["px-4 py-2"],
    "spacing.lg": ["px-6 py-3"]
  }),
  rules: [
    def.root({
      root: what.css([
        "inline-flex items-center justify-center rounded font-medium transition-colors",
        "outline-none cursor-pointer",
        "focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",
        "disabled:opacity-50 disabled:cursor-not-allowed"
      ])
    }),
    def.rule({
      variant: { size: "sm" },
      root: what.css(["text-sm", "spacing.sm"])
    }),
    def.rule({
      variant: { size: "md" },
      root: what.css(["text-base", "spacing.md"])
    }),
    def.rule({
      variant: { size: "lg" },
      root: what.css(["text-lg", "spacing.lg"])
    }),
    def.rule({
      variant: { tone: "primary" },
      root: what.css(["color.bg.primary", "color.text.primary", "focus:ring-blue-500"])
    }),
    def.rule({
      variant: { tone: "secondary" },
      root: what.css(["color.bg.secondary", "color.text.secondary", "focus:ring-gray-500"])
    })
  ],
  defaults: def.defaults({
    size: "md",
    tone: "primary"
  })
}));

// React component
interface ButtonProps extends Component<typeof ButtonCls, React.ButtonHTMLAttributes<HTMLButtonElement>> {
  children: React.ReactNode;
  size?: "sm" | "md" | "lg";
  tone?: "primary" | "secondary";
}

function Button({
  children,
  size = "md",
  tone = "primary",
  tva = ButtonCls,
  cls,
  ...props
}: ButtonProps) {
  const buttonClasses = useCls(tva, cls, ({ what }) => ({
    variant: what.variant({
      size,
      tone
    })
  }));

  return (
    <button className={buttonClasses.root()} {...props}>
      {children}
    </button>
  );
}
```

### **Step 4: Key Differences** üîÑ

| Vanilla Extract Concept | CLS Equivalent | Notes |
|-------------------------|----------------|-------|
| `recipe()` | `cls()` | Main function for creating styling instances |
| `style()` | `def.root()` | Base styles for the component |
| `styleVariants()` | `def.rule()` | Variant-specific styles |
| `variants` | `variant` in contract | Define available variant options |
| `defaultVariants` | `defaults` | Set default variant values |
| Build-time CSS generation | Runtime class generation | Move from compile-time to runtime |

### **Step 5: Migration Checklist** ‚úÖ

- [ ] **Install CLS** and remove Vanilla Extract dependency
- [ ] **Convert CSS properties** to Tailwind CSS classes
- [ ] **Create CLS contracts** for each component
- [ ] **Migrate build-time styles** to runtime classes
- [ ] **Convert CSS pseudo-classes** to Tailwind equivalents
- [ ] **Migrate component interfaces** to use `Component<T>`
- [ ] **Replace recipe calls** with `useCls()` hook
- [ ] **Test all variant combinations** work correctly
- [ ] **Remove Vanilla Extract imports** and clean up dependencies
- [ ] **Update build configuration** to remove Vanilla Extract

## **Migration from CSS Modules** üìÑ

### **Step 1: Install CLS** üì•

```bash
npm install @use-pico/cls
```

### **Step 2: Analyze Current CSS Modules** üîç

**Before (CSS Modules):**

```css
/* Button.module.css */
.button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border-radius: 0.375rem;
  font-weight: 500;
  transition: colors;
  outline: none;
  cursor: pointer;
}

.button:focus {
  box-shadow: 0 0 0 2px #3b82f6, 0 0 0 4px #ffffff;
}

.button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.small {
  padding: 0.375rem 0.75rem;
  font-size: 0.875rem;
}

.medium {
  padding: 0.5rem 1rem;
  font-size: 1rem;
}

.large {
  padding: 0.75rem 1.5rem;
  font-size: 1.125rem;
}

.primary {
  background-color: #2563eb;
  color: #ffffff;
}

.primary:focus {
  box-shadow: 0 0 0 2px #3b82f6, 0 0 0 4px #ffffff;
}

.secondary {
  background-color: #4b5563;
  color: #ffffff;
}

.secondary:focus {
  box-shadow: 0 0 0 2px #6b7280, 0 0 0 4px #ffffff;
}
```

```typescript
import styles from "./Button.module.css";
import { cn } from "@/lib/utils";

interface ButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {
  children: React.ReactNode;
  size?: "sm" | "md" | "lg";
  tone?: "primary" | "secondary";
}

function Button({
  children,
  size = "md",
  tone = "primary",
  className,
  disabled,
  ...props
}: ButtonProps) {
  const sizeClass = {
    sm: styles.small,
    md: styles.medium,
    lg: styles.large,
  }[size];

  const toneClass = {
    primary: styles.primary,
    secondary: styles.secondary,
  }[tone];

  return (
    <button
      className={cn(styles.button, sizeClass, toneClass, className)}
      disabled={disabled}
      {...props}
    >
      {children}
    </button>
  );
}
```

### **Step 3: Create CLS Contract** üìù

**After (CLS):**

```typescript
import { cls } from "@use-pico/cls";
import { useCls } from "@use-pico/cls/react";
import type { Component } from "@use-pico/cls";

// Define the CLS instance
const ButtonCls = cls({
  slot: ["root"],
  variant: {
    size: ["sm", "md", "lg"],
    tone: ["primary", "secondary"]
  }
}, ({ what, def }) => ({
  token: def.token({
    "color.bg.primary": ["bg-blue-600"],
    "color.bg.secondary": ["bg-gray-600"],
    "color.text.primary": ["text-white"],
    "color.text.secondary": ["text-white"],
    "spacing.sm": ["px-3 py-1.5"],
    "spacing.md": ["px-4 py-2"],
    "spacing.lg": ["px-6 py-3"]
  }),
  rules: [
    def.root({
      root: what.css([
        "inline-flex items-center justify-center rounded font-medium transition-colors",
        "outline-none cursor-pointer",
        "focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",
        "disabled:opacity-50 disabled:cursor-not-allowed"
      ])
    }),
    def.rule({
      variant: { size: "sm" },
      root: what.css(["text-sm", "spacing.sm"])
    }),
    def.rule({
      variant: { size: "md" },
      root: what.css(["text-base", "spacing.md"])
    }),
    def.rule({
      variant: { size: "lg" },
      root: what.css(["text-lg", "spacing.lg"])
    }),
    def.rule({
      variant: { tone: "primary" },
      root: what.css(["color.bg.primary", "color.text.primary", "focus:ring-blue-500"])
    }),
    def.rule({
      variant: { tone: "secondary" },
      root: what.css(["color.bg.secondary", "color.text.secondary", "focus:ring-gray-500"])
    })
  ],
  defaults: def.defaults({
    size: "md",
    tone: "primary"
  })
}));

// React component
interface ButtonProps extends Component<typeof ButtonCls, React.ButtonHTMLAttributes<HTMLButtonElement>> {
  children: React.ReactNode;
  size?: "sm" | "md" | "lg";
  tone?: "primary" | "secondary";
}

function Button({
  children,
  size = "md",
  tone = "primary",
  tva = ButtonCls,
  cls,
  ...props
}: ButtonProps) {
  const buttonClasses = useCls(tva, cls, ({ what }) => ({
    variant: what.variant({
      size,
      tone
    })
  }));

  return (
    <button className={buttonClasses.root()} {...props}>
      {children}
    </button>
  );
}
```

### **Step 4: Key Differences** üîÑ

| CSS Modules Concept | CLS Equivalent | Notes |
|---------------------|----------------|-------|
| CSS files | Tailwind CSS classes | Convert CSS to utility classes |
| `styles.className` | `useCls()` hook | Class name generation |
| Manual class mapping | Automatic variant resolution | No need for manual class selection |
| CSS pseudo-classes | Tailwind pseudo-classes | Convert CSS to Tailwind equivalents |
| Scoped CSS | Global utility classes | Move from scoped to global classes |

### **Step 5: Migration Checklist** ‚úÖ

- [ ] **Install CLS** and Tailwind CSS
- [ ] **Convert CSS properties** to Tailwind CSS classes
- [ ] **Create CLS contracts** for each component
- [ ] **Migrate component interfaces** to use `Component<T>`
- [ ] **Replace manual class mapping** with `useCls()` hook
- [ ] **Convert CSS pseudo-classes** to Tailwind equivalents
- [ ] **Test all variant combinations** work correctly
- [ ] **Remove CSS Module files** and clean up dependencies
- [ ] **Update build configuration** to remove CSS Modules

## **Migration from Tailwind CSS** üé®

### **Step 1: Install CLS** üì•

```bash
npm install @use-pico/cls
```

### **Step 2: Analyze Current Tailwind Components** üîç

**Before (Tailwind CSS):**

```typescript
import { cn } from "@/lib/utils";

interface ButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {
  children: React.ReactNode;
  size?: "sm" | "md" | "lg";
  tone?: "primary" | "secondary" | "danger";
}

function Button({
  children,
  size = "md",
  tone = "primary",
  className,
  disabled,
  ...props
}: ButtonProps) {
  const sizeClasses = {
    sm: "px-3 py-1.5 text-sm",
    md: "px-4 py-2 text-base",
    lg: "px-6 py-3 text-lg",
  };

  const toneClasses = {
    primary: "bg-blue-600 text-white focus:ring-blue-500",
    secondary: "bg-gray-600 text-white focus:ring-gray-500",
    danger: "bg-red-600 text-white focus:ring-red-500",
  };

  return (
    <button
      className={cn(
        "inline-flex items-center justify-center rounded font-medium transition-colors",
        "focus:outline-none focus:ring-2 focus:ring-offset-2",
        "disabled:opacity-50 disabled:cursor-not-allowed",
        sizeClasses[size],
        toneClasses[tone],
        className
      )}
      disabled={disabled}
      {...props}
    >
      {children}
    </button>
  );
}
```

### **Step 3: Create CLS Contract** üìù

**After (CLS):**

```typescript
import { cls } from "@use-pico/cls";
import { useCls } from "@use-pico/cls/react";
import type { Component } from "@use-pico/cls";

// Define the CLS instance
const ButtonCls = cls({
  slot: ["root"],
  variant: {
    size: ["sm", "md", "lg"],
    tone: ["primary", "secondary", "danger"]
  }
}, ({ what, def }) => ({
  token: def.token({
    "color.bg.primary": ["bg-blue-600"],
    "color.bg.secondary": ["bg-gray-600"],
    "color.bg.danger": ["bg-red-600"],
    "color.text.primary": ["text-white"],
    "color.text.secondary": ["text-white"],
    "color.text.danger": ["text-white"],
    "spacing.sm": ["px-3 py-1.5"],
    "spacing.md": ["px-4 py-2"],
    "spacing.lg": ["px-6 py-3"]
  }),
  rules: [
    def.root({
      root: what.css([
        "inline-flex items-center justify-center rounded font-medium transition-colors",
        "focus:outline-none focus:ring-2 focus:ring-offset-2",
        "disabled:opacity-50 disabled:cursor-not-allowed"
      ])
    }),
    def.rule({
      variant: { size: "sm" },
      root: what.css(["text-sm", "spacing.sm"])
    }),
    def.rule({
      variant: { size: "md" },
      root: what.css(["text-base", "spacing.md"])
    }),
    def.rule({
      variant: { size: "lg" },
      root: what.css(["text-lg", "spacing.lg"])
    }),
    def.rule({
      variant: { tone: "primary" },
      root: what.css(["color.bg.primary", "color.text.primary", "focus:ring-blue-500"])
    }),
    def.rule({
      variant: { tone: "secondary" },
      root: what.css(["color.bg.secondary", "color.text.secondary", "focus:ring-gray-500"])
    }),
    def.rule({
      variant: { tone: "danger" },
      root: what.css(["color.bg.danger", "color.text.danger", "focus:ring-red-500"])
    })
  ],
  defaults: def.defaults({
    size: "md",
    tone: "primary"
  })
}));

// React component
interface ButtonProps extends Component<typeof ButtonCls, React.ButtonHTMLAttributes<HTMLButtonElement>> {
  children: React.ReactNode;
  size?: "sm" | "md" | "lg";
  tone?: "primary" | "secondary" | "danger";
}

function Button({
  children,
  size = "md",
  tone = "primary",
  tva = ButtonCls,
  cls,
  ...props
}: ButtonProps) {
  const buttonClasses = useCls(tva, cls, ({ what }) => ({
    variant: what.variant({
      size,
      tone
    })
  }));

  return (
    <button className={buttonClasses.root()} {...props}>
      {children}
    </button>
  );
}
```

### **Step 4: Key Differences** üîÑ

| Tailwind CSS Concept | CLS Equivalent | Notes |
|----------------------|----------------|-------|
| Manual class mapping | Automatic variant resolution | No need for manual class selection |
| `cn()` utility | `useCls()` hook | Class name generation and composition |
| Hardcoded class strings | Design token system | Move to token-based approach |
| Manual prop handling | Type-safe variant system | Automatic type inference |
| Inline class concatenation | Rule-based styling | Declarative styling approach |

### **Step 5: Migration Checklist** ‚úÖ

- [ ] **Install CLS** (Tailwind CSS can remain)
- [ ] **Create CLS contracts** for each component
- [ ] **Extract design tokens** from hardcoded classes
- [ ] **Migrate component interfaces** to use `Component<T>`
- [ ] **Replace manual class mapping** with `useCls()` hook
- [ ] **Convert inline class concatenation** to rule-based styling
- [ ] **Test all variant combinations** work correctly
- [ ] **Remove manual prop handling** for variants
- [ ] **Keep Tailwind CSS** for utility classes

## **Best Practices for Migration** üéØ

### **1. Start Small** üê£

- **Begin with simple components** like buttons and cards
- **Gradually migrate** more complex components
- **Test thoroughly** at each step
- **Get team feedback** early and often

### **2. Plan Your Architecture** üèóÔ∏è

- **Design your token system** before starting migration
- **Plan inheritance hierarchy** for related components
- **Consider composition patterns** for complex layouts
- **Document your decisions** for team reference

### **3. Maintain Consistency** üìè

- **Use consistent naming** for tokens and variants
- **Follow established patterns** across all components
- **Create reusable contracts** for common patterns
- **Document your conventions** for future reference

### **4. Test Thoroughly** üß™

- **Test all variant combinations** work correctly
- **Verify type safety** with TypeScript
- **Check performance** with real-world usage
- **Validate accessibility** features still work

### **5. Train Your Team** üë•

- **Provide documentation** and examples
- **Conduct training sessions** on CLS concepts
- **Create migration guides** for common patterns
- **Establish code review** processes for CLS usage

### **6. Monitor and Iterate** üìä

- **Track migration progress** and identify blockers
- **Collect feedback** from developers
- **Iterate on patterns** based on usage
- **Optimize performance** where needed

## **Common Migration Challenges** ‚ö†Ô∏è

### **1. Learning Curve** üìö

**Challenge**: Team needs to learn CLS concepts and patterns.

**Solution**: 
- Provide comprehensive documentation
- Create interactive examples
- Conduct hands-on training sessions
- Start with simple components

### **2. Type Safety** üõ°Ô∏è

**Challenge**: Ensuring all components maintain type safety during migration.

**Solution**:
- Use TypeScript strict mode
- Leverage CLS's built-in type inference
- Create proper component interfaces
- Test type safety with real usage

### **3. Performance** ‚ö°

**Challenge**: Maintaining or improving performance during migration.

**Solution**:
- Profile before and after migration
- Use CLS's lazy evaluation features
- Optimize token resolution
- Monitor bundle size changes

### **4. Design Token Organization** üé®

**Challenge**: Organizing design tokens in a scalable way.

**Solution**:
- Plan token hierarchy before migration
- Use semantic naming conventions
- Create reusable token contracts
- Document token usage patterns

### **5. Legacy Code Integration** üîó

**Challenge**: Integrating CLS with existing codebase.

**Solution**:
- Use gradual migration approach
- Create compatibility layers if needed
- Maintain backward compatibility
- Test integration thoroughly

## **Migration Success Metrics** üìà

### **Quantitative Metrics** üìä

- **Migration completion rate** - Percentage of components migrated
- **Type safety coverage** - Number of type errors resolved
- **Bundle size impact** - Change in bundle size after migration
- **Performance metrics** - Runtime performance improvements
- **Developer productivity** - Time to implement new components

### **Qualitative Metrics** üéØ

- **Developer satisfaction** - Team feedback on CLS usage
- **Code maintainability** - Ease of maintaining migrated components
- **Design consistency** - Improved visual consistency across components
- **Documentation quality** - Completeness and clarity of documentation
- **Team adoption** - Speed of team adoption and usage

## **The Bottom Line** üí°

Migration to CLS is a **strategic investment** in your design system's future. While it requires **initial effort** and **team learning**, the benefits of **type safety**, **scalability**, and **developer experience** make it worthwhile for teams building **complex, maintainable applications**.

The key to successful migration is **planning**, **gradual adoption**, and **team support**. Start small, learn from each step, and build momentum toward a **more robust and scalable styling system**! üöÄ

---

**[‚Üê Previous: Code Comparisons](./13.2-code-comparisons.md)** | **[‚Üí Next: vs CVA](./13.4-vs-cva-class-variance-authority.md)**
