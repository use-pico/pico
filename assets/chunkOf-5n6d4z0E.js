var kr=r=>{throw TypeError(r)},Sr=(r,e,t)=>e.has(r)||kr("Cannot "+t),me=(r,e,t)=>(Sr(r,e,"read from private field"),t?t.call(r):e.get(r)),et=(r,e,t)=>e.has(r)?kr("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),qe=(r,e,t,i)=>(Sr(r,e,"write to private field"),e.set(r,t),t);const Tr="KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIHUobil7aWYobj09PSIvIilyZXR1cm57cGFyZW50Om51bGwsbmFtZToiIn07Y29uc3QgZT1uLnNwbGl0KCIvIikuZmlsdGVyKGk9PmkubGVuZ3RoPjApO2lmKGUubGVuZ3RoPT09MCl0aHJvdyBFcnJvcigiSW52YWxpZCBwYXRoIik7Y29uc3QgYT1lW2UubGVuZ3RoLTFdLHI9Ii8iK2Uuc2xpY2UoMCwtMSkuam9pbigiLyIpO3JldHVybntuYW1lOmEscGFyZW50OnJ9fWFzeW5jIGZ1bmN0aW9uIHcobixlKXtjb25zdHtwYXJlbnQ6YSxuYW1lOnJ9PXUobik7aWYoYT09bnVsbClyZXR1cm4gYXdhaXQgbmF2aWdhdG9yLnN0b3JhZ2UuZ2V0RGlyZWN0b3J5KCk7Y29uc3QgaT1hLnNwbGl0KCIvIikuZmlsdGVyKHQ9PnQubGVuZ3RoPjApO3RyeXtsZXQgdD1hd2FpdCBuYXZpZ2F0b3Iuc3RvcmFnZS5nZXREaXJlY3RvcnkoKTtmb3IoY29uc3QgcyBvZiBpKXQ9YXdhaXQgdC5nZXREaXJlY3RvcnlIYW5kbGUocyx7Y3JlYXRlOmUuY3JlYXRlfSk7aWYoZS5pc0ZpbGUpcmV0dXJuIGF3YWl0IHQuZ2V0RmlsZUhhbmRsZShyLHtjcmVhdGU6ZS5jcmVhdGV9KX1jYXRjaCh0KXtpZih0Lm5hbWU9PT0iTm90Rm91bmRFcnJvciIpcmV0dXJuIG51bGw7dGhyb3cgdH19Y29uc3QgZj17fTtzZWxmLm9ubWVzc2FnZT1hc3luYyBuPT57dmFyIGk7Y29uc3R7ZXZ0VHlwZTplLGFyZ3M6YX09bi5kYXRhO2xldCByPWZbYS5maWxlSWRdO3RyeXtsZXQgdDtjb25zdCBzPVtdO2lmKGU9PT0icmVnaXN0ZXIiKXtjb25zdCBsPWF3YWl0IHcoYS5maWxlUGF0aCx7Y3JlYXRlOiEwLGlzRmlsZTohMH0pO2lmKGw9PW51bGwpdGhyb3cgRXJyb3IoYG5vdCBmb3VuZCBmaWxlOiAke2EuZmlsZUlkfWApO3I9YXdhaXQgbC5jcmVhdGVTeW5jQWNjZXNzSGFuZGxlKHttb2RlOmEubW9kZX0pLGZbYS5maWxlSWRdPXJ9ZWxzZSBpZihlPT09ImNsb3NlIilhd2FpdCByLmNsb3NlKCksZGVsZXRlIGZbYS5maWxlSWRdO2Vsc2UgaWYoZT09PSJ0cnVuY2F0ZSIpYXdhaXQgci50cnVuY2F0ZShhLm5ld1NpemUpO2Vsc2UgaWYoZT09PSJ3cml0ZSIpe2NvbnN0e2RhdGE6bCxvcHRzOm99PW4uZGF0YS5hcmdzO3Q9YXdhaXQgci53cml0ZShsLG8pfWVsc2UgaWYoZT09PSJyZWFkIil7Y29uc3R7b2Zmc2V0Omwsc2l6ZTpvfT1uLmRhdGEuYXJncyxnPW5ldyBVaW50OEFycmF5KG8pLGQ9YXdhaXQgci5yZWFkKGcse2F0Omx9KSxjPWcuYnVmZmVyO3Q9ZD09PW8/YzooKGk9Yy50cmFuc2Zlcik9PW51bGw/dm9pZCAwOmkuY2FsbChjLGQpKT8/Yy5zbGljZSgwLGQpLHMucHVzaCh0KX1lbHNlIGU9PT0iZ2V0U2l6ZSI/dD1hd2FpdCByLmdldFNpemUoKTplPT09ImZsdXNoIiYmYXdhaXQgci5mbHVzaCgpO3NlbGYucG9zdE1lc3NhZ2Uoe2V2dFR5cGU6ImNhbGxiYWNrIixjYklkOm4uZGF0YS5jYklkLHJldHVyblZhbDp0fSxzKX1jYXRjaCh0KXtjb25zdCBzPXQ7c2VsZi5wb3N0TWVzc2FnZSh7ZXZ0VHlwZToidGhyb3dFcnJvciIsY2JJZDpuLmRhdGEuY2JJZCxlcnJNc2c6cy5uYW1lKyI6ICIrcy5tZXNzYWdlK2AKYCtKU09OLnN0cmluZ2lmeShuLmRhdGEpfSl9fX0pKCk7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPW9wZnMtd29ya2VyLUY0UldscWNfLmpzLm1hcAo=",Br=r=>Uint8Array.from(atob(r),e=>e.charCodeAt(0)),cr=typeof self<"u"&&self.Blob&&new Blob([Br(Tr)],{type:"text/javascript;charset=utf-8"});function Cr(r){let e;try{if(e=cr&&(self.URL||self.webkitURL).createObjectURL(cr),!e)throw"";const t=new Worker(e,{name:r?.name});return t.addEventListener("error",()=>{(self.URL||self.webkitURL).revokeObjectURL(e)}),t}catch{return new Worker("data:text/javascript;base64,"+Tr,{name:r?.name})}finally{e&&(self.URL||self.webkitURL).revokeObjectURL(e)}}async function Xr(r,e,t){const i=Zr();return await i("register",{fileId:r,filePath:e,mode:t}),{read:async(o,n)=>await i("read",{fileId:r,offset:o,size:n}),write:async(o,n)=>await i("write",{fileId:r,data:o,opts:n},[ArrayBuffer.isView(o)?o.buffer:o]),close:async()=>await i("close",{fileId:r}),truncate:async o=>await i("truncate",{fileId:r,newSize:o}),getSize:async()=>await i("getSize",{fileId:r}),flush:async()=>await i("flush",{fileId:r})}}const zt=[];let Ht=0;function Zr(){if(zt.length<3){const e=r();return zt.push(e),e}else{const e=zt[Ht];return Ht=(Ht+1)%zt.length,e}function r(){const e=new Cr;let t=0,i={};return e.onmessage=({data:o})=>{var n,a;o.evtType==="callback"?(n=i[o.cbId])==null||n.resolve(o.returnVal):o.evtType==="throwError"&&((a=i[o.cbId])==null||a.reject(Error(o.errMsg))),delete i[o.cbId]},async function(o,n,a=[]){t+=1;const s=new Promise((c,p)=>{i[t]={resolve:c,reject:p}});return e.postMessage({cbId:t,evtType:o,args:n},a),s}}}function Yt(r){if(r==="/")return{parent:null,name:""};const e=r.split("/").filter(o=>o.length>0);if(e.length===0)throw Error("Invalid path");const t=e[e.length-1],i="/"+e.slice(0,-1).join("/");return{name:t,parent:i}}async function mt(r,e){const{parent:t,name:i}=Yt(r);if(t==null)return await navigator.storage.getDirectory();const o=t.split("/").filter(n=>n.length>0);try{let n=await navigator.storage.getDirectory();for(const a of o)n=await n.getDirectoryHandle(a,{create:e.create});return e.isFile?await n.getFileHandle(i,{create:e.create}):await n.getDirectoryHandle(i,{create:e.create})}catch(n){if(n.name==="NotFoundError")return null;throw n}}async function Or(r){const{parent:e,name:t}=Yt(r);if(e==null){const o=await navigator.storage.getDirectory();for await(const n of o.keys())await o.removeEntry(n,{recursive:!0});return}const i=await mt(e,{create:!1,isFile:!1});i!=null&&await i.removeEntry(t,{recursive:!0})}function qt(r,e){return`${r}/${e}`.replace("//","/")}function xt(r){return new Pr(r)}var nt,Gt,Rt;const Yr=class Wr{constructor(e){et(this,nt),et(this,Gt),et(this,Rt),qe(this,nt,e);const{parent:t,name:i}=Yt(e);qe(this,Gt,i),qe(this,Rt,t)}get kind(){return"dir"}get name(){return me(this,Gt)}get path(){return me(this,nt)}get parent(){return me(this,Rt)==null?null:xt(me(this,Rt))}async create(){return await mt(me(this,nt),{create:!0,isFile:!1}),xt(me(this,nt))}async exists(){return await mt(me(this,nt),{create:!1,isFile:!1})instanceof FileSystemDirectoryHandle}async remove(){for(const e of await this.children())try{await e.remove()}catch(t){console.warn(t)}try{await Or(me(this,nt))}catch(e){console.warn(e)}}async children(){const e=await mt(me(this,nt),{create:!1,isFile:!1});if(e==null)return[];const t=[];for await(const i of e.values())t.push((i.kind==="file"?kt:xt)(qt(me(this,nt),i.name)));return t}async copyTo(e){if(!await this.exists())throw Error(`dir ${this.path} not exists`);if(e instanceof Wr){const t=await e.exists()?xt(qt(e.path,this.name)):e;await t.create(),await Promise.all((await this.children()).map(i=>i.copyTo(t)));return}else if(e instanceof FileSystemDirectoryHandle){await Promise.all((await this.children()).map(async t=>{t.kind==="file"?await t.copyTo(await e.getFileHandle(t.name,{create:!0})):await t.copyTo(await e.getDirectoryHandle(t.name,{create:!0}))}));return}throw Error("Illegal target type")}async moveTo(e){await this.copyTo(e),await this.remove()}};nt=new WeakMap,Gt=new WeakMap,Rt=new WeakMap;let Pr=Yr;const lr=new Map;function kt(r,e="rw"){if(e==="rw"){const t=lr.get(r)??new Zt(r,e);return lr.set(r,t),t}return new Zt(r,e)}async function nr(r,e,t={overwrite:!0}){if(e instanceof Zt){await nr(r,await e.stream(),t);return}const i=await(r instanceof Zt?r:kt(r,"rw")).createWriter();try{if(t.overwrite&&await i.truncate(0),e instanceof ReadableStream){const o=e.getReader();for(;;){const{done:n,value:a}=await o.read();if(n)break;await i.write(a)}}else await i.write(e)}catch(o){throw o}finally{await i.close()}}let Ur=0;const Vr=()=>++Ur;var it,Dt,Bt,Et,Ct,dt,Xt,At;const Hr=class Mr{constructor(e,t){et(this,it),et(this,Dt),et(this,Bt),et(this,Et),et(this,Ct),et(this,dt,0),et(this,Xt,(()=>{let n=null;return()=>(qe(this,dt,me(this,dt)+1),n??(n=new Promise(async(a,s)=>{try{const c=await Xr(me(this,Ct),me(this,it),me(this,Et));a([c,async()=>{qe(this,dt,me(this,dt)-1),!(me(this,dt)>0)&&(n=null,await c.close())}])}catch(c){s(c)}})))})()),et(this,At,!1),qe(this,Ct,Vr()),qe(this,it,e),qe(this,Et,{r:"read-only",rw:"readwrite","rw-unsafe":"readwrite-unsafe"}[t]);const{parent:i,name:o}=Yt(e);if(i==null)throw Error("Invalid path");qe(this,Bt,o),qe(this,Dt,i)}get kind(){return"file"}get path(){return me(this,it)}get name(){return me(this,Bt)}get parent(){return me(this,Dt)==null?null:xt(me(this,Dt))}async createWriter(){if(me(this,Et)==="read-only")throw Error("file is read-only");if(me(this,At))throw Error("Other writer have not been closed");qe(this,At,!0);const e=new TextEncoder,[t,i]=await me(this,Xt).call(this);let o=await t.getSize(),n=!1;return{write:async(a,s={})=>{if(n)throw Error("Writer is closed");const c=typeof a=="string"?e.encode(a):a,p=s.at??o,f=c.byteLength;return o=p+f,await t.write(c,{at:p})},truncate:async a=>{if(n)throw Error("Writer is closed");await t.truncate(a),o>a&&(o=a)},flush:async()=>{if(n)throw Error("Writer is closed");await t.flush()},close:async()=>{if(n)throw Error("Writer is closed");n=!0,qe(this,At,!1),await i()}}}async createReader(){const[e,t]=await me(this,Xt).call(this);let i=!1,o=0;return{read:async(n,a={})=>{if(i)throw Error("Reader is closed");const s=a.at??o,c=await e.read(s,n);return o=s+c.byteLength,c},getSize:async()=>{if(i)throw Error("Reader is closed");return await e.getSize()},close:async()=>{i||(i=!0,await t())}}}async text(){return new TextDecoder().decode(await this.arrayBuffer())}async arrayBuffer(){const e=await mt(me(this,it),{create:!1,isFile:!0});return e==null?new ArrayBuffer(0):(await e.getFile()).arrayBuffer()}async stream(){const e=await this.getOriginFile();return e==null?new ReadableStream({pull:t=>{t.close()}}):e.stream()}async getOriginFile(){var e;return(e=await mt(me(this,it),{create:!1,isFile:!0}))==null?void 0:e.getFile()}async getSize(){const e=await mt(me(this,it),{create:!1,isFile:!0});return e==null?0:(await e.getFile()).size}async exists(){return await mt(me(this,it),{create:!1,isFile:!0})instanceof FileSystemFileHandle}async remove(){if(me(this,dt))throw Error("exists unclosed reader/writer");await Or(me(this,it))}async copyTo(e){if(e instanceof Mr){if(e.path===this.path)return;await nr(e.path,this);return}else if(e instanceof Pr){if(!await this.exists())throw Error(`file ${this.path} not exists`);return await this.copyTo(kt(qt(e.path,this.name)))}else if(e instanceof FileSystemFileHandle){await(await this.stream()).pipeTo(await e.createWritable());return}throw Error("Illegal target type")}async moveTo(e){await this.copyTo(e),await this.remove()}};it=new WeakMap,Dt=new WeakMap,Bt=new WeakMap,Et=new WeakMap,Ct=new WeakMap,dt=new WeakMap,Xt=new WeakMap,At=new WeakMap;let Zt=Hr;const Fr="/.opfs-tools-temp-dir";async function Rr(r){try{if(r.kind==="file"){if(!await r.exists())return!0;const e=await r.createWriter();await e.truncate(0),await e.close(),await r.remove()}else await r.remove();return!0}catch(e){return console.warn(e),!1}}function Qr(){setInterval(async()=>{for(const r of await xt(Fr).children()){const e=/^\d+-(\d+)$/.exec(r.name);(e==null||Date.now()-Number(e[1])>2592e5)&&await Rr(r)}},60*1e3)}const ur=[];let fr=!1;async function Jr(){if(globalThis.localStorage==null)return;const r="OPFS_TOOLS_EXPIRES_TMP_FILES";fr||(fr=!0,globalThis.addEventListener("unload",()=>{ur.length!==0&&localStorage.setItem(r,`${localStorage.getItem(r)??""},${ur.join(",")}`)}));let e=localStorage.getItem(r)??"";for(const t of e.split(","))t.length!==0&&await Rr(kt(`${Fr}/${t}`))&&(e=e.replace(t,""));localStorage.setItem(r,e.replace(/,{2,}/g,","))}(async function(){var r;globalThis.__opfs_tools_tmpfile_init__!==!0&&(globalThis.__opfs_tools_tmpfile_init__=!0,!(globalThis.FileSystemDirectoryHandle==null||globalThis.FileSystemFileHandle==null||((r=globalThis.navigator)==null?void 0:r.storage.getDirectory)==null)&&(Qr(),await Jr()))})();function $r(r){if(r.__esModule)return r;var e=r.default;if(typeof e=="function"){var t=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(i){var o=Object.getOwnPropertyDescriptor(r,i);Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:function(){return r[i]}})}),t}var jt={exports:{}},qr={},Kr=Object.freeze({__proto__:null,default:qr}),gt=$r(Kr);/**
 * workerpool.js
 * https://github.com/josdejong/workerpool
 *
 * Offload tasks to a pool of workers on node.js and in the browser.
 *
 * @version 9.2.0
 * @date    2024-10-11
 *
 * @license
 * Copyright (C) 2014-2022 Jos de Jong <wjosdejong@gmail.com>
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not
 * use this file except in compliance with the License. You may obtain a copy
 * of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 * License for the specific language governing permissions and limitations under
 * the License.
 */var en=jt.exports,hr;function tn(){return hr||(hr=1,function(r,e){(function(t,i){i(e)})(en,function(t){var i={},o={exports:{}};(function(O){var F=function(Q){return typeof Q<"u"&&Q.versions!=null&&Q.versions.node!=null&&Q+""=="[object process]"};O.exports.isNode=F,O.exports.platform=typeof process<"u"&&F(process)?"node":"browser";var D=O.exports.platform==="node"&&gt;O.exports.isMainThread=O.exports.platform==="node"?(!D||D.isMainThread)&&!process.connected:typeof Window<"u",O.exports.cpus=O.exports.platform==="browser"?self.navigator.hardwareConcurrency:gt.cpus().length})(o);var n=o.exports,a={},s;function c(){if(s)return a;s=1;function O(Q,ve){var S=this;if(!(this instanceof O))throw new SyntaxError("Constructor must be called with the new operator");if(typeof Q!="function")throw new SyntaxError("Function parameter handler(resolve, reject) missing");var be=[],he=[];this.resolved=!1,this.rejected=!1,this.pending=!0;var Fe=function(T,G){be.push(T),he.push(G)};this.then=function(R,T){return new O(function(G,re){var fe=R?F(R,G,re):G,Be=T?F(T,G,re):re;Fe(fe,Be)},S)};var Le=function(T){return S.resolved=!0,S.rejected=!1,S.pending=!1,be.forEach(function(G){G(T)}),Fe=function(re,fe){re(T)},Le=E=function(){},S},E=function(T){return S.resolved=!1,S.rejected=!0,S.pending=!1,he.forEach(function(G){G(T)}),Fe=function(re,fe){fe(T)},Le=E=function(){},S};this.cancel=function(){return ve?ve.cancel():E(new D),S},this.timeout=function(R){if(ve)ve.timeout(R);else{var T=setTimeout(function(){E(new oe("Promise timed out after "+R+" ms"))},R);S.always(function(){clearTimeout(T)})}return S},Q(function(R){Le(R)},function(R){E(R)})}function F(Q,ve,S){return function(be){try{var he=Q(be);he&&typeof he.then=="function"&&typeof he.catch=="function"?he.then(ve,S):ve(he)}catch(Fe){S(Fe)}}}O.prototype.catch=function(Q){return this.then(null,Q)},O.prototype.always=function(Q){return this.then(Q,Q)},O.prototype.finally=function(Q){var ve=this,S=function(){return new O(function(he){return he()}).then(Q).then(function(){return ve})};return this.then(S,S)},O.all=function(Q){return new O(function(ve,S){var be=Q.length,he=[];be?Q.forEach(function(Fe,Le){Fe.then(function(E){he[Le]=E,be--,be==0&&ve(he)},function(E){be=0,S(E)})}):ve(he)})},O.defer=function(){var Q={};return Q.promise=new O(function(ve,S){Q.resolve=ve,Q.reject=S}),Q};function D(Q){this.message=Q||"promise cancelled",this.stack=new Error().stack}D.prototype=new Error,D.prototype.constructor=Error,D.prototype.name="CancellationError",O.CancellationError=D;function oe(Q){this.message=Q||"timeout exceeded",this.stack=new Error().stack}return oe.prototype=new Error,oe.prototype.constructor=Error,oe.prototype.name="TimeoutError",O.TimeoutError=oe,a.Promise=O,a}function p(O,F){(F==null||F>O.length)&&(F=O.length);for(var D=0,oe=Array(F);D<F;D++)oe[D]=O[D];return oe}function f(O,F){var D=typeof Symbol<"u"&&O[Symbol.iterator]||O["@@iterator"];if(!D){if(Array.isArray(O)||(D=x(O))||F){D&&(O=D);var oe=0,Q=function(){};return{s:Q,n:function(){return oe>=O.length?{done:!0}:{done:!1,value:O[oe++]}},e:function(he){throw he},f:Q}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ve,S=!0,be=!1;return{s:function(){D=D.call(O)},n:function(){var he=D.next();return S=he.done,he},e:function(he){be=!0,ve=he},f:function(){try{S||D.return==null||D.return()}finally{if(be)throw ve}}}}function l(O,F,D){return(F=v(F))in O?Object.defineProperty(O,F,{value:D,enumerable:!0,configurable:!0,writable:!0}):O[F]=D,O}function u(O,F){var D=Object.keys(O);if(Object.getOwnPropertySymbols){var oe=Object.getOwnPropertySymbols(O);F&&(oe=oe.filter(function(Q){return Object.getOwnPropertyDescriptor(O,Q).enumerable})),D.push.apply(D,oe)}return D}function h(O){for(var F=1;F<arguments.length;F++){var D=arguments[F]!=null?arguments[F]:{};F%2?u(Object(D),!0).forEach(function(oe){l(O,oe,D[oe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(D)):u(Object(D)).forEach(function(oe){Object.defineProperty(O,oe,Object.getOwnPropertyDescriptor(D,oe))})}return O}function m(O,F){if(typeof O!="object"||!O)return O;var D=O[Symbol.toPrimitive];if(D!==void 0){var oe=D.call(O,F);if(typeof oe!="object")return oe;throw new TypeError("@@toPrimitive must return a primitive value.")}return(F==="string"?String:Number)(O)}function v(O){var F=m(O,"string");return typeof F=="symbol"?F:F+""}function g(O){"@babel/helpers - typeof";return g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(F){return typeof F}:function(F){return F&&typeof Symbol=="function"&&F.constructor===Symbol&&F!==Symbol.prototype?"symbol":typeof F},g(O)}function x(O,F){if(O){if(typeof O=="string")return p(O,F);var D={}.toString.call(O).slice(8,-1);return D==="Object"&&O.constructor&&(D=O.constructor.name),D==="Map"||D==="Set"?Array.from(O):D==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(D)?p(O,F):void 0}}var w={exports:{}},d={},b;function _(){return b||(b=1,d.validateOptions=function(F,D,oe){if(F){var Q=F?Object.keys(F):[],ve=Q.find(function(be){return!D.includes(be)});if(ve)throw new Error('Object "'+oe+'" contains an unknown option "'+ve+'"');var S=D.find(function(be){return Object.prototype[be]&&!Q.includes(be)});if(S)throw new Error('Object "'+oe+'" contains an inherited option "'+S+'" which is not defined in the object itself but in its prototype. Only plain objects are allowed. Please remove the option from the prototype or override it with a value "undefined".');return F}},d.workerOptsNames=["credentials","name","type"],d.forkOptsNames=["cwd","detached","env","execPath","execArgv","gid","serialization","signal","killSignal","silent","stdio","uid","windowsVerbatimArguments","timeout"],d.workerThreadOptsNames=["argv","env","eval","execArgv","stdin","stdout","stderr","workerData","trackUnmanagedFds","transferList","resourceLimits","name"]),d}var k,y;function A(){return y||(y=1,k=`!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e="undefined"!=typeof globalThis?globalThis:e||self).worker=n()}(this,(function(){"use strict";function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}function n(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var t={};var r=function(e,n){this.message=e,this.transfer=n},o={};function i(e,n){var t=this;if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if("function"!=typeof e)throw new SyntaxError("Function parameter handler(resolve, reject) missing");var r=[],o=[];this.resolved=!1,this.rejected=!1,this.pending=!0;var a=function(e,n){r.push(e),o.push(n)};this.then=function(e,n){return new i((function(t,r){var o=e?u(e,t,r):t,i=n?u(n,t,r):r;a(o,i)}),t)};var f=function(e){return t.resolved=!0,t.rejected=!1,t.pending=!1,r.forEach((function(n){n(e)})),a=function(n,t){n(e)},f=d=function(){},t},d=function(e){return t.resolved=!1,t.rejected=!0,t.pending=!1,o.forEach((function(n){n(e)})),a=function(n,t){t(e)},f=d=function(){},t};this.cancel=function(){return n?n.cancel():d(new s),t},this.timeout=function(e){if(n)n.timeout(e);else{var r=setTimeout((function(){d(new c("Promise timed out after "+e+" ms"))}),e);t.always((function(){clearTimeout(r)}))}return t},e((function(e){f(e)}),(function(e){d(e)}))}function u(e,n,t){return function(r){try{var o=e(r);o&&"function"==typeof o.then&&"function"==typeof o.catch?o.then(n,t):n(o)}catch(e){t(e)}}}function s(e){this.message=e||"promise cancelled",this.stack=(new Error).stack}function c(e){this.message=e||"timeout exceeded",this.stack=(new Error).stack}return i.prototype.catch=function(e){return this.then(null,e)},i.prototype.always=function(e){return this.then(e,e)},i.prototype.finally=function(e){var n=this,t=function(){return new i((function(e){return e()})).then(e).then((function(){return n}))};return this.then(t,t)},i.all=function(e){return new i((function(n,t){var r=e.length,o=[];r?e.forEach((function(e,i){e.then((function(e){o[i]=e,0==--r&&n(o)}),(function(e){r=0,t(e)}))})):n(o)}))},i.defer=function(){var e={};return e.promise=new i((function(n,t){e.resolve=n,e.reject=t})),e},s.prototype=new Error,s.prototype.constructor=Error,s.prototype.name="CancellationError",i.CancellationError=s,c.prototype=new Error,c.prototype.constructor=Error,c.prototype.name="TimeoutError",i.TimeoutError=c,o.Promise=i,function(n){var t=r,i=o.Promise,u="__workerpool-cleanup__",s={exit:function(){}},c={addAbortListener:function(e){s.abortListeners.push(e)},emit:s.emit};if("undefined"!=typeof self&&"function"==typeof postMessage&&"function"==typeof addEventListener)s.on=function(e,n){addEventListener(e,(function(e){n(e.data)}))},s.send=function(e,n){n?postMessage(e,n):postMessage(e)};else{if("undefined"==typeof process)throw new Error("Script must be executed as a worker");var a;try{a=require("worker_threads")}catch(n){if("object"!==e(n)||null===n||"MODULE_NOT_FOUND"!==n.code)throw n}if(a&&null!==a.parentPort){var f=a.parentPort;s.send=f.postMessage.bind(f),s.on=f.on.bind(f),s.exit=process.exit.bind(process)}else s.on=process.on.bind(process),s.send=function(e){process.send(e)},s.on("disconnect",(function(){process.exit(1)})),s.exit=process.exit.bind(process)}function d(e){return Object.getOwnPropertyNames(e).reduce((function(n,t){return Object.defineProperty(n,t,{value:e[t],enumerable:!0})}),{})}function l(e){return e&&"function"==typeof e.then&&"function"==typeof e.catch}s.methods={},s.methods.run=function(e,n){var t=new Function("return ("+e+").apply(this, arguments);");return t.worker=c,t.apply(t,n)},s.methods.methods=function(){return Object.keys(s.methods)},s.terminationHandler=void 0,s.abortListenerTimeout=1e3,s.abortListeners=[],s.terminateAndExit=function(e){var n=function(){s.exit(e)};if(!s.terminationHandler)return n();var t=s.terminationHandler(e);return l(t)?(t.then(n,n),t):(n(),new i((function(e,n){n(new Error("Worker terminating"))})))},s.cleanup=function(e){if(!s.abortListeners.length)return s.send({id:e,method:u,error:d(new Error("Worker terminating"))}),new i((function(e){e()}));var n,t=s.abortListeners.map((function(e){return e()})),r=new i((function(e,t){n=setTimeout((function(){t(new Error("Timeout occured waiting for abort handler, killing worker"))}),s.abortListenerTimeout)})),o=i.all(t).then((function(){clearTimeout(n),s.abortListeners.length||(s.abortListeners=[])}),(function(){clearTimeout(n),s.exit()}));return i.all([o,r]).then((function(){s.send({id:e,method:u,error:null})}),(function(n){s.send({id:e,method:u,error:n?d(n):null})}))};var p=null;s.on("message",(function(e){if("__workerpool-terminate__"===e)return s.terminateAndExit(0);if(e.method===u)return s.cleanup(e.id);try{var n=s.methods[e.method];if(!n)throw new Error('Unknown method "'+e.method+'"');p=e.id;var r=n.apply(n,e.params);l(r)?r.then((function(n){n instanceof t?s.send({id:e.id,result:n.message,error:null},n.transfer):s.send({id:e.id,result:n,error:null}),p=null})).catch((function(n){s.send({id:e.id,result:null,error:d(n)}),p=null})):(r instanceof t?s.send({id:e.id,result:r.message,error:null},r.transfer):s.send({id:e.id,result:r,error:null}),p=null)}catch(n){s.send({id:e.id,result:null,error:d(n)})}})),s.register=function(e,n){if(e)for(var t in e)e.hasOwnProperty(t)&&(s.methods[t]=e[t],s.methods[t].worker=c);n&&(s.terminationHandler=n.onTerminate,s.abortListenerTimeout=n.abortListenerTimeout||1e3),s.send("ready")},s.emit=function(e){if(p){if(e instanceof t)return void s.send({id:p,isEvent:!0,payload:e.message},e.transfer);s.send({id:p,isEvent:!0,payload:e})}},n.add=s.register,n.emit=s.emit}(t),n(t)}));
//# sourceMappingURL=worker.min.js.map
`),k}var W;function $(){if(W)return w.exports;W=1;var O=c(),F=O.Promise,D=n,oe=_(),Q=oe.validateOptions,ve=oe.forkOptsNames,S=oe.workerThreadOptsNames,be=oe.workerOptsNames,he="__workerpool-terminate__",Fe="__workerpool-cleanup__";function Le(){var J=R();if(!J)throw new Error("WorkerPool: workerType = 'thread' is not supported, Node >= 11.7.0 required");return J}function E(){if(typeof Worker!="function"&&((typeof Worker>"u"?"undefined":g(Worker))!=="object"||typeof Worker.prototype.constructor!="function"))throw new Error("WorkerPool: Web Workers not supported")}function R(){try{return gt}catch(J){if(g(J)==="object"&&J!==null&&J.code==="MODULE_NOT_FOUND")return null;throw J}}function T(){if(D.platform==="browser"){if(typeof Blob>"u")throw new Error("Blob not supported by the browser");if(!window.URL||typeof window.URL.createObjectURL!="function")throw new Error("URL.createObjectURL not supported by the browser");var J=new Blob([A()],{type:"text/javascript"});return window.URL.createObjectURL(J)}else return __dirname+"/worker.js"}function G(J,ie){if(ie.workerType==="web")return E(),re(J,ie.workerOpts,Worker);if(ie.workerType==="thread")return M=Le(),fe(J,M,ie);if(ie.workerType==="process"||!ie.workerType)return Be(J,Ye(ie),gt);if(D.platform==="browser")return E(),re(J,ie.workerOpts,Worker);var M=R();return M?fe(J,M,ie):Be(J,Ye(ie),gt)}function re(J,ie,M){Q(ie,be,"workerOpts");var ne=new M(J,ie);return ne.isBrowserWorker=!0,ne.on=function(ae,pe){this.addEventListener(ae,function(ye){pe(ye.data)})},ne.send=function(ae,pe){this.postMessage(ae,pe)},ne}function fe(J,ie,M){var ne,ae;Q(M?.workerThreadOpts,S,"workerThreadOpts");var pe=new ie.Worker(J,h({stdout:(ne=M?.emitStdStreams)!==null&&ne!==void 0?ne:!1,stderr:(ae=M?.emitStdStreams)!==null&&ae!==void 0?ae:!1},M?.workerThreadOpts));return pe.isWorkerThread=!0,pe.send=function(ye,ce){this.postMessage(ye,ce)},pe.kill=function(){return this.terminate(),!0},pe.disconnect=function(){this.terminate()},M!=null&&M.emitStdStreams&&(pe.stdout.on("data",function(ye){return pe.emit("stdout",ye)}),pe.stderr.on("data",function(ye){return pe.emit("stderr",ye)})),pe}function Be(J,ie,M){Q(ie.forkOpts,ve,"forkOpts");var ne=M.fork(J,ie.forkArgs,ie.forkOpts),ae=ne.send;return ne.send=function(pe){return ae.call(ne,pe)},ie.emitStdStreams&&(ne.stdout.on("data",function(pe){return ne.emit("stdout",pe)}),ne.stderr.on("data",function(pe){return ne.emit("stderr",pe)})),ne.isChildProcess=!0,ne}function Ye(J){J=J||{};var ie=process.execArgv.join(" "),M=ie.indexOf("--inspect")!==-1,ne=ie.indexOf("--debug-brk")!==-1,ae=[];return M&&(ae.push("--inspect="+J.debugPort),ne&&ae.push("--debug-brk")),process.execArgv.forEach(function(pe){pe.indexOf("--max-old-space-size")>-1&&ae.push(pe)}),Object.assign({},J,{forkArgs:J.forkArgs,forkOpts:Object.assign({},J.forkOpts,{execArgv:(J.forkOpts&&J.forkOpts.execArgv||[]).concat(ae),stdio:J.emitStdStreams?"pipe":void 0})})}function Qe(J){for(var ie=new Error(""),M=Object.keys(J),ne=0;ne<M.length;ne++)ie[M[ne]]=J[M[ne]];return ie}function Je(J,ie){if(Object.keys(J.processing).length===1){var M=Object.values(J.processing)[0];M.options&&typeof M.options.on=="function"&&M.options.on(ie)}}function ht(J,ie){var M=this,ne=ie||{};this.script=J||T(),this.worker=G(this.script,ne),this.debugPort=ne.debugPort,this.forkOpts=ne.forkOpts,this.forkArgs=ne.forkArgs,this.workerOpts=ne.workerOpts,this.workerThreadOpts=ne.workerThreadOpts,this.workerTerminateTimeout=ne.workerTerminateTimeout,J||(this.worker.ready=!0),this.requestQueue=[],this.worker.on("stdout",function(ce){Je(M,{stdout:ce.toString()})}),this.worker.on("stderr",function(ce){Je(M,{stderr:ce.toString()})}),this.worker.on("message",function(ce){if(!M.terminated)if(typeof ce=="string"&&ce==="ready")M.worker.ready=!0,pe();else{var Ce=ce.id,Oe=M.processing[Ce];if(Oe!==void 0&&(ce.isEvent?Oe.options&&typeof Oe.options.on=="function"&&Oe.options.on(ce.payload):(delete M.processing[Ce],M.terminating===!0&&M.terminate(),ce.error?Oe.resolver.reject(Qe(ce.error)):Oe.resolver.resolve(ce.result))),ce.method===Fe){var Ue=M.tracking[ce.id];Ue!==void 0&&(ce.error?(clearTimeout(Ue.timeoutId),Ue.resolver.reject(Qe(ce.error))):(M.tracking&&clearTimeout(Ue.timeoutId),Ue.resolver.resolve(Ue.result))),delete M.tracking[Ce]}}});function ae(ce){M.terminated=!0;for(var Ce in M.processing)M.processing[Ce]!==void 0&&M.processing[Ce].resolver.reject(ce);M.processing=Object.create(null)}function pe(){var ce=f(M.requestQueue.splice(0)),Ce;try{for(ce.s();!(Ce=ce.n()).done;){var Oe=Ce.value;M.worker.send(Oe.message,Oe.transfer)}}catch(Ue){ce.e(Ue)}finally{ce.f()}}var ye=this.worker;this.worker.on("error",ae),this.worker.on("exit",function(ce,Ce){var Oe=`Workerpool Worker terminated Unexpectedly
`;Oe+="    exitCode: `"+ce+"`\n",Oe+="    signalCode: `"+Ce+"`\n",Oe+="    workerpool.script: `"+M.script+"`\n",Oe+="    spawnArgs: `"+ye.spawnargs+"`\n",Oe+="    spawnfile: `"+ye.spawnfile+"`\n",Oe+="    stdout: `"+ye.stdout+"`\n",Oe+="    stderr: `"+ye.stderr+"`\n",ae(new Error(Oe))}),this.processing=Object.create(null),this.tracking=Object.create(null),this.terminating=!1,this.terminated=!1,this.cleaning=!1,this.terminationHandler=null,this.lastId=0}return ht.prototype.methods=function(){return this.exec("methods")},ht.prototype.exec=function(J,ie,M,ne){M||(M=F.defer());var ae=++this.lastId;this.processing[ae]={id:ae,resolver:M,options:ne};var pe={message:{id:ae,method:J,params:ie},transfer:ne&&ne.transfer};this.terminated?M.reject(new Error("Worker is terminated")):this.worker.ready?this.worker.send(pe.message,pe.transfer):this.requestQueue.push(pe);var ye=this;return M.promise.catch(function(ce){if(ce instanceof F.CancellationError||ce instanceof F.TimeoutError)return ye.tracking[ae]={id:ae,resolver:F.defer()},delete ye.processing[ae],ye.tracking[ae].resolver.promise=ye.tracking[ae].resolver.promise.catch(function(Ce){delete ye.tracking[ae];var Oe=ye.terminateAndNotify(!0).then(function(){throw Ce},function(Ue){throw Ue});return Oe}),ye.worker.send({id:ae,method:Fe}),ye.tracking[ae].timeoutId=setTimeout(function(){ye.tracking[ae].resolver.reject(ce)},ye.workerTerminateTimeout),ye.tracking[ae].resolver.promise;throw ce})},ht.prototype.busy=function(){return this.cleaning||Object.keys(this.processing).length>0},ht.prototype.terminate=function(J,ie){var M=this;if(J){for(var ne in this.processing)this.processing[ne]!==void 0&&this.processing[ne].resolver.reject(new Error("Worker terminated"));this.processing=Object.create(null)}for(var ae=0,pe=Object.values(M.tracking);ae<pe.length;ae++){var ye=pe[ae];clearTimeout(ye.timeoutId),ye.resolver.reject(new Error("Worker Terminating"))}if(M.tracking=Object.create(null),typeof ie=="function"&&(this.terminationHandler=ie),this.busy())this.terminating=!0;else{var ce=function(Ue){if(M.terminated=!0,M.cleaning=!1,M.worker!=null&&M.worker.removeAllListeners&&M.worker.removeAllListeners("message"),M.worker=null,M.terminating=!1,M.terminationHandler)M.terminationHandler(Ue,M);else if(Ue)throw Ue};if(this.worker)if(typeof this.worker.kill=="function"){if(this.worker.killed){ce(new Error("worker already killed!"));return}var Ce=setTimeout(function(){M.worker&&M.worker.kill()},this.workerTerminateTimeout);this.worker.once("exit",function(){clearTimeout(Ce),M.worker&&(M.worker.killed=!0),ce()}),this.worker.ready?this.worker.send(he):this.requestQueue.push({message:he}),this.cleaning=!0;return}else if(typeof this.worker.terminate=="function")this.worker.terminate(),this.worker.killed=!0;else throw new Error("Failed to terminate worker");ce()}},ht.prototype.terminateAndNotify=function(J,ie){var M=F.defer();return ie&&M.promise.timeout(ie),this.terminate(J,function(ne,ae){ne?M.reject(ne):M.resolve(ae)}),M.promise},w.exports=ht,w.exports._tryRequireWorkerThreads=R,w.exports._setupProcessWorker=Be,w.exports._setupBrowserWorker=re,w.exports._setupWorkerThreadWorker=fe,w.exports.ensureWorkerThreads=Le,w.exports}var X,H;function Z(){if(H)return X;H=1;var O=65535;X=F;function F(){this.ports=Object.create(null),this.length=0}return F.prototype.nextAvailableStartingAt=function(D){for(;this.ports[D]===!0;)D++;if(D>=O)throw new Error("WorkerPool debug port limit reached: "+D+">= "+O);return this.ports[D]=!0,this.length++,D},F.prototype.releasePort=function(D){delete this.ports[D],this.length--},X}var C,K;function ee(){if(K)return C;K=1;var O=c(),F=O.Promise,D=$(),oe=n,Q=Z(),ve=new Q;function S(E,R){typeof E=="string"?this.script=E||null:(this.script=null,R=E),this.workers=[],this.tasks=[],R=R||{},this.forkArgs=Object.freeze(R.forkArgs||[]),this.forkOpts=Object.freeze(R.forkOpts||{}),this.workerOpts=Object.freeze(R.workerOpts||{}),this.workerThreadOpts=Object.freeze(R.workerThreadOpts||{}),this.debugPortStart=R.debugPortStart||43210,this.nodeWorker=R.nodeWorker,this.workerType=R.workerType||R.nodeWorker||"auto",this.maxQueueSize=R.maxQueueSize||1/0,this.workerTerminateTimeout=R.workerTerminateTimeout||1e3,this.onCreateWorker=R.onCreateWorker||function(){return null},this.onTerminateWorker=R.onTerminateWorker||function(){return null},this.emitStdStreams=R.emitStdStreams||!1,R&&"maxWorkers"in R?(be(R.maxWorkers),this.maxWorkers=R.maxWorkers):this.maxWorkers=Math.max((oe.cpus||4)-1,1),R&&"minWorkers"in R&&(R.minWorkers==="max"?this.minWorkers=this.maxWorkers:(he(R.minWorkers),this.minWorkers=R.minWorkers,this.maxWorkers=Math.max(this.minWorkers,this.maxWorkers)),this._ensureMinWorkers()),this._boundNext=this._next.bind(this),this.workerType==="thread"&&D.ensureWorkerThreads()}S.prototype.exec=function(E,R,T){if(R&&!Array.isArray(R))throw new TypeError('Array expected as argument "params"');if(typeof E=="string"){var G=F.defer();if(this.tasks.length>=this.maxQueueSize)throw new Error("Max queue size of "+this.maxQueueSize+" reached");var re=this.tasks,fe={method:E,params:R,resolver:G,timeout:null,options:T};re.push(fe);var Be=G.promise.timeout;return G.promise.timeout=function(Qe){return re.indexOf(fe)!==-1?(fe.timeout=Qe,G.promise):Be.call(G.promise,Qe)},this._next(),G.promise}else{if(typeof E=="function")return this.exec("run",[String(E),R],T);throw new TypeError('Function or string expected as argument "method"')}},S.prototype.proxy=function(){if(arguments.length>0)throw new Error("No arguments expected");var E=this;return this.exec("methods").then(function(R){var T={};return R.forEach(function(G){T[G]=function(){return E.exec(G,Array.prototype.slice.call(arguments))}}),T})},S.prototype._next=function(){if(this.tasks.length>0){var E=this._getWorker();if(E){var R=this,T=this.tasks.shift();if(T.resolver.promise.pending){var G=E.exec(T.method,T.params,T.resolver,T.options).then(R._boundNext).catch(function(){if(E.terminated)return R._removeWorker(E)}).then(function(){R._next()});typeof T.timeout=="number"&&G.timeout(T.timeout)}else R._next()}}},S.prototype._getWorker=function(){for(var E=this.workers,R=0;R<E.length;R++){var T=E[R];if(T.busy()===!1)return T}return E.length<this.maxWorkers?(T=this._createWorkerHandler(),E.push(T),T):null},S.prototype._removeWorker=function(E){var R=this;return ve.releasePort(E.debugPort),this._removeWorkerFromList(E),this._ensureMinWorkers(),new F(function(T,G){E.terminate(!1,function(re){R.onTerminateWorker({forkArgs:E.forkArgs,forkOpts:E.forkOpts,workerThreadOpts:E.workerThreadOpts,script:E.script}),re?G(re):T(E)})})},S.prototype._removeWorkerFromList=function(E){var R=this.workers.indexOf(E);R!==-1&&this.workers.splice(R,1)},S.prototype.terminate=function(E,R){var T=this;this.tasks.forEach(function(Ye){Ye.resolver.reject(new Error("Pool terminated"))}),this.tasks.length=0;var G=function(Qe){ve.releasePort(Qe.debugPort),this._removeWorkerFromList(Qe)},re=G.bind(this),fe=[],Be=this.workers.slice();return Be.forEach(function(Ye){var Qe=Ye.terminateAndNotify(E,R).then(re).always(function(){T.onTerminateWorker({forkArgs:Ye.forkArgs,forkOpts:Ye.forkOpts,workerThreadOpts:Ye.workerThreadOpts,script:Ye.script})});fe.push(Qe)}),F.all(fe)},S.prototype.stats=function(){var E=this.workers.length,R=this.workers.filter(function(T){return T.busy()}).length;return{totalWorkers:E,busyWorkers:R,idleWorkers:E-R,pendingTasks:this.tasks.length,activeTasks:R}},S.prototype._ensureMinWorkers=function(){if(this.minWorkers)for(var E=this.workers.length;E<this.minWorkers;E++)this.workers.push(this._createWorkerHandler())},S.prototype._createWorkerHandler=function(){var E=this.onCreateWorker({forkArgs:this.forkArgs,forkOpts:this.forkOpts,workerOpts:this.workerOpts,workerThreadOpts:this.workerThreadOpts,script:this.script})||{};return new D(E.script||this.script,{forkArgs:E.forkArgs||this.forkArgs,forkOpts:E.forkOpts||this.forkOpts,workerOpts:E.workerOpts||this.workerOpts,workerThreadOpts:E.workerThreadOpts||this.workerThreadOpts,debugPort:ve.nextAvailableStartingAt(this.debugPortStart),workerType:this.workerType,workerTerminateTimeout:this.workerTerminateTimeout,emitStdStreams:this.emitStdStreams})};function be(E){if(!Fe(E)||!Le(E)||E<1)throw new TypeError("Option maxWorkers must be an integer number >= 1")}function he(E){if(!Fe(E)||!Le(E)||E<0)throw new TypeError("Option minWorkers must be an integer number >= 0")}function Fe(E){return typeof E=="number"}function Le(E){return Math.round(E)==E}return C=S,C}var z={},Y,V;function P(){if(V)return Y;V=1;function O(F,D){this.message=F,this.transfer=D}return Y=O,Y}var I;function U(){return I||(I=1,function(O){var F=P(),D=c().Promise,oe="__workerpool-terminate__",Q="__workerpool-cleanup__",ve=1e3,S={exit:function(){}},be={addAbortListener:function(G){S.abortListeners.push(G)},emit:S.emit};if(typeof self<"u"&&typeof postMessage=="function"&&typeof addEventListener=="function")S.on=function(T,G){addEventListener(T,function(re){G(re.data)})},S.send=function(T,G){G?postMessage(T,G):postMessage(T)};else if(typeof process<"u"){var he;try{he=gt}catch(T){if(!(g(T)==="object"&&T!==null&&T.code==="MODULE_NOT_FOUND"))throw T}if(he&&he.parentPort!==null){var Fe=he.parentPort;S.send=Fe.postMessage.bind(Fe),S.on=Fe.on.bind(Fe),S.exit=process.exit.bind(process)}else S.on=process.on.bind(process),S.send=function(T){process.send(T)},S.on("disconnect",function(){process.exit(1)}),S.exit=process.exit.bind(process)}else throw new Error("Script must be executed as a worker");function Le(T){return Object.getOwnPropertyNames(T).reduce(function(G,re){return Object.defineProperty(G,re,{value:T[re],enumerable:!0})},{})}function E(T){return T&&typeof T.then=="function"&&typeof T.catch=="function"}S.methods={},S.methods.run=function(G,re){var fe=new Function("return ("+G+").apply(this, arguments);");return fe.worker=be,fe.apply(fe,re)},S.methods.methods=function(){return Object.keys(S.methods)},S.terminationHandler=void 0,S.abortListenerTimeout=ve,S.abortListeners=[],S.terminateAndExit=function(T){var G=function(){S.exit(T)};if(!S.terminationHandler)return G();var re=S.terminationHandler(T);return E(re)?(re.then(G,G),re):(G(),new D(function(fe,Be){Be(new Error("Worker terminating"))}))},S.cleanup=function(T){if(!S.abortListeners.length)return S.send({id:T,method:Q,error:Le(new Error("Worker terminating"))}),new D(function(Je){Je()});var G=function(){S.exit()},re=function(){S.abortListeners.length||(S.abortListeners=[])},fe=S.abortListeners.map(function(Je){return Je()}),Be,Ye=new D(function(Je,ht){Be=setTimeout(function(){ht(new Error("Timeout occured waiting for abort handler, killing worker"))},S.abortListenerTimeout)}),Qe=D.all(fe).then(function(){clearTimeout(Be),re()},function(){clearTimeout(Be),G()});return D.all([Qe,Ye]).then(function(){S.send({id:T,method:Q,error:null})},function(Je){S.send({id:T,method:Q,error:Je?Le(Je):null})})};var R=null;S.on("message",function(T){if(T===oe)return S.terminateAndExit(0);if(T.method===Q)return S.cleanup(T.id);try{var G=S.methods[T.method];if(G){R=T.id;var re=G.apply(G,T.params);E(re)?re.then(function(fe){fe instanceof F?S.send({id:T.id,result:fe.message,error:null},fe.transfer):S.send({id:T.id,result:fe,error:null}),R=null}).catch(function(fe){S.send({id:T.id,result:null,error:Le(fe)}),R=null}):(re instanceof F?S.send({id:T.id,result:re.message,error:null},re.transfer):S.send({id:T.id,result:re,error:null}),R=null)}else throw new Error('Unknown method "'+T.method+'"')}catch(fe){S.send({id:T.id,result:null,error:Le(fe)})}}),S.register=function(T,G){if(T)for(var re in T)T.hasOwnProperty(re)&&(S.methods[re]=T[re],S.methods[re].worker=be);G&&(S.terminationHandler=G.onTerminate,S.abortListenerTimeout=G.abortListenerTimeout||ve),S.send("ready")},S.emit=function(T){if(R){if(T instanceof F){S.send({id:R,isEvent:!0,payload:T.message},T.transfer);return}S.send({id:R,isEvent:!0,payload:T})}},O.add=S.register,O.emit=S.emit}(z)),z}var q=n.platform,ue=n.isMainThread,se=n.cpus;function xe(O,F){var D=ee();return new D(O,F)}var ke=i.pool=xe;function We(O,F){var D=U();D.add(O,F)}var Xe=i.worker=We;function Ze(O){var F=U();F.emit(O)}var Te=i.workerEmit=Ze,Ge=c(),Ne=Ge.Promise,st=i.Promise=Ne,Tt=i.Transfer=P(),Ot=i.platform=q,ct=i.isMainThread=ue,Wt=i.cpus=se;t.Promise=st,t.Transfer=Tt,t.cpus=Wt,t.default=i,t.isMainThread=ct,t.platform=Ot,t.pool=ke,t.worker=Xe,t.workerEmit=Te,Object.defineProperty(t,"__esModule",{value:!0})})}(jt,jt.exports)),jt.exports}var rn=tn();const $e=Object.freeze({Euclidean:"Euclidean",EuclideanSq:"EuclideanSq",Manhattan:"Manhattan",Hybrid:"Hybrid"}),Re=Object.freeze({CellValue:"CellValue",Distance:"Distance",Distance2:"Distance2",Distance2Add:"Distance2Add",Distance2Sub:"Distance2Sub",Distance2Mul:"Distance2Mul",Distance2Div:"Distance2Div"}),ze=Object.freeze({OpenSimplex2:"OpenSimplex2",OpenSimplex2Reduced:"OpenSimplex2Reduced",BasicGrid:"BasicGrid"}),tt=Object.freeze({None:"None",FBm:"FBm",Ridged:"Ridged",PingPong:"PingPong",DomainWarpProgressive:"DomainWarpProgressive",DomainWarpIndependent:"DomainWarpIndependent"}),ot=[.130526192220052,.99144486137381,.38268343236509,.923879532511287,.608761429008721,.793353340291235,.793353340291235,.608761429008721,.923879532511287,.38268343236509,.99144486137381,.130526192220051,.99144486137381,-.130526192220051,.923879532511287,-.38268343236509,.793353340291235,-.60876142900872,.608761429008721,-.793353340291235,.38268343236509,-.923879532511287,.130526192220052,-.99144486137381,-.130526192220052,-.99144486137381,-.38268343236509,-.923879532511287,-.608761429008721,-.793353340291235,-.793353340291235,-.608761429008721,-.923879532511287,-.38268343236509,-.99144486137381,-.130526192220052,-.99144486137381,.130526192220051,-.923879532511287,.38268343236509,-.793353340291235,.608761429008721,-.608761429008721,.793353340291235,-.38268343236509,.923879532511287,-.130526192220052,.99144486137381,.130526192220052,.99144486137381,.38268343236509,.923879532511287,.608761429008721,.793353340291235,.793353340291235,.608761429008721,.923879532511287,.38268343236509,.99144486137381,.130526192220051,.99144486137381,-.130526192220051,.923879532511287,-.38268343236509,.793353340291235,-.60876142900872,.608761429008721,-.793353340291235,.38268343236509,-.923879532511287,.130526192220052,-.99144486137381,-.130526192220052,-.99144486137381,-.38268343236509,-.923879532511287,-.608761429008721,-.793353340291235,-.793353340291235,-.608761429008721,-.923879532511287,-.38268343236509,-.99144486137381,-.130526192220052,-.99144486137381,.130526192220051,-.923879532511287,.38268343236509,-.793353340291235,.608761429008721,-.608761429008721,.793353340291235,-.38268343236509,.923879532511287,-.130526192220052,.99144486137381,.130526192220052,.99144486137381,.38268343236509,.923879532511287,.608761429008721,.793353340291235,.793353340291235,.608761429008721,.923879532511287,.38268343236509,.99144486137381,.130526192220051,.99144486137381,-.130526192220051,.923879532511287,-.38268343236509,.793353340291235,-.60876142900872,.608761429008721,-.793353340291235,.38268343236509,-.923879532511287,.130526192220052,-.99144486137381,-.130526192220052,-.99144486137381,-.38268343236509,-.923879532511287,-.608761429008721,-.793353340291235,-.793353340291235,-.608761429008721,-.923879532511287,-.38268343236509,-.99144486137381,-.130526192220052,-.99144486137381,.130526192220051,-.923879532511287,.38268343236509,-.793353340291235,.608761429008721,-.608761429008721,.793353340291235,-.38268343236509,.923879532511287,-.130526192220052,.99144486137381,.130526192220052,.99144486137381,.38268343236509,.923879532511287,.608761429008721,.793353340291235,.793353340291235,.608761429008721,.923879532511287,.38268343236509,.99144486137381,.130526192220051,.99144486137381,-.130526192220051,.923879532511287,-.38268343236509,.793353340291235,-.60876142900872,.608761429008721,-.793353340291235,.38268343236509,-.923879532511287,.130526192220052,-.99144486137381,-.130526192220052,-.99144486137381,-.38268343236509,-.923879532511287,-.608761429008721,-.793353340291235,-.793353340291235,-.608761429008721,-.923879532511287,-.38268343236509,-.99144486137381,-.130526192220052,-.99144486137381,.130526192220051,-.923879532511287,.38268343236509,-.793353340291235,.608761429008721,-.608761429008721,.793353340291235,-.38268343236509,.923879532511287,-.130526192220052,.99144486137381,.130526192220052,.99144486137381,.38268343236509,.923879532511287,.608761429008721,.793353340291235,.793353340291235,.608761429008721,.923879532511287,.38268343236509,.99144486137381,.130526192220051,.99144486137381,-.130526192220051,.923879532511287,-.38268343236509,.793353340291235,-.60876142900872,.608761429008721,-.793353340291235,.38268343236509,-.923879532511287,.130526192220052,-.99144486137381,-.130526192220052,-.99144486137381,-.38268343236509,-.923879532511287,-.608761429008721,-.793353340291235,-.793353340291235,-.608761429008721,-.923879532511287,-.38268343236509,-.99144486137381,-.130526192220052,-.99144486137381,.130526192220051,-.923879532511287,.38268343236509,-.793353340291235,.608761429008721,-.608761429008721,.793353340291235,-.38268343236509,.923879532511287,-.130526192220052,.99144486137381,.38268343236509,.923879532511287,.923879532511287,.38268343236509,.923879532511287,-.38268343236509,.38268343236509,-.923879532511287,-.38268343236509,-.923879532511287,-.923879532511287,-.38268343236509,-.923879532511287,.38268343236509,-.38268343236509,.923879532511287],ut=[0,1,1,0,0,-1,1,0,0,1,-1,0,0,-1,-1,0,1,0,1,0,-1,0,1,0,1,0,-1,0,-1,0,-1,0,1,1,0,0,-1,1,0,0,1,-1,0,0,-1,-1,0,0,0,1,1,0,0,-1,1,0,0,1,-1,0,0,-1,-1,0,1,0,1,0,-1,0,1,0,1,0,-1,0,-1,0,-1,0,1,1,0,0,-1,1,0,0,1,-1,0,0,-1,-1,0,0,0,1,1,0,0,-1,1,0,0,1,-1,0,0,-1,-1,0,1,0,1,0,-1,0,1,0,1,0,-1,0,-1,0,-1,0,1,1,0,0,-1,1,0,0,1,-1,0,0,-1,-1,0,0,0,1,1,0,0,-1,1,0,0,1,-1,0,0,-1,-1,0,1,0,1,0,-1,0,1,0,1,0,-1,0,-1,0,-1,0,1,1,0,0,-1,1,0,0,1,-1,0,0,-1,-1,0,0,0,1,1,0,0,-1,1,0,0,1,-1,0,0,-1,-1,0,1,0,1,0,-1,0,1,0,1,0,-1,0,-1,0,-1,0,1,1,0,0,-1,1,0,0,1,-1,0,0,-1,-1,0,0,1,1,0,0,0,-1,1,0,-1,1,0,0,0,-1,-1,0],De=Object.freeze({OpenSimplex2:"OpenSimplex2",OpenSimplex2S:"OpenSimplex2S",Cellular:"Cellular",Perlin:"Perlin",ValueCubic:"ValueCubic",Value:"Value"}),N=501125321,L=1136930381,le=1720413743,de=[-.2700222198,-.9628540911,.3863092627,-.9223693152,.04444859006,-.999011673,-.5992523158,-.8005602176,-.7819280288,.6233687174,.9464672271,.3227999196,-.6514146797,-.7587218957,.9378472289,.347048376,-.8497875957,-.5271252623,-.879042592,.4767432447,-.892300288,-.4514423508,-.379844434,-.9250503802,-.9951650832,.0982163789,.7724397808,-.6350880136,.7573283322,-.6530343002,-.9928004525,-.119780055,-.0532665713,.9985803285,.9754253726,-.2203300762,-.7665018163,.6422421394,.991636706,.1290606184,-.994696838,.1028503788,-.5379205513,-.84299554,.5022815471,-.8647041387,.4559821461,-.8899889226,-.8659131224,-.5001944266,.0879458407,-.9961252577,-.5051684983,.8630207346,.7753185226,-.6315704146,-.6921944612,.7217110418,-.5191659449,-.8546734591,.8978622882,-.4402764035,-.1706774107,.9853269617,-.9353430106,-.3537420705,-.9992404798,.03896746794,-.2882064021,-.9575683108,-.9663811329,.2571137995,-.8759714238,-.4823630009,-.8303123018,-.5572983775,.05110133755,-.9986934731,-.8558373281,-.5172450752,.09887025282,.9951003332,.9189016087,.3944867976,-.2439375892,-.9697909324,-.8121409387,-.5834613061,-.9910431363,.1335421355,.8492423985,-.5280031709,-.9717838994,-.2358729591,.9949457207,.1004142068,.6241065508,-.7813392434,.662910307,.7486988212,-.7197418176,.6942418282,-.8143370775,-.5803922158,.104521054,-.9945226741,-.1065926113,-.9943027784,.445799684,-.8951327509,.105547406,.9944142724,-.992790267,.1198644477,-.8334366408,.552615025,.9115561563,-.4111755999,.8285544909,-.5599084351,.7217097654,-.6921957921,.4940492677,-.8694339084,-.3652321272,-.9309164803,-.9696606758,.2444548501,.08925509731,-.996008799,.5354071276,-.8445941083,-.1053576186,.9944343981,-.9890284586,.1477251101,.004856104961,.9999882091,.9885598478,.1508291331,.9286129562,-.3710498316,-.5832393863,-.8123003252,.3015207509,.9534596146,-.9575110528,.2883965738,.9715802154,-.2367105511,.229981792,.9731949318,.955763816,-.2941352207,.740956116,.6715534485,-.9971513787,-.07542630764,.6905710663,-.7232645452,-.290713703,-.9568100872,.5912777791,-.8064679708,-.9454592212,-.325740481,.6664455681,.74555369,.6236134912,.7817328275,.9126993851,-.4086316587,-.8191762011,.5735419353,-.8812745759,-.4726046147,.9953313627,.09651672651,.9855650846,-.1692969699,-.8495980887,.5274306472,.6174853946,-.7865823463,.8508156371,.52546432,.9985032451,-.05469249926,.1971371563,-.9803759185,.6607855748,-.7505747292,-.03097494063,.9995201614,-.6731660801,.739491331,-.7195018362,-.6944905383,.9727511689,.2318515979,.9997059088,-.0242506907,.4421787429,-.8969269532,.9981350961,-.061043673,-.9173660799,-.3980445648,-.8150056635,-.5794529907,-.8789331304,.4769450202,.0158605829,.999874213,-.8095464474,.5870558317,-.9165898907,-.3998286786,-.8023542565,.5968480938,-.5176737917,.8555780767,-.8154407307,-.5788405779,.4022010347,-.9155513791,-.9052556868,-.4248672045,.7317445619,.6815789728,-.5647632201,-.8252529947,-.8403276335,-.5420788397,-.9314281527,.363925262,.5238198472,.8518290719,.7432803869,-.6689800195,-.985371561,-.1704197369,.4601468731,.88784281,.825855404,.5638819483,.6182366099,.7859920446,.8331502863,-.553046653,.1500307506,.9886813308,-.662330369,-.7492119075,-.668598664,.743623444,.7025606278,.7116238924,-.5419389763,-.8404178401,-.3388616456,.9408362159,.8331530315,.5530425174,-.2989720662,-.9542618632,.2638522993,.9645630949,.124108739,-.9922686234,-.7282649308,-.6852956957,.6962500149,.7177993569,-.9183535368,.3957610156,-.6326102274,-.7744703352,-.9331891859,-.359385508,-.1153779357,-.9933216659,.9514974788,-.3076565421,-.08987977445,-.9959526224,.6678496916,.7442961705,.7952400393,-.6062947138,-.6462007402,-.7631674805,-.2733598753,.9619118351,.9669590226,-.254931851,-.9792894595,.2024651934,-.5369502995,-.8436138784,-.270036471,-.9628500944,-.6400277131,.7683518247,-.7854537493,-.6189203566,.06005905383,-.9981948257,-.02455770378,.9996984141,-.65983623,.751409442,-.6253894466,-.7803127835,-.6210408851,-.7837781695,.8348888491,.5504185768,-.1592275245,.9872419133,.8367622488,.5475663786,-.8675753916,-.4973056806,-.2022662628,-.9793305667,.9399189937,.3413975472,.9877404807,-.1561049093,-.9034455656,.4287028224,.1269804218,-.9919052235,-.3819600854,.924178821,.9754625894,.2201652486,-.3204015856,-.9472818081,-.9874760884,.1577687387,.02535348474,-.9996785487,.4835130794,-.8753371362,-.2850799925,-.9585037287,-.06805516006,-.99768156,-.7885244045,-.6150034663,.3185392127,-.9479096845,.8880043089,.4598351306,.6476921488,-.7619021462,.9820241299,.1887554194,.9357275128,-.3527237187,-.8894895414,.4569555293,.7922791302,.6101588153,.7483818261,.6632681526,-.7288929755,-.6846276581,.8729032783,-.4878932944,.8288345784,.5594937369,.08074567077,.9967347374,.9799148216,-.1994165048,-.580730673,-.8140957471,-.4700049791,-.8826637636,.2409492979,.9705377045,.9437816757,-.3305694308,-.8927998638,-.4504535528,-.8069622304,.5906030467,.06258973166,.9980393407,-.9312597469,.3643559849,.5777449785,.8162173362,-.3360095855,-.941858566,.697932075,-.7161639607,-.002008157227,-.9999979837,-.1827294312,-.9831632392,-.6523911722,.7578824173,-.4302626911,-.9027037258,-.9985126289,-.05452091251,-.01028102172,-.9999471489,-.4946071129,.8691166802,-.2999350194,.9539596344,.8165471961,.5772786819,.2697460475,.962931498,-.7306287391,-.6827749597,-.7590952064,-.6509796216,-.907053853,.4210146171,-.5104861064,-.8598860013,.8613350597,.5080373165,.5007881595,-.8655698812,-.654158152,.7563577938,-.8382755311,-.545246856,.6940070834,.7199681717,.06950936031,.9975812994,.1702942185,-.9853932612,.2695973274,.9629731466,.5519612192,-.8338697815,.225657487,-.9742067022,.4215262855,-.9068161835,.4881873305,-.8727388672,-.3683854996,-.9296731273,-.9825390578,.1860564427,.81256471,.5828709909,.3196460933,-.9475370046,.9570913859,.2897862643,-.6876655497,-.7260276109,-.9988770922,-.047376731,-.1250179027,.992154486,-.8280133617,.560708367,.9324863769,-.3612051451,.6394653183,.7688199442,-.01623847064,-.9998681473,-.9955014666,-.09474613458,-.81453315,.580117012,.4037327978,-.9148769469,.9944263371,.1054336766,-.1624711654,.9867132919,-.9949487814,-.100383875,-.6995302564,.7146029809,.5263414922,-.85027327,-.5395221479,.841971408,.6579370318,.7530729462,.01426758847,-.9998982128,-.6734383991,.7392433447,.639412098,-.7688642071,.9211571421,.3891908523,-.146637214,-.9891903394,-.782318098,.6228791163,-.5039610839,-.8637263605,-.7743120191,-.6328039957],te=[-.7292736885,-.6618439697,.1735581948,0,.790292081,-.5480887466,-.2739291014,0,.7217578935,.6226212466,-.3023380997,0,.565683137,-.8208298145,-.0790000257,0,.760049034,-.5555979497,-.3370999617,0,.3713945616,.5011264475,.7816254623,0,-.1277062463,-.4254438999,-.8959289049,0,-.2881560924,-.5815838982,.7607405838,0,.5849561111,-.662820239,-.4674352136,0,.3307171178,.0391653737,.94291689,0,.8712121778,-.4113374369,-.2679381538,0,.580981015,.7021915846,.4115677815,0,.503756873,.6330056931,-.5878203852,0,.4493712205,.601390195,.6606022552,0,-.6878403724,.09018890807,-.7202371714,0,-.5958956522,-.6469350577,.475797649,0,-.5127052122,.1946921978,-.8361987284,0,-.9911507142,-.05410276466,-.1212153153,0,-.2149721042,.9720882117,-.09397607749,0,-.7518650936,-.5428057603,.3742469607,0,.5237068895,.8516377189,-.02107817834,0,.6333504779,.1926167129,-.7495104896,0,-.06788241606,.3998305789,.9140719259,0,-.5538628599,-.4729896695,-.6852128902,0,-.7261455366,-.5911990757,.3509933228,0,-.9229274737,-.1782808786,.3412049336,0,-.6968815002,.6511274338,.3006480328,0,.9608044783,-.2098363234,-.1811724921,0,.06817146062,-.9743405129,.2145069156,0,-.3577285196,-.6697087264,-.6507845481,0,-.1868621131,.7648617052,-.6164974636,0,-.6541697588,.3967914832,.6439087246,0,.6993340405,-.6164538506,.3618239211,0,-.1546665739,.6291283928,.7617583057,0,-.6841612949,-.2580482182,-.6821542638,0,.5383980957,.4258654885,.7271630328,0,-.5026987823,-.7939832935,-.3418836993,0,.3202971715,.2834415347,.9039195862,0,.8683227101,-.0003762656404,-.4959995258,0,.791120031,-.08511045745,.6057105799,0,-.04011016052,-.4397248749,.8972364289,0,.9145119872,.3579346169,-.1885487608,0,-.9612039066,-.2756484276,.01024666929,0,.6510361721,-.2877799159,-.7023778346,0,-.2041786351,.7365237271,.644859585,0,-.7718263711,.3790626912,.5104855816,0,-.3060082741,-.7692987727,.5608371729,0,.454007341,-.5024843065,.7357899537,0,.4816795475,.6021208291,-.6367380315,0,.6961980369,-.3222197429,.641469197,0,-.6532160499,-.6781148932,.3368515753,0,.5089301236,-.6154662304,-.6018234363,0,-.1635919754,-.9133604627,-.372840892,0,.52408019,-.8437664109,.1157505864,0,.5902587356,.4983817807,-.6349883666,0,.5863227872,.494764745,.6414307729,0,.6779335087,.2341345225,.6968408593,0,.7177054546,-.6858979348,.120178631,0,-.5328819713,-.5205125012,.6671608058,0,-.8654874251,-.0700727088,-.4960053754,0,-.2861810166,.7952089234,.5345495242,0,-.04849529634,.9810836427,-.1874115585,0,-.6358521667,.6058348682,.4781800233,0,.6254794696,-.2861619734,.7258696564,0,-.2585259868,.5061949264,-.8227581726,0,.02136306781,.5064016808,-.8620330371,0,.200111773,.8599263484,.4695550591,0,.4743561372,.6014985084,-.6427953014,0,.6622993731,-.5202474575,-.5391679918,0,.08084972818,-.6532720452,.7527940996,0,-.6893687501,.0592860349,.7219805347,0,-.1121887082,-.9673185067,.2273952515,0,.7344116094,.5979668656,-.3210532909,0,.5789393465,-.2488849713,.7764570201,0,.6988182827,.3557169806,-.6205791146,0,-.8636845529,-.2748771249,-.4224826141,0,-.4247027957,-.4640880967,.777335046,0,.5257722489,-.8427017621,.1158329937,0,.9343830603,.316302472,-.1639543925,0,-.1016836419,-.8057303073,-.5834887393,0,-.6529238969,.50602126,-.5635892736,0,-.2465286165,-.9668205684,-.06694497494,0,-.9776897119,-.2099250524,-.007368825344,0,.7736893337,.5734244712,.2694238123,0,-.6095087895,.4995678998,.6155736747,0,.5794535482,.7434546771,.3339292269,0,-.8226211154,.08142581855,.5627293636,0,-.510385483,.4703667658,.7199039967,0,-.5764971849,-.07231656274,-.8138926898,0,.7250628871,.3949971505,-.5641463116,0,-.1525424005,.4860840828,-.8604958341,0,-.5550976208,-.4957820792,.667882296,0,-.1883614327,.9145869398,.357841725,0,.7625556724,-.5414408243,-.3540489801,0,-.5870231946,-.3226498013,-.7424963803,0,.3051124198,.2262544068,-.9250488391,0,.6379576059,.577242424,-.5097070502,0,-.5966775796,.1454852398,-.7891830656,0,-.658330573,.6555487542,-.3699414651,0,.7434892426,.2351084581,.6260573129,0,.5562114096,.8264360377,-.0873632843,0,-.3028940016,-.8251527185,.4768419182,0,.1129343818,-.985888439,-.1235710781,0,.5937652891,-.5896813806,.5474656618,0,.6757964092,-.5835758614,-.4502648413,0,.7242302609,-.1152719764,.6798550586,0,-.9511914166,.0753623979,-.2992580792,0,.2539470961,-.1886339355,.9486454084,0,.571433621,-.1679450851,-.8032795685,0,-.06778234979,.3978269256,.9149531629,0,.6074972649,.733060024,-.3058922593,0,-.5435478392,.1675822484,.8224791405,0,-.5876678086,-.3380045064,-.7351186982,0,-.7967562402,.04097822706,-.6029098428,0,-.1996350917,.8706294745,.4496111079,0,-.02787660336,-.9106232682,-.4122962022,0,-.7797625996,-.6257634692,.01975775581,0,-.5211232846,.7401644346,-.4249554471,0,.8575424857,.4053272873,-.3167501783,0,.1045223322,.8390195772,-.5339674439,0,.3501822831,.9242524096,-.1520850155,0,.1987849858,.07647613266,.9770547224,0,.7845996363,.6066256811,-.1280964233,0,.09006737436,-.9750989929,-.2026569073,0,-.8274343547,-.542299559,.1458203587,0,-.3485797732,-.415802277,.840000362,0,-.2471778936,-.7304819962,-.6366310879,0,-.3700154943,.8577948156,.3567584454,0,.5913394901,-.548311967,-.5913303597,0,.1204873514,-.7626472379,-.6354935001,0,.616959265,.03079647928,.7863922953,0,.1258156836,-.6640829889,-.7369967419,0,-.6477565124,-.1740147258,-.7417077429,0,.6217889313,-.7804430448,-.06547655076,0,.6589943422,-.6096987708,.4404473475,0,-.2689837504,-.6732403169,-.6887635427,0,-.3849775103,.5676542638,.7277093879,0,.5754444408,.8110471154,-.1051963504,0,.9141593684,.3832947817,.131900567,0,-.107925319,.9245493968,.3654593525,0,.377977089,.3043148782,.8743716458,0,-.2142885215,-.8259286236,.5214617324,0,.5802544474,.4148098596,-.7008834116,0,-.1982660881,.8567161266,-.4761596756,0,-.03381553704,.3773180787,-.9254661404,0,-.6867922841,-.6656597827,.2919133642,0,.7731742607,-.2875793547,-.5652430251,0,-.09655941928,.9193708367,-.3813575004,0,.2715702457,-.9577909544,-.09426605581,0,.2451015704,-.6917998565,-.6792188003,0,.977700782,-.1753855374,.1155036542,0,-.5224739938,.8521606816,.02903615945,0,-.7734880599,-.5261292347,.3534179531,0,-.7134492443,-.269547243,.6467878011,0,.1644037271,.5105846203,-.8439637196,0,.6494635788,.05585611296,.7583384168,0,-.4711970882,.5017280509,-.7254255765,0,-.6335764307,-.2381686273,-.7361091029,0,-.9021533097,-.270947803,-.3357181763,0,-.3793711033,.872258117,.3086152025,0,-.6855598966,-.3250143309,.6514394162,0,.2900942212,-.7799057743,-.5546100667,0,-.2098319339,.85037073,.4825351604,0,-.4592603758,.6598504336,-.5947077538,0,.8715945488,.09616365406,-.4807031248,0,-.6776666319,.7118504878,-.1844907016,0,.7044377633,.312427597,.637304036,0,-.7052318886,-.2401093292,-.6670798253,0,.081921007,-.7207336136,-.6883545647,0,-.6993680906,-.5875763221,-.4069869034,0,-.1281454481,.6419895885,.7559286424,0,-.6337388239,-.6785471501,-.3714146849,0,.5565051903,-.2168887573,-.8020356851,0,-.5791554484,.7244372011,-.3738578718,0,.1175779076,-.7096451073,.6946792478,0,-.6134619607,.1323631078,.7785527795,0,.6984635305,-.02980516237,-.715024719,0,.8318082963,-.3930171956,.3919597455,0,.1469576422,.05541651717,-.9875892167,0,.708868575,-.2690503865,.6520101478,0,.2726053183,.67369766,-.68688995,0,-.6591295371,.3035458599,-.6880466294,0,.4815131379,-.7528270071,.4487723203,0,.9430009463,.1675647412,-.2875261255,0,.434802957,.7695304522,-.4677277752,0,.3931996188,.594473625,.7014236729,0,.7254336655,-.603925654,.3301814672,0,.7590235227,-.6506083235,.02433313207,0,-.8552768592,-.3430042733,.3883935666,0,-.6139746835,.6981725247,.3682257648,0,-.7465905486,-.5752009504,.3342849376,0,.5730065677,.810555537,-.1210916791,0,-.9225877367,-.3475211012,-.167514036,0,-.7105816789,-.4719692027,-.5218416899,0,-.08564609717,.3583001386,.929669703,0,-.8279697606,-.2043157126,.5222271202,0,.427944023,.278165994,.8599346446,0,.5399079671,-.7857120652,-.3019204161,0,.5678404253,-.5495413974,-.6128307303,0,-.9896071041,.1365639107,-.04503418428,0,-.6154342638,-.6440875597,.4543037336,0,.1074204368,-.7946340692,.5975094525,0,-.3595449969,-.8885529948,.28495784,0,-.2180405296,.1529888965,.9638738118,0,-.7277432317,-.6164050508,-.3007234646,0,.7249729114,-.00669719484,.6887448187,0,-.5553659455,-.5336586252,.6377908264,0,.5137558015,.7976208196,-.3160000073,0,-.3794024848,.9245608561,-.03522751494,0,.8229248658,.2745365933,-.4974176556,0,-.5404114394,.6091141441,.5804613989,0,.8036581901,-.2703029469,.5301601931,0,.6044318879,.6832968393,.4095943388,0,.06389988817,.9658208605,-.2512108074,0,.1087113286,.7402471173,-.6634877936,0,-.713427712,-.6926784018,.1059128479,0,.6458897819,-.5724548511,-.5050958653,0,-.6553931414,.7381471625,.159995615,0,.3910961323,.9188871375,-.05186755998,0,-.4879022471,-.5904376907,.6429111375,0,.6014790094,.7707441366,-.2101820095,0,-.5677173047,.7511360995,.3368851762,0,.7858573506,.226674665,.5753666838,0,-.4520345543,-.604222686,-.6561857263,0,.002272116345,.4132844051,-.9105991643,0,-.5815751419,-.5162925989,.6286591339,0,-.03703704785,.8273785755,.5604221175,0,-.5119692504,.7953543429,-.3244980058,0,-.2682417366,-.9572290247,-.1084387619,0,-.2322482736,-.9679131102,-.09594243324,0,.3554328906,-.8881505545,.2913006227,0,.7346520519,-.4371373164,.5188422971,0,.9985120116,.04659011161,-.02833944577,0,-.3727687496,-.9082481361,.1900757285,0,.91737377,-.3483642108,.1925298489,0,.2714911074,.4147529736,-.8684886582,0,.5131763485,-.7116334161,.4798207128,0,-.8737353606,.18886992,-.4482350644,0,.8460043821,-.3725217914,.3814499973,0,.8978727456,-.1780209141,-.4026575304,0,.2178065647,-.9698322841,-.1094789531,0,-.1518031304,-.7788918132,-.6085091231,0,-.2600384876,-.4755398075,-.8403819825,0,.572313509,-.7474340931,-.3373418503,0,-.7174141009,.1699017182,-.6756111411,0,-.684180784,.02145707593,-.7289967412,0,-.2007447902,.06555605789,-.9774476623,0,-.1148803697,-.8044887315,.5827524187,0,-.7870349638,.03447489231,.6159443543,0,-.2015596421,.6859872284,.6991389226,0,-.08581082512,-.10920836,-.9903080513,0,.5532693395,.7325250401,-.396610771,0,-.1842489331,-.9777375055,-.1004076743,0,.0775473789,-.9111505856,.4047110257,0,.1399838409,.7601631212,-.6344734459,0,.4484419361,-.845289248,.2904925424,0],Pt=Object.freeze({None:"None",ImproveXYPlanes:"ImproveXYPlanes",ImproveXZPlanes:"ImproveXZPlanes"}),Se=Object.freeze({None:"None",ImproveXYPlanes:"ImproveXYPlanes",ImproveXZPlanes:"ImproveXZPlanes",DefaultOpenSimplex2:"DefaultOpenSimplex2"});class wt{x;y;constructor(e,t){this.x=e,this.y=t}}class bt{x;y;z;constructor(e,t,i){this.x=e,this.y=t,this.z=i}}const ge=(r,e,t,i,o)=>{const n=i-t-(r-e);return o*o*o*n+o*o*(r-e-n)+o*(t-r)+e},Ae=(r,e,t)=>{let i=r^e^t;return i=Math.imul(i,668265261),i},Ee=(r,e,t,i,o)=>{let n=Ae(r,e,t);n^=n>>15,n&=254;const a=ot[n],s=ot[n|1];return i*a+o*s},je=(r,e,t,i)=>{let o=r^e^t^i;return o=Math.imul(o,668265261),o},we=(r,e,t,i,o,n,a)=>{let s=je(r,e,t,i);s^=s>>15,s&=252;const c=ut[s],p=ut[s|1],f=ut[s|2];return o*c+n*p+a*f},rt=r=>r*r*(3-2*r),It=r=>r*r*r*(r*(r*6-15)+10),B=(r,e,t)=>r+t*(e-r),pr=r=>(r-=Math.trunc(r*.5)*2,r<1?r:2-r),nn=(r,e,t)=>{let i=Math.floor(e),o=Math.floor(t);const n=e-i,a=t-o,s=n-1,c=a-1,p=It(n),f=It(a);i=Math.imul(i,N),o=Math.imul(o,L);const l=i+N,u=o+L,h=B(Ee(r,i,o,n,a),Ee(r,l,o,s,a),p),m=B(Ee(r,i,u,n,c),Ee(r,l,u,s,c),p);return B(h,m,f)*1.4247691104677813},Pe=(r,e,t)=>{let i=Ae(r,e,t);return i=Math.imul(i,i),i^=i<<19,i*(1/2147483648)},j=(r,e,t,i)=>{let o=je(r,e,t,i);return o=Math.imul(o,o),o^=o<<19,o*(1/2147483648)};class Me{_Seed;_Frequency=.01;_NoiseType=De.OpenSimplex2;_RotationType3D=Pt.None;_TransformType3D=Se.DefaultOpenSimplex2;_DomainWarpAmp=1;_FractalType=tt.None;_Octaves=3;_Lacunarity=2;_Gain=.5;_WeightedStrength=0;_PingPongStrength=2;_FractalBounding=1/1.75;_CellularDistanceFunction=$e.EuclideanSq;_CellularReturnType=Re.Distance;_CellularJitterModifier=1;_DomainWarpType=ze.OpenSimplex2;_WarpTransformType3D=Se.DefaultOpenSimplex2;static NoiseType=De;static FractalType=tt;static CellularDistanceFunction=$e;static CellularReturnType=Re;static DomainWarpType=ze;constructor(e){this._Seed=e}SetFrequency(e){this._Frequency=e}SetNoiseType(e){this._NoiseType=e,this._UpdateTransformType3D()}SetRotationType3D(e){this._RotationType3D=e,this._UpdateTransformType3D(),this._UpdateWarpTransformType3D()}SetFractalType(e){this._FractalType=e}SetFractalOctaves(e){this._Octaves=e,this._CalculateFractalBounding()}SetFractalLacunarity(e){this._Lacunarity=e}SetFractalGain(e){this._Gain=e,this._CalculateFractalBounding()}SetFractalWeightedStrength(e){this._WeightedStrength=e}SetFractalPingPongStrength(e){this._PingPongStrength=e}SetCellularDistanceFunction(e){this._CellularDistanceFunction=e}SetCellularReturnType(e){this._CellularReturnType=e}SetCellularJitter(e){this._CellularJitterModifier=e}SetDomainWarpType(e){this._DomainWarpType=e,this._UpdateWarpTransformType3D()}SetDomainWarpAmp(e){this._DomainWarpAmp=e}GetNoise(e,t,i){const o=(a,s)=>{switch(a*=this._Frequency,s*=this._Frequency,this._NoiseType){case De.OpenSimplex2:case De.OpenSimplex2S:{const p=.5*(1.7320508075688772-1),f=(a+s)*p;a+=f,s+=f;break}}switch(this._FractalType){case tt.FBm:return this._GenFractalFBmR2(a,s);case tt.Ridged:return this._GenFractalRidgedR2(a,s);case tt.PingPong:return this._GenFractalPingPongR2(a,s);default:return this._GenNoiseSingleR2(this._Seed,a,s)}},n=(a,s,c)=>{switch(a*=this._Frequency,s*=this._Frequency,c*=this._Frequency,this._TransformType3D){case Se.ImproveXYPlanes:{const p=a+s,f=p*-.211324865405187;c*=.577350269189626,a+=f-c,s+=f-c,c+=p*.577350269189626;break}case Se.ImproveXZPlanes:{const p=a+c,f=p*-.211324865405187;s*=.577350269189626,a+=f-s,c+=f-s,s+=p*.577350269189626;break}case Se.DefaultOpenSimplex2:{const f=(a+s+c)*.6666666666666666;a=f-a,s=f-s,c=f-c;break}}switch(this._FractalType){case tt.FBm:return this._GenFractalFBmR3(a,s,c);case tt.Ridged:return this._GenFractalRidgedR3(a,s,c);case tt.PingPong:return this._GenFractalPingPongR3(a,s,c);default:return this._GenNoiseSingleR3(this._Seed,a,s,c)}};return arguments.length===2?o(e,t):arguments.length===3&&i!==void 0?n(e,t,i):0}DomainWrap(e){switch(this._FractalType){case tt.DomainWarpProgressive:this._DomainWarpFractalProgressive(e);break;case tt.DomainWarpIndependent:this._DomainWarpFractalIndependent(e);break;default:this._DomainWarpSingle(e);break}}_CalculateFractalBounding(){const e=Math.abs(this._Gain);let t=e,i=1;for(let o=1;o<this._Octaves;o++)i+=t,t*=e;this._FractalBounding=1/i}_GenNoiseSingleR2(e,t,i){switch(this._NoiseType){case De.OpenSimplex2:return this._SingleOpenSimplex2R2(e,t,i);case De.OpenSimplex2S:return this._SingleOpenSimplex2SR2(e,t,i);case De.Cellular:return this._SingleCellularR2(e,t,i);case De.Perlin:return nn(e,t,i);case De.ValueCubic:return this._SingleValueCubicR2(e,t,i);case De.Value:return this._SingleValueR2(e,t,i);default:return 0}}_GenNoiseSingleR3(e,t,i,o){switch(this._NoiseType){case De.OpenSimplex2:return this._SingleOpenSimplex2R3(e,t,i,o);case De.OpenSimplex2S:return this._SingleOpenSimplex2SR3(e,t,i,o);case De.Cellular:return this._SingleCellularR3(e,t,i,o);case De.Perlin:return this._SinglePerlinR3(e,t,i,o);case De.ValueCubic:return this._SingleValueCubicR3(e,t,i,o);case De.Value:return this._SingleValueR3(e,t,i,o);default:return 0}}_UpdateTransformType3D(){switch(this._RotationType3D){case Pt.ImproveXYPlanes:this._TransformType3D=Se.ImproveXYPlanes;break;case Pt.ImproveXZPlanes:this._TransformType3D=Se.ImproveXZPlanes;break;default:switch(this._NoiseType){case De.OpenSimplex2:case De.OpenSimplex2S:this._TransformType3D=Se.DefaultOpenSimplex2;break;default:this._TransformType3D=Se.None;break}break}}_UpdateWarpTransformType3D(){switch(this._RotationType3D){case Pt.ImproveXYPlanes:this._WarpTransformType3D=Se.ImproveXYPlanes;break;case Pt.ImproveXZPlanes:this._WarpTransformType3D=Se.ImproveXZPlanes;break;default:switch(this._DomainWarpType){case ze.OpenSimplex2:case ze.OpenSimplex2Reduced:this._WarpTransformType3D=Se.DefaultOpenSimplex2;break;default:this._WarpTransformType3D=Se.None;break}break}}_GenFractalFBmR2(e,t){let i=this._Seed,o=0,n=this._FractalBounding;for(let a=0;a<this._Octaves;a++){const s=this._GenNoiseSingleR2(i++,e,t);o+=s*n,n*=B(1,Math.min(s+1,2)*.5,this._WeightedStrength),e*=this._Lacunarity,t*=this._Lacunarity,n*=this._Gain}return o}_GenFractalFBmR3(e,t,i){let o=this._Seed,n=0,a=this._FractalBounding;for(let s=0;s<this._Octaves;s++){const c=this._GenNoiseSingleR3(o++,e,t,i);n+=c*a,a*=B(1,(c+1)*.5,this._WeightedStrength),e*=this._Lacunarity,t*=this._Lacunarity,i*=this._Lacunarity,a*=this._Gain}return n}_GenFractalRidgedR2(e,t){let i=this._Seed,o=0,n=this._FractalBounding;for(let a=0;a<this._Octaves;a++){const s=Math.abs(this._GenNoiseSingleR2(i++,e,t));o+=(s*-2+1)*n,n*=B(1,1-s,this._WeightedStrength),e*=this._Lacunarity,t*=this._Lacunarity,n*=this._Gain}return o}_GenFractalRidgedR3(e,t,i){let o=this._Seed,n=0,a=this._FractalBounding;for(let s=0;s<this._Octaves;s++){const c=Math.abs(this._GenNoiseSingleR3(o++,e,t,i));n+=(c*-2+1)*a,a*=B(1,1-c,this._WeightedStrength),e*=this._Lacunarity,t*=this._Lacunarity,i*=this._Lacunarity,a*=this._Gain}return n}_GenFractalPingPongR2(e,t){let i=this._Seed,o=0,n=this._FractalBounding;for(let a=0;a<this._Octaves;a++){const s=pr((this._GenNoiseSingleR2(i++,e,t)+1)*this._PingPongStrength);o+=(s-.5)*2*n,n*=B(1,s,this._WeightedStrength),e*=this._Lacunarity,t*=this._Lacunarity,n*=this._Gain}return o}_GenFractalPingPongR3(e,t,i){let o=this._Seed,n=0,a=this._FractalBounding;for(let s=0;s<this._Octaves;s++){const c=pr((this._GenNoiseSingleR3(o++,e,t,i)+1)*this._PingPongStrength);n+=(c-.5)*2*a,a*=B(1,c,this._WeightedStrength),e*=this._Lacunarity,t*=this._Lacunarity,i*=this._Lacunarity,a*=this._Gain}return n}_SingleOpenSimplex2R2(e,t,i){const n=(3-1.7320508075688772)/6;let a=Math.floor(t),s=Math.floor(i);const c=t-a,p=i-s,f=(c+p)*n,l=c-f,u=p-f;a=Math.imul(a,N),s=Math.imul(s,L);let h,m,v;const g=.5-l*l-u*u;g<=0?h=0:h=g*g*(g*g)*Ee(e,a,s,l,u);const x=2*(1-2*n)*(1/n-2)*f+(-2*(1-2*n)*(1-2*n)+g);if(x<=0)v=0;else{const w=l+(2*n-1),d=u+(2*n-1);v=x*x*(x*x)*Ee(e,a+N,s+L,w,d)}if(u>l){const w=l+n,d=u+(n-1),b=.5-w*w-d*d;b<=0?m=0:m=b*b*(b*b)*Ee(e,a,s+L,w,d)}else{const w=l+(n-1),d=u+n,b=.5-w*w-d*d;b<=0?m=0:m=b*b*(b*b)*Ee(e,a+N,s,w,d)}return(h+m+v)*99.83685446303647}_SingleOpenSimplex2R3(e,t,i,o){let n=Math.round(t),a=Math.round(i),s=Math.round(o),c=t-n,p=i-a,f=o-s,l=Math.trunc(-1-p|1),u=Math.trunc(-1-c|1),h=Math.trunc(-1-f|1),m=u*-c,v=l*-p,g=h*-f;n=Math.imul(n,N),a=Math.imul(a,L),s=Math.imul(s,le);let x=0,w=.6-c*c-(p*p+f*f);for(let d=0;;d++){if(w>0&&(x+=w*w*(w*w)*we(e,n,a,s,c,p,f)),m>=v&&m>=g){let b=w+m+m;b>1&&(b-=1,x+=b*b*(b*b)*we(e,n-u*N,a,s,c+u,p,f))}else if(v>m&&v>=g){let b=w+v+v;b>1&&(b-=1,x+=b*b*(b*b)*we(e,n,a-l*L,s,c,p+l,f))}else{let b=w+g+g;b>1&&(b-=1,x+=b*b*(b*b)*we(e,n,a,s-h*le,c,p,f+h))}if(d===1)break;m=.5-m,v=.5-v,g=.5-g,c=u*m,p=l*v,f=h*g,w+=.75-m-(v+g),n+=u>>1&N,a+=l>>1&L,s+=h>>1&le,u=-u,l=-l,h=-h,e=~e}return x*32.69428253173828}_SingleOpenSimplex2SR2(e,t,i){const n=(3-1.7320508075688772)/6;let a=Math.floor(t),s=Math.floor(i);const c=t-a,p=i-s;a=Math.imul(a,N),s=Math.imul(s,L);const f=a+N,l=s+L,u=(c+p)*n,h=c-u,m=p-u,v=2/3-h*h-m*m;let g=v*v*(v*v)*Ee(e,a,s,h,m);const x=2*(1-2*n)*(1/n-2)*u+(-2*(1-2*n)*(1-2*n)+v),w=h-(1-2*n),d=m-(1-2*n);g+=x*x*(x*x)*Ee(e,f,l,w,d);const b=c-p;if(u>n){if(c+b>1){const _=h+(3*n-2),k=m+(3*n-1),y=2/3-_*_-k*k;y>0&&(g+=y*y*(y*y)*Ee(e,a+(N<<1),s+L,_,k))}else{const _=h+n,k=m+(n-1),y=2/3-_*_-k*k;y>0&&(g+=y*y*(y*y)*Ee(e,a,s+L,_,k))}if(p-b>1){const _=h+(3*n-1),k=m+(3*n-2),y=2/3-_*_-k*k;y>0&&(g+=y*y*(y*y)*Ee(e,a+N,s+(L<<1),_,k))}else{const _=h+(n-1),k=m+n,y=2/3-_*_-k*k;y>0&&(g+=y*y*(y*y)*Ee(e,a+N,s,_,k))}}else{if(c+b<0){const _=h+(1-n),k=m-n,y=2/3-_*_-k*k;y>0&&(g+=y*y*(y*y)*Ee(e,a-N,s,_,k))}else{const _=h+(n-1),k=m+n,y=2/3-_*_-k*k;y>0&&(g+=y*y*(y*y)*Ee(e,a+N,s,_,k))}if(p<b){const _=h-n,k=m-(n-1),y=2/3-_*_-k*k;y>0&&(g+=y*y*(y*y)*Ee(e,a,s-L,_,k))}else{const _=h+n,k=m+(n-1),y=2/3-_*_-k*k;y>0&&(g+=y*y*(y*y)*Ee(e,a,s+L,_,k))}}return g*18.24196194486065}_SingleOpenSimplex2SR3(e,t,i,o){let n=Math.floor(t),a=Math.floor(i),s=Math.floor(o);const c=t-n,p=i-a,f=o-s;n=Math.imul(n,N),a=Math.imul(a,L),s=Math.imul(s,le);const l=e+1293373,u=Math.trunc(-.5-c),h=Math.trunc(-.5-p),m=Math.trunc(-.5-f),v=c+u,g=p+h,x=f+m,w=.75-v*v-g*g-x*x;let d=w*w*(w*w)*we(e,n+(u&N),a+(h&L),s+(m&le),v,g,x);const b=c-.5,_=p-.5,k=f-.5,y=.75-b*b-_*_-k*k;d+=y*y*(y*y)*we(l,n+N,a+L,s+le,b,_,k);const A=((u|1)<<1)*b,W=((h|1)<<1)*_,$=((m|1)<<1)*k,X=(-2-(u<<2))*b-1,H=(-2-(h<<2))*_-1,Z=(-2-(m<<2))*k-1;let C=!1;const K=A+w;if(K>0){const P=v-(u|1);d+=K*K*(K*K)*we(e,n+(~u&N),a+(h&L),s+(m&le),P,g,x)}else{const P=W+$+w;if(P>0){const U=v,q=g-(h|1),ue=x-(m|1);d+=P*P*(P*P)*we(e,n+(u&N),a+(~h&L),s+(~m&le),U,q,ue)}const I=X+y;if(I>0){const U=(u|1)+b;d+=I*I*(I*I)*we(l,n+(u&N*2),a+L,s+le,U,_,k),C=!0}}let ee=!1;const z=W+w;if(z>0){const P=v,I=g-(h|1);d+=z*z*(z*z)*we(e,n+(u&N),a+(~h&L),s+(m&le),P,I,x)}else{const P=A+$+w;if(P>0){const U=v-(u|1),q=g,ue=x-(m|1);d+=P*P*(P*P)*we(e,n+(~u&N),a+(h&L),s+(~m&le),U,q,ue)}const I=H+y;if(I>0){const U=b,q=(h|1)+_;d+=I*I*(I*I)*we(l,n+N,a+(h&L<<1),s+le,U,q,k),ee=!0}}let Y=!1;const V=$+w;if(V>0){const P=v,I=g,U=x-(m|1);d+=V*V*(V*V)*we(e,n+(u&N),a+(h&L),s+(~m&le),P,I,U)}else{const P=A+W+w;if(P>0){const U=v-(u|1),q=g-(h|1);d+=P*P*(P*P)*we(e,n+(~u&N),a+(~h&L),s+(m&le),U,q,x)}const I=Z+y;if(I>0){const U=b,q=_,ue=(m|1)+k;d+=I*I*(I*I)*we(l,n+N,a+L,s+(m&le<<1),U,q,ue),Y=!0}}if(!C){const P=H+Z+y;if(P>0){const I=b,U=(h|1)+_,q=(m|1)+k;d+=P*P*(P*P)*we(l,n+N,a+(h&L<<1),s+(m&le<<1),I,U,q)}}if(!ee){const P=X+Z+y;if(P>0){const I=(u|1)+b,U=_,q=(m|1)+k;d+=P*P*(P*P)*we(l,n+(u&N*2),a+L,s+(m&le<<1),I,U,q)}}if(!Y){const P=X+H+y;if(P>0){const I=(u|1)+b,U=(h|1)+_;d+=P*P*(P*P)*we(l,n+(u&N<<1),a+(h&L<<1),s+le,I,U,k)}}return d*9.046026385208288}_SingleCellularR2(e,t,i){const o=Math.round(t),n=Math.round(i);let a=Number.MAX_VALUE,s=Number.MAX_VALUE,c=0;const p=.43701595*this._CellularJitterModifier;let f=(o-1)*N;const l=(n-1)*L;switch(this._CellularDistanceFunction){default:case $e.Euclidean:case $e.EuclideanSq:for(let u=o-1;u<=o+1;u++){let h=l;for(let m=n-1;m<=n+1;m++){const v=Ae(e,f,h),g=v&510,x=u-t+de[g]*p,w=m-i+de[g|1]*p,d=x*x+w*w;s=Math.max(Math.min(s,d),a),d<a&&(a=d,c=v),h+=L}f+=N}break;case $e.Manhattan:for(let u=o-1;u<=o+1;u++){let h=l;for(let m=n-1;m<=n+1;m++){const v=Ae(e,f,h),g=v&510,x=u-t+de[g]*p,w=m-i+de[g|1]*p,d=Math.abs(x)+Math.abs(w);s=Math.max(Math.min(s,d),a),d<a&&(a=d,c=v),h+=L}f+=N}break;case $e.Hybrid:for(let u=o-1;u<=o+1;u++){let h=l;for(let m=n-1;m<=n+1;m++){const v=Ae(e,f,h),g=v&510,x=u-t+de[g]*p,w=m-i+de[g|1]*p,d=Math.abs(x)+Math.abs(w)+(x*x+w*w);s=Math.max(Math.min(s,d),a),d<a&&(a=d,c=v),h+=L}f+=N}break}switch(this._CellularDistanceFunction===$e.Euclidean&&this._CellularReturnType!==Re.CellValue&&(a=Math.sqrt(a),s=Math.sqrt(s)),this._CellularReturnType){case Re.CellValue:return c*(1/2147483648);case Re.Distance:return a-1;case Re.Distance2:return s-1;case Re.Distance2Add:return(s+a)*.5-1;case Re.Distance2Sub:return s-a-1;case Re.Distance2Mul:return s*a*.5-1;case Re.Distance2Div:return a/s-1;default:return 0}}_SingleCellularR3(e,t,i,o){const n=Math.round(t),a=Math.round(i),s=Math.round(o);let c=Number.MAX_VALUE,p=Number.MAX_VALUE,f=0;const l=.39614353*this._CellularJitterModifier;let u=(n-1)*N;const h=(a-1)*L,m=(s-1)*le;switch(this._CellularDistanceFunction){case $e.Euclidean:case $e.EuclideanSq:for(let v=n-1;v<=n+1;v++){let g=h;for(let x=a-1;x<=a+1;x++){let w=m;for(let d=s-1;d<=s+1;d++){const b=je(e,u,g,w),_=b&1020,k=v-t+te[_]*l,y=x-i+te[_|1]*l,A=d-o+te[_|2]*l,W=k*k+y*y+A*A;p=Math.max(Math.min(p,W),c),W<c&&(c=W,f=b),w+=le}g+=L}u+=N}break;case $e.Manhattan:for(let v=n-1;v<=n+1;v++){let g=h;for(let x=a-1;x<=a+1;x++){let w=m;for(let d=s-1;d<=s+1;d++){const b=je(e,u,g,w),_=b&1020,k=v-t+te[_]*l,y=x-i+te[_|1]*l,A=d-o+te[_|2]*l,W=Math.abs(k)+Math.abs(y)+Math.abs(A);p=Math.max(Math.min(p,W),c),W<c&&(c=W,f=b),w+=le}g+=L}u+=N}break;case $e.Hybrid:for(let v=n-1;v<=n+1;v++){let g=h;for(let x=a-1;x<=a+1;x++){let w=m;for(let d=s-1;d<=s+1;d++){const b=je(e,u,g,w),_=b&1020,k=v-t+te[_]*l,y=x-i+te[_|1]*l,A=d-o+te[_|2]*l,W=Math.abs(k)+Math.abs(y)+Math.abs(A)+(k*k+y*y+A*A);p=Math.max(Math.min(p,W),c),W<c&&(c=W,f=b),w+=le}g+=L}u+=N}break}switch(this._CellularDistanceFunction===$e.Euclidean&&this._CellularReturnType!==Re.CellValue&&(c=Math.sqrt(c),p=Math.sqrt(p)),this._CellularReturnType){case Re.CellValue:return f*(1/2147483648);case Re.Distance:return c-1;case Re.Distance2:return p-1;case Re.Distance2Add:return(p+c)*.5-1;case Re.Distance2Sub:return p-c-1;case Re.Distance2Mul:return p*c*.5-1;case Re.Distance2Div:return c/p-1;default:return 0}}_SinglePerlinR3(e,t,i,o){let n=Math.floor(t),a=Math.floor(i),s=Math.floor(o);const c=t-n,p=i-a,f=o-s,l=c-1,u=p-1,h=f-1,m=It(c),v=It(p),g=It(f);n=Math.imul(n,N),a=Math.imul(a,L),s=Math.imul(s,le);const x=n+N,w=a+L,d=s+le,b=B(we(e,n,a,s,c,p,f),we(e,x,a,s,l,p,f),m),_=B(we(e,n,w,s,c,u,f),we(e,x,w,s,l,u,f),m),k=B(we(e,n,a,d,c,p,h),we(e,x,a,d,l,p,h),m),y=B(we(e,n,w,d,c,u,h),we(e,x,w,d,l,u,h),m),A=B(b,_,v),W=B(k,y,v);return B(A,W,g)*.9649214148521423}_SingleValueCubicR2(e,t,i){let o=Math.floor(t),n=Math.floor(i);const a=t-o,s=i-n;o=Math.imul(o,N),n=Math.imul(n,L);const c=o-N,p=n-L,f=o+N,l=n+L,u=o+(N<<1),h=n+(L<<1);return ge(ge(Pe(e,c,p),Pe(e,o,p),Pe(e,f,p),Pe(e,u,p),a),ge(Pe(e,c,n),Pe(e,o,n),Pe(e,f,n),Pe(e,u,n),a),ge(Pe(e,c,l),Pe(e,o,l),Pe(e,f,l),Pe(e,u,l),a),ge(Pe(e,c,h),Pe(e,o,h),Pe(e,f,h),Pe(e,u,h),a),s)*(1/(1.5*1.5))}_SingleValueCubicR3(e,t,i,o){let n=Math.floor(t),a=Math.floor(i),s=Math.floor(o);const c=t-n,p=i-a,f=o-s;n=Math.imul(n,N),a=Math.imul(a,L),s=Math.imul(s,le);const l=n-N,u=a-L,h=s-le,m=n+N,v=a+L,g=s+le,x=n+(N<<1),w=a+(L<<1),d=s+(le<<1);return ge(ge(ge(j(e,l,u,h),j(e,n,u,h),j(e,m,u,h),j(e,x,u,h),c),ge(j(e,l,a,h),j(e,n,a,h),j(e,m,a,h),j(e,x,a,h),c),ge(j(e,l,v,h),j(e,n,v,h),j(e,m,v,h),j(e,x,v,h),c),ge(j(e,l,w,h),j(e,n,w,h),j(e,m,w,h),j(e,x,w,h),c),p),ge(ge(j(e,l,u,s),j(e,n,u,s),j(e,m,u,s),j(e,x,u,s),c),ge(j(e,l,a,s),j(e,n,a,s),j(e,m,a,s),j(e,x,a,s),c),ge(j(e,l,v,s),j(e,n,v,s),j(e,m,v,s),j(e,x,v,s),c),ge(j(e,l,w,s),j(e,n,w,s),j(e,m,w,s),j(e,x,w,s),c),p),ge(ge(j(e,l,u,g),j(e,n,u,g),j(e,m,u,g),j(e,x,u,g),c),ge(j(e,l,a,g),j(e,n,a,g),j(e,m,a,g),j(e,x,a,g),c),ge(j(e,l,v,g),j(e,n,v,g),j(e,m,v,g),j(e,x,v,g),c),ge(j(e,l,w,g),j(e,n,w,g),j(e,m,w,g),j(e,x,w,g),c),p),ge(ge(j(e,l,u,d),j(e,n,u,d),j(e,m,u,d),j(e,x,u,d),c),ge(j(e,l,a,d),j(e,n,a,d),j(e,m,a,d),j(e,x,a,d),c),ge(j(e,l,v,d),j(e,n,v,d),j(e,m,v,d),j(e,x,v,d),c),ge(j(e,l,w,d),j(e,n,w,d),j(e,m,w,d),j(e,x,w,d),c),p),f)*(1/(1.5*1.5*1.5))}_SingleValueR2(e,t,i){let o=Math.floor(t),n=Math.floor(i);const a=rt(t-o),s=rt(i-n);o=Math.imul(o,N),n=Math.imul(n,L);const c=o+N,p=n+L,f=B(Pe(e,o,n),Pe(e,c,n),a),l=B(Pe(e,o,p),Pe(e,c,p),a);return B(f,l,s)}_SingleValueR3(e,t,i,o){let n=Math.floor(t),a=Math.floor(i),s=Math.floor(o);const c=rt(t-n),p=rt(i-a),f=rt(o-s);n=Math.imul(n,N),a=Math.imul(a,L),s=Math.imul(s,le);const l=n+N,u=a+L,h=s+le,m=B(j(e,n,a,s),j(e,l,a,s),c),v=B(j(e,n,u,s),j(e,l,u,s),c),g=B(j(e,n,a,h),j(e,l,a,h),c),x=B(j(e,n,u,h),j(e,l,u,h),c),w=B(m,v,p),d=B(g,x,p);return B(w,d,f)}_DoSingleDomainWarp(e,t,i,o,n,a,s){const c=(f,l,u,h,m,v)=>{switch(this._DomainWarpType){case ze.OpenSimplex2:this._SingleDomainWarpOpenSimplex2Gradient(f,l*38.283687591552734,u,h,!1,m,v);break;case ze.OpenSimplex2Reduced:this._SingleDomainWarpOpenSimplex2Gradient(f,l*16,u,h,!0,m,v);break;case ze.BasicGrid:this._SingleDomainWarpBasicGrid(f,l,u,h,m,v);break}},p=(f,l,u,h,m,v,g)=>{switch(this._DomainWarpType){case ze.OpenSimplex2:this._SingleDomainWarpOpenSimplex2Gradient(f,l*32.69428253173828,u,h,!1,m,v,g);break;case ze.OpenSimplex2Reduced:this._SingleDomainWarpOpenSimplex2Gradient(f,l*7.71604938271605,u,h,!0,m,v,g);break;case ze.BasicGrid:this._SingleDomainWarpBasicGrid(f,l,u,h,m,v,g);break}};if(o instanceof wt)return c(e,t,i,o,n,a);if(o instanceof bt&&s!==void 0)return p(e,t,i,o,n,a,s)}_DomainWarpSingle(e){const t=o=>{const n=this._Seed,a=this._DomainWarpAmp*this._FractalBounding,s=this._Frequency;let c=o.x,p=o.y;switch(this._DomainWarpType){case ze.OpenSimplex2:case ze.OpenSimplex2Reduced:{const l=.5*(1.7320508075688772-1),u=(c+p)*l;c+=u,p+=u;break}}this._DoSingleDomainWarp(n,a,s,o,c,p)},i=o=>{const n=this._Seed,a=this._DomainWarpAmp*this._FractalBounding,s=this._Frequency;let c=o.x,p=o.y,f=o.z;switch(this._WarpTransformType3D){case Se.ImproveXYPlanes:{const l=c+p,u=l*-.211324865405187;f*=.577350269189626,c+=u-f,p=p+u-f,f+=l*.577350269189626}break;case Se.ImproveXZPlanes:{const l=c+f,u=l*-.211324865405187;p*=.577350269189626,c+=u-p,f+=u-p,p+=l*.577350269189626}break;case Se.DefaultOpenSimplex2:{const u=(c+p+f)*.6666666666666666;c=u-c,p=u-p,f=u-f;break}}this._DoSingleDomainWarp(n,a,s,o,c,p,f)};if(e instanceof wt)return t(e);if(e instanceof bt)return i(e)}_DomainWarpFractalProgressive(e){const t=o=>{let n=this._Seed,a=this._DomainWarpAmp*this._FractalBounding,s=this._Frequency;for(let c=0;c<this._Octaves;c++){let p=o.x,f=o.y;switch(this._DomainWarpType){case ze.OpenSimplex2:case ze.OpenSimplex2Reduced:{const u=.5*(1.7320508075688772-1),h=(p+f)*u;p+=h,f+=h;break}}this._DoSingleDomainWarp(n,a,s,o,p,f),n++,a*=this._Gain,s*=this._Lacunarity}},i=o=>{let n=this._Seed,a=this._DomainWarpAmp*this._FractalBounding,s=this._Frequency;for(let c=0;c<this._Octaves;c++){let p=o.x,f=o.y,l=o.z;switch(this._WarpTransformType3D){case Se.ImproveXYPlanes:{const u=p+f,h=u*-.211324865405187;l*=.577350269189626,p+=h-l,f=f+h-l,l+=u*.577350269189626}break;case Se.ImproveXZPlanes:{const u=p+l,h=u*-.211324865405187;f*=.577350269189626,p+=h-f,l+=h-f,f+=u*.577350269189626}break;case Se.DefaultOpenSimplex2:{const h=(p+f+l)*.6666666666666666;p=h-p,f=h-f,l=h-l}break}this._DoSingleDomainWarp(n,a,s,o,p,f,l),n++,a*=this._Gain,s*=this._Lacunarity}};if(e instanceof wt)return t(e);if(e instanceof bt)return i(e)}_DomainWarpFractalIndependent(e){const t=o=>{let n=o.x,a=o.y;switch(this._DomainWarpType){case ze.OpenSimplex2:case ze.OpenSimplex2Reduced:{const l=.5*(1.7320508075688772-1),u=(n+a)*l;n+=u,a+=u;break}}let s=this._Seed,c=this._DomainWarpAmp*this._FractalBounding,p=this._Frequency;for(let f=0;f<this._Octaves;f++)this._DoSingleDomainWarp(s,c,p,o,n,a),s++,c*=this._Gain,p*=this._Lacunarity},i=o=>{let n=o.x,a=o.y,s=o.z;switch(this._WarpTransformType3D){case Se.ImproveXYPlanes:{const l=n+a,u=l*-.211324865405187;s*=.577350269189626,n+=u-s,a=a+u-s,s+=l*.577350269189626}break;case Se.ImproveXZPlanes:{const l=n+s,u=l*-.211324865405187;a*=.577350269189626,n+=u-a,s+=u-a,a+=l*.577350269189626}break;case Se.DefaultOpenSimplex2:{const u=(n+a+s)*.6666666666666666;n=u-n,a=u-a,s=u-s}break}let c=this._Seed,p=this._DomainWarpAmp*this._FractalBounding,f=this._Frequency;for(let l=0;l<this._Octaves;l++)this._DoSingleDomainWarp(c,p,f,o,n,a,s),c++,p*=this._Gain,f*=this._Lacunarity};if(e instanceof wt)return t(e);if(e instanceof bt)return i(e)}_SingleDomainWarpBasicGrid(e,t,i,o,n,a,s){const c=(f,l,u,h,m,v)=>{const g=m*u,x=v*u;let w=Math.floor(g),d=Math.floor(x);const b=rt(g-w),_=rt(x-d);w=Math.imul(w,N),d=Math.imul(d,L);const k=w+N,y=d+L;let A=Ae(f,w,d)&510,W=Ae(f,k,d)&510;const $=B(de[A],de[W],b),X=B(de[A|1],de[W|1],b);A=Ae(f,w,y)&510,W=Ae(f,k,y)&510;const H=B(de[A],de[W],b),Z=B(de[A|1],de[W|1],b);h.x+=B($,H,_)*l,h.y+=B(X,Z,_)*l},p=(f,l,u,h,m,v,g)=>{const x=m*u,w=v*u,d=g*u;let b=Math.floor(x),_=Math.floor(w),k=Math.floor(d);const y=rt(x-b),A=rt(w-_),W=rt(d-k);b=Math.imul(b,N),_=Math.imul(_,L),k=Math.imul(k,le);const $=b+N,X=_+L,H=k+le;let Z=je(f,b,_,k)&1020,C=je(f,$,_,k)&1020,K=B(te[Z],te[C],y),ee=B(te[Z|1],te[C|1],y),z=B(te[Z|2],te[C|2],y);Z=je(f,b,X,k)&1020,C=je(f,$,X,k)&1020;let Y=B(te[Z],te[C],y),V=B(te[Z|1],te[C|1],y),P=B(te[Z|2],te[C|2],y);const I=B(K,Y,A),U=B(ee,V,A),q=B(z,P,A);Z=je(f,b,_,H)&1020,C=je(f,$,_,H)&1020,K=B(te[Z],te[C],y),ee=B(te[Z|1],te[C|1],y),z=B(te[Z|2],te[C|2],y),Z=je(f,b,X,H)&1020,C=je(f,$,X,H)&1020,Y=B(te[Z],te[C],y),V=B(te[Z|1],te[C|1],y),P=B(te[Z|2],te[C|2],y),h.x+=B(I,B(K,Y,A),W)*l,h.y+=B(U,B(ee,V,A),W)*l,h.z+=B(q,B(z,P,A),W)*l};o instanceof wt&&c(e,t,i,o,n,a),o instanceof bt&&s!==void 0&&p(e,t,i,o,n,a,s)}_SingleDomainWarpOpenSimplex2Gradient(e,t,i,o,n,a,s,c){const p=(l,u,h,m,v,g,x)=>{const d=(3-1.7320508075688772)/6;g*=h,x*=h;let b=Math.floor(g),_=Math.floor(x);const k=g-b,y=x-_,A=(k+y)*d,W=k-A,$=y-A;b=Math.imul(b,N),_=Math.imul(_,L);let X,H;X=H=0;const Z=.5-W*W-$*$;if(Z>0){const K=Z*Z*(Z*Z);let ee,z;if(v){const Y=Ae(l,b,_)&510;ee=de[Y],z=de[Y|1]}else{const Y=Ae(l,b,_),V=Y&254,P=Y>>7&510,I=ot[V],U=ot[V|1],q=W*I+$*U,ue=de[P],se=de[P|1];ee=q*ue,z=q*se}X+=K*ee,H+=K*z}const C=2*(1-2*d)*(1/d-2)*A+(-2*(1-2*d)*(1-2*d)+Z);if(C>0){const K=W+(2*d-1),ee=$+(2*d-1),z=C*C*(C*C);let Y,V;if(v){const P=Ae(l,b+N,_+L)&510;Y=de[P],V=de[P|1]}else{const P=Ae(l,b+N,_+L),I=P&254,U=P>>7&510,q=ot[I],ue=ot[I|1],se=K*q+ee*ue,xe=de[U],ke=de[U|1];Y=se*xe,V=se*ke}X+=z*Y,H+=z*V}if($>W){const K=W+d,ee=$+(d-1),z=.5-K*K-ee*ee;if(z>0){const Y=z*z*(z*z);let V,P;if(v){const I=Ae(l,b,_+L)&510;V=de[I],P=de[I|1]}else{const I=Ae(l,b,_+L),U=I&254,q=I>>7&510,ue=ot[U],se=ot[U|1],xe=K*ue+ee*se,ke=de[q],We=de[q|1];V=xe*ke,P=xe*We}X+=Y*V,H+=Y*P}}else{const K=W+(d-1),ee=$+d,z=.5-K*K-ee*ee;if(z>0){const Y=z*z*(z*z);let V,P;if(v){const I=Ae(l,b+N,_)&510;V=de[I],P=de[I|1]}else{const I=Ae(l,b+N,_),U=I&254,q=I>>7&510,ue=ot[U],se=ot[U|1],xe=K*ue+ee*se,ke=de[q],We=de[q|1];V=xe*ke,P=xe*We}X+=Y*V,H+=Y*P}}m.x+=X*u,m.y+=H*u},f=(l,u,h,m,v,g,x,w)=>{g*=h,x*=h,w*=h;let d=Math.round(g),b=Math.round(x),_=Math.round(w),k=g-d,y=x-b,A=w-_,W=-k-1|1,$=-y-1|1,X=-A-1|1,H=W*-k,Z=$*-y,C=X*-A;d=Math.imul(d,N),b=Math.imul(b,L),_=Math.imul(_,le);let K,ee,z;K=ee=z=0;let Y=.6-k*k-(y*y+A*A);for(let V=0;;V++){if(Y>0){const ke=Y*Y*(Y*Y);let We,Xe,Ze;if(v){const Te=je(l,d,b,_)&1020;We=te[Te],Xe=te[Te|1],Ze=te[Te|2]}else{const Te=je(l,d,b,_),Ge=Te&252,Ne=Te>>6&1020,st=ut[Ge],Tt=ut[Ge|1],Ot=ut[Ge|2],ct=k*st+y*Tt+A*Ot,Wt=te[Ne],O=te[Ne|1],F=te[Ne|2];We=ct*Wt,Xe=ct*O,Ze=ct*F}K+=ke*We,ee+=ke*Xe,z+=ke*Ze}let P=Y,I=d,U=b,q=_,ue=k,se=y,xe=A;if(H>=Z&&H>=C?(ue+=W,P=P+H+H,I-=W*N):Z>H&&Z>=C?(se+=$,P=P+Z+Z,U-=$*L):(xe+=X,P=P+C+C,q-=X*le),P>1){P-=1;const ke=P*P*(P*P);let We,Xe,Ze;if(v){const Te=je(l,I,U,q)&1020;We=te[Te],Xe=te[Te|1],Ze=te[Te|2]}else{const Te=je(l,I,U,q),Ge=Te&252,Ne=Te>>6&1020,st=ut[Ge],Tt=ut[Ge|1],Ot=ut[Ge|2],ct=ue*st+se*Tt+xe*Ot,Wt=te[Ne],O=te[Ne|1],F=te[Ne|2];We=ct*Wt,Xe=ct*O,Ze=ct*F}K+=ke*We,ee+=ke*Xe,z+=ke*Ze}if(V===1)break;H=.5-H,Z=.5-Z,C=.5-C,k=W*H,y=$*Z,A=X*C,Y+=.75-H-(Z+C),d+=W>>1&N,b+=$>>1&L,_+=X>>1&le,W=-W,$=-$,X=-X,l+=1293373}m.x+=K*u,m.y+=ee*u,m.z+=z*u};o instanceof wt&&p(e,t,i,o,n,a,s),o instanceof bt&&c!==void 0&&f(e,t,i,o,n,a,s,c)}}function on(r){if(!/^#[0-9A-Fa-f]{6}$/gu.test(r))throw new Error("Invalid hex format. Expected format: #RRGGBB");return{r:parseInt(r.substring(1,3),16),g:parseInt(r.substring(3,5),16),b:parseInt(r.substring(5,7),16)}}const an=({value:r,input:e,output:t})=>(r-e.min)/(e.max-e.min)*(t.max-t.min)+t.min,sn=r=>{let e=0;for(let t=0;t<r.length;t++)e=(e<<5)-e+r.charCodeAt(t),e|=0;return Math.abs(e)};class Nt{constructor(e,t){this.max=e,this._seed=t}cast(e,t){return BigInt.asUintN(t,e)}checkNum(e){if(e>this.max)throw new Error(`Number greater than ${this.max}`)}reset(){if(this.constructor===Nt)throw new Error("Method not implemented")}_int(){if(this.constructor===Nt)throw new Error("Method not implemented");return BigInt(0)}bool(){return this.float()>=.5}coin(e=.5){return this.float()<e}int(){return Number(this._int())}bigInt(){return this._int()}float(){return this.int()*(1/this.max)}float53(){const e=this.int()>>>5,t=this.int()>>>6;return(e*67108864+t)*(1/9007199254740992)}randRange(e,t){const i=t-e,o=this.max%i;let n=this.int();for(;n<o;)n=this.int();return e+n%i}randBelow(e){return this.randRange(0,e)}choice(e){return e[this.randBelow(e.length)]}shuffle(e,t=!0){let i=e;t||(i=Array.from(i));for(let o=i.length-1;o>0;o--){const n=this.randRange(0,o),a=i[o];i[o]=i[n],i[n]=a}return i}initArray(e,t){return Array.from({length:e},t)}boolArray(e){return this.initArray(e,()=>this.bool())}coinArray(e,t=.5){return this.initArray(e,()=>this.coin(t))}intArray(e){return this.initArray(e,()=>this.int())}bigIntArray(e){return this.initArray(e,()=>this.bigInt())}randRangeArray(e,t,i){return this.initArray(e,()=>this.randRange(t,i))}floatArray(e){return this.initArray(e,()=>this.float())}float53Array(e){return this.initArray(e,()=>this.float53())}}class cn extends Nt{constructor(e,t){super(e,t)}int(){return Number(this._int()>>11n)}float(){return this.int()/this.max}float53(){return this.float()}}const ln=2**32,un=2**53;class Dr extends cn{constructor(e=Date.now(),t=13,i=7,o=17){super(un,BigInt(e)),this.seed=e,this.a=this.cast(BigInt(t),64),this.b=this.cast(BigInt(i),64),this.c=this.cast(BigInt(o),64)}reset(){this.x=this.seed}get seed(){return this._seed}set seed(e){this._seed=this.cast(BigInt(e),64),this.x=this._seed}_int(){let{x:e}=this;return e^=e<<this.a,e=this.cast(e,64),e^=e>>this.b,e^=e<<this.c,e=this.cast(e,64),this.x=e,e}}class fn extends Nt{constructor(e=Date.now(),t=362436069,i=521288629,o=88675123,n=5783321,a=6615241,s=362437){super(ln,BigInt(e)),this._seed=this.cast(this._seed,32),this.x=this._seed,this.y=this.cast(BigInt(t),32),this.z=this.cast(BigInt(i),32),this.w=this.cast(BigInt(o),32),this.v=this.cast(BigInt(n),32),this.d=this.cast(BigInt(a),32),this.weyl=this.cast(BigInt(s),32),this.origParams={y:this.y,z:this.z,w:this.w,v:this.v,d:this.d}}reset(){this.x=this.seed,Object.assign(this,this.origParams)}get seed(){return this._seed}set seed(e){this._seed=this.cast(BigInt(e),32),this.reset()}_int(){let e=this.x,{v:t}=this;return e^=e>>2n,e^=e<<1n,t^=t<<4n,this.x=this.y,this.y=this.z,this.z=this.w,this.w=this.v,this.v=this.cast(t^e,32),this.d+=this.weyl,this.cast(this.d+this.v,32)}}new Dr(Date.now());new Dr(Date.now());const yt=({seed:r})=>{const e=new fn(sn(r)),t=new Me(e.float());return t.SetFrequency(1),t},hn=r=>{const e=yt({seed:r});return e.SetNoiseType(Me.NoiseType.ValueCubic),e.SetFractalType(Me.FractalType.PingPong),e.SetFractalOctaves(6),e.SetFractalWeightedStrength(-.75),(t,i)=>e.GetNoise(t,i)},pn=r=>{const e=yt({seed:r});return e.SetNoiseType(Me.NoiseType.Perlin),e.SetDomainWarpType(Me.DomainWarpType.OpenSimplex2),e.SetDomainWarpAmp(25),e.SetFractalType(Me.FractalType.PingPong),e.SetFractalOctaves(4),e.SetFractalLacunarity(2.75),e.SetFractalPingPongStrength(2.25),(t,i)=>e.GetNoise(t,i)},dr=({offsetX:r=100,offsetZ:e=0,noise:t})=>(i,o)=>{const n=t(i*.1+r,o*.1+r)*2,a=t(i*.1+e,o*.1+e)*2;return t(i+n,o+a)},dn={cubic:r=>{const e=yt({seed:r});return e.SetNoiseType(Me.NoiseType.ValueCubic),e.SetFractalType(Me.FractalType.PingPong),e.SetFractalOctaves(6),e.SetFractalWeightedStrength(-.75),(t,i)=>e.GetNoise(t,i)},simplex:r=>{const e=yt({seed:r});return e.SetNoiseType(Me.NoiseType.OpenSimplex2S),e.SetFractalType(Me.FractalType.PingPong),e.SetFractalOctaves(6),e.SetFractalWeightedStrength(-.75),(t,i)=>e.GetNoise(t,i)},perlin:r=>{const e=yt({seed:r});return e.SetNoiseType(Me.NoiseType.Perlin),e.SetDomainWarpType(Me.DomainWarpType.OpenSimplex2),e.SetDomainWarpAmp(25),e.SetFractalType(Me.FractalType.PingPong),e.SetFractalOctaves(4),e.SetFractalLacunarity(2.75),e.SetFractalPingPongStrength(2.25),(t,i)=>e.GetNoise(t,i)},perlinWarpX:r=>dr({noise:pn(r),offsetX:5}),cubicWarpX:r=>dr({noise:hn(r),offsetX:5}),cellular:r=>{const e=yt({seed:r});return e.SetNoiseType(Me.NoiseType.Cellular),e.SetCellularDistanceFunction(Me.CellularDistanceFunction.EuclideanSq),e.SetCellularReturnType(Me.CellularReturnType.Distance),(t,i)=>e.GetNoise(t,i)},pingPongCellular:r=>{const e=yt({seed:r});return e.SetNoiseType(Me.NoiseType.Cellular),e.SetCellularDistanceFunction(Me.CellularDistanceFunction.Hybrid),e.SetCellularReturnType(Me.CellularReturnType.Distance2Add),e.SetFractalType(Me.FractalType.PingPong),e.SetFractalOctaves(4),(t,i)=>e.GetNoise(t,i)}},mr=(r,e,t,i,o)=>{const n=i.map(({noise:s,name:c})=>o[s](`${t}-${c}`)),a=i.filter(s=>!s.disabled).reduce((s,{scale:c,inverse:p,weight:f,limit:l},u)=>{let h=n[u](r*c,e*c);return f&&(h*=f),p&&(h*=-1),l&&(l.min!==void 0&&(h=Math.max(l.min,h)),l.max!==void 0&&(h=Math.min(l.max,h))),h=s+h,h},0);return Math.max(-1,Math.min(1,a))},mn=({seed:r,noise:e,layers:t,variation:i=[]})=>(o,n)=>{let a=mr(o,n,r,t,e);const s=i.find(({min:c,max:p})=>c<=a&&a<=p);if(s){const c=mr(o,n,r,s.layers,e);a=an({value:c,input:{min:-1,max:1},output:s})*s.weight}return Math.max(-1,Math.min(1,a))},vn=({seed:r})=>mn({seed:r,noise:dn,variation:[{name:"water",min:-1,max:-.9,weight:1,layers:[{name:"warp",noise:"perlinWarpX",scale:.75},{name:"cell",noise:"cubic",scale:.2,weight:.5}]},{name:"mountain",min:.95,max:1,weight:1,layers:[{name:"perlin",noise:"perlin",scale:.25,weight:.5},{name:"warp",noise:"cubicWarpX",scale:1.5}]}],layers:[{name:"continents",noise:"pingPongCellular",scale:.05,weight:2},{name:"continent-level-01",noise:"simplex",scale:.25,weight:.35},{disabled:!0,name:"continent-level-01",noise:"perlin",scale:1,weight:.75}]});var ir=["u8","u16","u32","u64","u128","i8","i16","i32","i64","i128","f32","f64"],yn=function(){function r(){this.offset=0,this.buffer_size=256,this.buffer=new ArrayBuffer(this.buffer_size),this.view=new DataView(this.buffer)}return r.prototype.resize_if_necessary=function(e){if(this.buffer_size-this.offset<e){this.buffer_size=Math.max(this.buffer_size*2,this.buffer_size+e);var t=new ArrayBuffer(this.buffer_size);new Uint8Array(t).set(new Uint8Array(this.buffer)),this.buffer=t,this.view=new DataView(t)}},r.prototype.get_used_buffer=function(){return new Uint8Array(this.buffer).slice(0,this.offset)},r.prototype.store_value=function(e,t){var i=t.substring(1),o=parseInt(i)/8;this.resize_if_necessary(o);var n=t[0]==="f"?"setFloat".concat(i):t[0]==="i"?"setInt".concat(i):"setUint".concat(i);this.view[n](this.offset,e,!0),this.offset+=o},r.prototype.store_bytes=function(e){this.resize_if_necessary(e.length),new Uint8Array(this.buffer).set(new Uint8Array(e),this.offset),this.offset+=e.length},r}(),gn=function(){function r(e){this.offset=0,this.buffer_size=e.length,this.buffer=new ArrayBuffer(e.length),new Uint8Array(this.buffer).set(e),this.view=new DataView(this.buffer)}return r.prototype.assert_enough_buffer=function(e){if(this.offset+e>this.buffer.byteLength)throw new Error("Error in schema, the buffer is smaller than expected")},r.prototype.consume_value=function(e){var t=e.substring(1),i=parseInt(t)/8;this.assert_enough_buffer(i);var o=e[0]==="f"?"getFloat".concat(t):e[0]==="i"?"getInt".concat(t):"getUint".concat(t),n=this.view[o](this.offset,!0);return this.offset+=i,n},r.prototype.consume_bytes=function(e){this.assert_enough_buffer(e);var t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t},r}(),wn=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(i[n]=o[n])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();function bn(r){return Array.isArray(r)||!!r&&typeof r=="object"&&"length"in r&&typeof r.length=="number"&&(r.length===0||r.length>0&&r.length-1 in r)}function _t(r,e,t){if(typeof r!==e)throw new Error("Expected ".concat(e," not ").concat(typeof r,"(").concat(r,") at ").concat(t.join(".")))}function _n(r,e){var t=["number","string","bigint","boolean"].includes(typeof r),i=typeof r=="object"&&r!==null&&"toString"in r;if(!t&&!i)throw new Error("Expected bigint, number, boolean or string not ".concat(typeof r,"(").concat(r,") at ").concat(e.join(".")))}function vr(r,e,t){if(r!==e)throw new Error("Array length ".concat(r," does not match schema length ").concat(e," at ").concat(t.join(".")))}function xn(r,e){if(typeof r!="object"||r===null)throw new Error("Expected object not ".concat(typeof r,"(").concat(r,") at ").concat(e.join(".")))}var yr=ir.concat(["bool","string"]),gr=["option","enum","array","set","map","struct"],St=function(r){wn(e,r);function e(t,i){var o="Invalid schema: ".concat(JSON.stringify(t)," expected ").concat(i);return r.call(this,o)||this}return e}(Error);function ft(r){if(!(typeof r=="string"&&yr.includes(r))){if(r&&typeof r=="object"){var e=Object.keys(r);if(e.length===1&&gr.includes(e[0])){var t=e[0];if(t==="option")return ft(r[t]);if(t==="enum")return kn(r[t]);if(t==="array")return Sn(r[t]);if(t==="set")return ft(r[t]);if(t==="map")return Tn(r[t]);if(t==="struct")return On(r[t])}}throw new St(r,gr.join(", ")+" or "+yr.join(", "))}}function kn(r){if(!Array.isArray(r))throw new St(r,"Array");for(var e=0,t=r;e<t.length;e++){var i=t[e];if(typeof i!="object"||!("struct"in i))throw new Error('Missing "struct" key in enum schema');if(typeof i.struct!="object"||Object.keys(i.struct).length!==1)throw new Error('The "struct" in each enum must have a single key');ft({struct:i.struct})}}function Sn(r){if(typeof r!="object")throw new St(r,"{ type, len? }");if(r.len&&typeof r.len!="number")throw new Error("Invalid schema: ".concat(r));if("type"in r)return ft(r.type);throw new St(r,"{ type, len? }")}function Tn(r){if(typeof r=="object"&&"key"in r&&"value"in r)ft(r.key),ft(r.value);else throw new St(r,"{ key, value }")}function On(r){if(typeof r!="object")throw new St(r,"object");for(var e in r)ft(r[e])}var Wn=function(){function r(e){this.encoded=new yn,this.fieldPath=["value"],this.checkTypes=e}return r.prototype.encode=function(e,t){return this.encode_value(e,t),this.encoded.get_used_buffer()},r.prototype.encode_value=function(e,t){if(typeof t=="string"){if(ir.includes(t))return this.encode_integer(e,t);if(t==="string")return this.encode_string(e);if(t==="bool")return this.encode_boolean(e)}if(typeof t=="object"){if("option"in t)return this.encode_option(e,t);if("enum"in t)return this.encode_enum(e,t);if("array"in t)return this.encode_array(e,t);if("set"in t)return this.encode_set(e,t);if("map"in t)return this.encode_map(e,t);if("struct"in t)return this.encode_struct(e,t)}},r.prototype.encode_integer=function(e,t){var i=parseInt(t.substring(1));i<=32||t=="f64"?(this.checkTypes&&_t(e,"number",this.fieldPath),this.encoded.store_value(e,t)):(this.checkTypes&&_n(e,this.fieldPath),this.encode_bigint(BigInt(e),i))},r.prototype.encode_bigint=function(e,t){for(var i=t/8,o=new Uint8Array(i),n=0;n<i;n++)o[n]=Number(e&BigInt(255)),e=e>>BigInt(8);this.encoded.store_bytes(new Uint8Array(o))},r.prototype.encode_string=function(e){this.checkTypes&&_t(e,"string",this.fieldPath);for(var t=e,i=[],o=0;o<t.length;o++){var n=t.charCodeAt(o);n<128?i.push(n):n<2048?i.push(192|n>>6,128|n&63):n<55296||n>=57344?i.push(224|n>>12,128|n>>6&63,128|n&63):(o++,n=65536+((n&1023)<<10|t.charCodeAt(o)&1023),i.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63))}this.encoded.store_value(i.length,"u32"),this.encoded.store_bytes(new Uint8Array(i))},r.prototype.encode_boolean=function(e){this.checkTypes&&_t(e,"boolean",this.fieldPath),this.encoded.store_value(e?1:0,"u8")},r.prototype.encode_option=function(e,t){e==null?this.encoded.store_value(0,"u8"):(this.encoded.store_value(1,"u8"),this.encode_value(e,t.option))},r.prototype.encode_enum=function(e,t){this.checkTypes&&xn(e,this.fieldPath);for(var i=Object.keys(e)[0],o=0;o<t.enum.length;o++){var n=t.enum[o];if(i===Object.keys(n.struct)[0])return this.encoded.store_value(o,"u8"),this.encode_struct(e,n)}throw new Error("Enum key (".concat(i,") not found in enum schema: ").concat(JSON.stringify(t)," at ").concat(this.fieldPath.join(".")))},r.prototype.encode_array=function(e,t){if(bn(e))return this.encode_arraylike(e,t);if(e instanceof ArrayBuffer)return this.encode_buffer(e,t);throw new Error("Expected Array-like not ".concat(typeof e,"(").concat(e,") at ").concat(this.fieldPath.join(".")))},r.prototype.encode_arraylike=function(e,t){t.array.len?vr(e.length,t.array.len,this.fieldPath):this.encoded.store_value(e.length,"u32");for(var i=0;i<e.length;i++)this.encode_value(e[i],t.array.type)},r.prototype.encode_buffer=function(e,t){t.array.len?vr(e.byteLength,t.array.len,this.fieldPath):this.encoded.store_value(e.byteLength,"u32"),this.encoded.store_bytes(new Uint8Array(e))},r.prototype.encode_set=function(e,t){this.checkTypes&&_t(e,"object",this.fieldPath);var i=e instanceof Set,o=i?Array.from(e.values()):Object.values(e);this.encoded.store_value(o.length,"u32");for(var n=0,a=o;n<a.length;n++){var s=a[n];this.encode_value(s,t.set)}},r.prototype.encode_map=function(e,t){this.checkTypes&&_t(e,"object",this.fieldPath);var i=e instanceof Map,o=i?Array.from(e.keys()):Object.keys(e);this.encoded.store_value(o.length,"u32");for(var n=0,a=o;n<a.length;n++){var s=a[n];this.encode_value(s,t.map.key),this.encode_value(i?e.get(s):e[s],t.map.value)}},r.prototype.encode_struct=function(e,t){this.checkTypes&&_t(e,"object",this.fieldPath);for(var i=0,o=Object.keys(t.struct);i<o.length;i++){var n=o[i];this.fieldPath.push(n),this.encode_value(e[n],t.struct[n]),this.fieldPath.pop()}},r}(),Pn=function(){function r(e){this.buffer=new gn(e)}return r.prototype.decode=function(e){return this.decode_value(e)},r.prototype.decode_value=function(e){if(typeof e=="string"){if(ir.includes(e))return this.decode_integer(e);if(e==="string")return this.decode_string();if(e==="bool")return this.decode_boolean()}if(typeof e=="object"){if("option"in e)return this.decode_option(e);if("enum"in e)return this.decode_enum(e);if("array"in e)return this.decode_array(e);if("set"in e)return this.decode_set(e);if("map"in e)return this.decode_map(e);if("struct"in e)return this.decode_struct(e)}throw new Error("Unsupported type: ".concat(e))},r.prototype.decode_integer=function(e){var t=parseInt(e.substring(1));return t<=32||e=="f64"?this.buffer.consume_value(e):this.decode_bigint(t,e.startsWith("i"))},r.prototype.decode_bigint=function(e,t){t===void 0&&(t=!1);var i=e/8,o=new Uint8Array(this.buffer.consume_bytes(i)),n=o.reduceRight(function(a,s){return a+s.toString(16).padStart(2,"0")},"");return t&&o[i-1]?BigInt.asIntN(e,BigInt("0x".concat(n))):BigInt("0x".concat(n))},r.prototype.decode_string=function(){for(var e=this.decode_integer("u32"),t=new Uint8Array(this.buffer.consume_bytes(e)),i=[],o=0;o<e;++o){var n=t[o];if(n<128)i.push(n);else if(n<224)i.push((n&31)<<6|t[++o]&63);else if(n<240)i.push((n&15)<<12|(t[++o]&63)<<6|t[++o]&63);else{var a=(n&7)<<18|(t[++o]&63)<<12|(t[++o]&63)<<6|t[++o]&63;i.push(a)}}return String.fromCodePoint.apply(String,i)},r.prototype.decode_boolean=function(){return this.buffer.consume_value("u8")>0},r.prototype.decode_option=function(e){var t=this.buffer.consume_value("u8");if(t===1)return this.decode_value(e.option);if(t!==0)throw new Error("Invalid option ".concat(t));return null},r.prototype.decode_enum=function(e){var t,i=this.buffer.consume_value("u8");if(i>e.enum.length)throw new Error("Enum option ".concat(i," is not available"));var o=e.enum[i].struct,n=Object.keys(o)[0];return t={},t[n]=this.decode_value(o[n]),t},r.prototype.decode_array=function(e){for(var t=[],i=e.array.len?e.array.len:this.decode_integer("u32"),o=0;o<i;++o)t.push(this.decode_value(e.array.type));return t},r.prototype.decode_set=function(e){for(var t=this.decode_integer("u32"),i=new Set,o=0;o<t;++o)i.add(this.decode_value(e.set));return i},r.prototype.decode_map=function(e){for(var t=this.decode_integer("u32"),i=new Map,o=0;o<t;++o){var n=this.decode_value(e.map.key),a=this.decode_value(e.map.value);i.set(n,a)}return i},r.prototype.decode_struct=function(e){var t={};for(var i in e.struct)t[i]=this.decode_value(e.struct[i]);return t},r}();function Mn(r,e,t){t===void 0&&(t=!0),t&&ft(r);var i=new Wn(t);return i.encode(e,r)}function Fn(r,e,t){t===void 0&&(t=!0),t&&ft(r);var i=new Pn(e);return i.decode(r)}var Ie=Uint8Array,He=Uint16Array,or=Int32Array,Ut=new Ie([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Vt=new Ie([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Kt=new Ie([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Er=function(r,e){for(var t=new He(31),i=0;i<31;++i)t[i]=e+=1<<r[i-1];for(var o=new or(t[30]),i=1;i<30;++i)for(var n=t[i];n<t[i+1];++n)o[n]=n-t[i]<<5|i;return{b:t,r:o}},Ar=Er(Ut,2),jr=Ar.b,er=Ar.r;jr[28]=258,er[258]=28;var Ir=Er(Vt,0),Rn=Ir.b,wr=Ir.r,tr=new He(32768);for(var _e=0;_e<32768;++_e){var pt=(_e&43690)>>1|(_e&21845)<<1;pt=(pt&52428)>>2|(pt&13107)<<2,pt=(pt&61680)>>4|(pt&3855)<<4,tr[_e]=((pt&65280)>>8|(pt&255)<<8)>>1}var at=function(r,e,t){for(var i=r.length,o=0,n=new He(e);o<i;++o)r[o]&&++n[r[o]-1];var a=new He(e);for(o=1;o<e;++o)a[o]=a[o-1]+n[o-1]<<1;var s;if(t){s=new He(1<<e);var c=15-e;for(o=0;o<i;++o)if(r[o])for(var p=o<<4|r[o],f=e-r[o],l=a[r[o]-1]++<<f,u=l|(1<<f)-1;l<=u;++l)s[tr[l]>>c]=p}else for(s=new He(i),o=0;o<i;++o)r[o]&&(s[o]=tr[a[r[o]-1]++]>>15-r[o]);return s},vt=new Ie(288);for(var _e=0;_e<144;++_e)vt[_e]=8;for(var _e=144;_e<256;++_e)vt[_e]=9;for(var _e=256;_e<280;++_e)vt[_e]=7;for(var _e=280;_e<288;++_e)vt[_e]=8;var Lt=new Ie(32);for(var _e=0;_e<32;++_e)Lt[_e]=5;var Dn=at(vt,9,0),En=at(vt,9,1),An=at(Lt,5,0),jn=at(Lt,5,1),Qt=function(r){for(var e=r[0],t=1;t<r.length;++t)r[t]>e&&(e=r[t]);return e},Ke=function(r,e,t){var i=e/8|0;return(r[i]|r[i+1]<<8)>>(e&7)&t},Jt=function(r,e){var t=e/8|0;return(r[t]|r[t+1]<<8|r[t+2]<<16)>>(e&7)},ar=function(r){return(r+7)/8|0},Nr=function(r,e,t){return(t==null||t>r.length)&&(t=r.length),new Ie(r.subarray(e,t))},In=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Ve=function(r,e,t){var i=new Error(e||In[r]);if(i.code=r,Error.captureStackTrace&&Error.captureStackTrace(i,Ve),!t)throw i;return i},sr=function(r,e,t,i){var o=r.length,n=0;if(!o||e.f&&!e.l)return t||new Ie(0);var a=!t,s=a||e.i!=2,c=e.i;a&&(t=new Ie(o*3));var p=function(Te){var Ge=t.length;if(Te>Ge){var Ne=new Ie(Math.max(Ge*2,Te));Ne.set(t),t=Ne}},f=e.f||0,l=e.p||0,u=e.b||0,h=e.l,m=e.d,v=e.m,g=e.n,x=o*8;do{if(!h){f=Ke(r,l,1);var w=Ke(r,l+1,3);if(l+=3,w)if(w==1)h=En,m=jn,v=9,g=5;else if(w==2){var k=Ke(r,l,31)+257,y=Ke(r,l+10,15)+4,A=k+Ke(r,l+5,31)+1;l+=14;for(var W=new Ie(A),$=new Ie(19),X=0;X<y;++X)$[Kt[X]]=Ke(r,l+X*3,7);l+=y*3;for(var H=Qt($),Z=(1<<H)-1,C=at($,H,1),X=0;X<A;){var K=C[Ke(r,l,Z)];l+=K&15;var d=K>>4;if(d<16)W[X++]=d;else{var ee=0,z=0;for(d==16?(z=3+Ke(r,l,3),l+=2,ee=W[X-1]):d==17?(z=3+Ke(r,l,7),l+=3):d==18&&(z=11+Ke(r,l,127),l+=7);z--;)W[X++]=ee}}var Y=W.subarray(0,k),V=W.subarray(k);v=Qt(Y),g=Qt(V),h=at(Y,v,1),m=at(V,g,1)}else Ve(1);else{var d=ar(l)+4,b=r[d-4]|r[d-3]<<8,_=d+b;if(_>o){c&&Ve(0);break}s&&p(u+b),t.set(r.subarray(d,_),u),e.b=u+=b,e.p=l=_*8,e.f=f;continue}if(l>x){c&&Ve(0);break}}s&&p(u+131072);for(var P=(1<<v)-1,I=(1<<g)-1,U=l;;U=l){var ee=h[Jt(r,l)&P],q=ee>>4;if(l+=ee&15,l>x){c&&Ve(0);break}if(ee||Ve(2),q<256)t[u++]=q;else if(q==256){U=l,h=null;break}else{var ue=q-254;if(q>264){var X=q-257,se=Ut[X];ue=Ke(r,l,(1<<se)-1)+jr[X],l+=se}var xe=m[Jt(r,l)&I],ke=xe>>4;xe||Ve(3),l+=xe&15;var V=Rn[ke];if(ke>3){var se=Vt[ke];V+=Jt(r,l)&(1<<se)-1,l+=se}if(l>x){c&&Ve(0);break}s&&p(u+131072);var We=u+ue;if(u<V){var Xe=n-V,Ze=Math.min(V,We);for(Xe+u<0&&Ve(3);u<Ze;++u)t[u]=i[Xe+u]}for(;u<We;++u)t[u]=t[u-V]}}e.l=h,e.p=U,e.b=u,e.f=f,h&&(f=1,e.m=v,e.d=m,e.n=g)}while(!f);return u!=t.length&&a?Nr(t,0,u):t.subarray(0,u)},lt=function(r,e,t){t<<=e&7;var i=e/8|0;r[i]|=t,r[i+1]|=t>>8},Mt=function(r,e,t){t<<=e&7;var i=e/8|0;r[i]|=t,r[i+1]|=t>>8,r[i+2]|=t>>16},$t=function(r,e){for(var t=[],i=0;i<r.length;++i)r[i]&&t.push({s:i,f:r[i]});var o=t.length,n=t.slice();if(!o)return{t:zr,l:0};if(o==1){var a=new Ie(t[0].s+1);return a[t[0].s]=1,{t:a,l:1}}t.sort(function(_,k){return _.f-k.f}),t.push({s:-1,f:25001});var s=t[0],c=t[1],p=0,f=1,l=2;for(t[0]={s:-1,f:s.f+c.f,l:s,r:c};f!=o-1;)s=t[t[p].f<t[l].f?p++:l++],c=t[p!=f&&t[p].f<t[l].f?p++:l++],t[f++]={s:-1,f:s.f+c.f,l:s,r:c};for(var u=n[0].s,i=1;i<o;++i)n[i].s>u&&(u=n[i].s);var h=new He(u+1),m=rr(t[f-1],h,0);if(m>e){var i=0,v=0,g=m-e,x=1<<g;for(n.sort(function(k,y){return h[y.s]-h[k.s]||k.f-y.f});i<o;++i){var w=n[i].s;if(h[w]>e)v+=x-(1<<m-h[w]),h[w]=e;else break}for(v>>=g;v>0;){var d=n[i].s;h[d]<e?v-=1<<e-h[d]++-1:++i}for(;i>=0&&v;--i){var b=n[i].s;h[b]==e&&(--h[b],++v)}m=e}return{t:new Ie(h),l:m}},rr=function(r,e,t){return r.s==-1?Math.max(rr(r.l,e,t+1),rr(r.r,e,t+1)):e[r.s]=t},br=function(r){for(var e=r.length;e&&!r[--e];);for(var t=new He(++e),i=0,o=r[0],n=1,a=function(c){t[i++]=c},s=1;s<=e;++s)if(r[s]==o&&s!=e)++n;else{if(!o&&n>2){for(;n>138;n-=138)a(32754);n>2&&(a(n>10?n-11<<5|28690:n-3<<5|12305),n=0)}else if(n>3){for(a(o),--n;n>6;n-=6)a(8304);n>2&&(a(n-3<<5|8208),n=0)}for(;n--;)a(o);n=1,o=r[s]}return{c:t.subarray(0,i),n:e}},Ft=function(r,e){for(var t=0,i=0;i<e.length;++i)t+=r[i]*e[i];return t},Lr=function(r,e,t){var i=t.length,o=ar(e+2);r[o]=i&255,r[o+1]=i>>8,r[o+2]=r[o]^255,r[o+3]=r[o+1]^255;for(var n=0;n<i;++n)r[o+n+4]=t[n];return(o+4+i)*8},_r=function(r,e,t,i,o,n,a,s,c,p,f){lt(e,f++,t),++o[256];for(var l=$t(o,15),u=l.t,h=l.l,m=$t(n,15),v=m.t,g=m.l,x=br(u),w=x.c,d=x.n,b=br(v),_=b.c,k=b.n,y=new He(19),A=0;A<w.length;++A)++y[w[A]&31];for(var A=0;A<_.length;++A)++y[_[A]&31];for(var W=$t(y,7),$=W.t,X=W.l,H=19;H>4&&!$[Kt[H-1]];--H);var Z=p+5<<3,C=Ft(o,vt)+Ft(n,Lt)+a,K=Ft(o,u)+Ft(n,v)+a+14+3*H+Ft(y,$)+2*y[16]+3*y[17]+7*y[18];if(c>=0&&Z<=C&&Z<=K)return Lr(e,f,r.subarray(c,c+p));var ee,z,Y,V;if(lt(e,f,1+(K<C)),f+=2,K<C){ee=at(u,h,0),z=u,Y=at(v,g,0),V=v;var P=at($,X,0);lt(e,f,d-257),lt(e,f+5,k-1),lt(e,f+10,H-4),f+=14;for(var A=0;A<H;++A)lt(e,f+3*A,$[Kt[A]]);f+=3*H;for(var I=[w,_],U=0;U<2;++U)for(var q=I[U],A=0;A<q.length;++A){var ue=q[A]&31;lt(e,f,P[ue]),f+=$[ue],ue>15&&(lt(e,f,q[A]>>5&127),f+=q[A]>>12)}}else ee=Dn,z=vt,Y=An,V=Lt;for(var A=0;A<s;++A){var se=i[A];if(se>255){var ue=se>>18&31;Mt(e,f,ee[ue+257]),f+=z[ue+257],ue>7&&(lt(e,f,se>>23&31),f+=Ut[ue]);var xe=se&31;Mt(e,f,Y[xe]),f+=V[xe],xe>3&&(Mt(e,f,se>>5&8191),f+=Vt[xe])}else Mt(e,f,ee[se]),f+=z[se]}return Mt(e,f,ee[256]),f+z[256]},Nn=new or([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),zr=new Ie(0),Ln=function(r,e,t,i,o,n){var a=n.z||r.length,s=new Ie(i+a+5*(1+Math.ceil(a/7e3))+o),c=s.subarray(i,s.length-o),p=n.l,f=(n.r||0)&7;if(e){f&&(c[0]=n.r>>3);for(var l=Nn[e-1],u=l>>13,h=l&8191,m=(1<<t)-1,v=n.p||new He(32768),g=n.h||new He(m+1),x=Math.ceil(t/3),w=2*x,d=function(st){return(r[st]^r[st+1]<<x^r[st+2]<<w)&m},b=new or(25e3),_=new He(288),k=new He(32),y=0,A=0,W=n.i||0,$=0,X=n.w||0,H=0;W+2<a;++W){var Z=d(W),C=W&32767,K=g[Z];if(v[C]=K,g[Z]=C,X<=W){var ee=a-W;if((y>7e3||$>24576)&&(ee>423||!p)){f=_r(r,c,0,b,_,k,A,$,H,W-H,f),$=y=A=0,H=W;for(var z=0;z<286;++z)_[z]=0;for(var z=0;z<30;++z)k[z]=0}var Y=2,V=0,P=h,I=C-K&32767;if(ee>2&&Z==d(W-I))for(var U=Math.min(u,ee)-1,q=Math.min(32767,W),ue=Math.min(258,ee);I<=q&&--P&&C!=K;){if(r[W+Y]==r[W+Y-I]){for(var se=0;se<ue&&r[W+se]==r[W+se-I];++se);if(se>Y){if(Y=se,V=I,se>U)break;for(var xe=Math.min(I,se-2),ke=0,z=0;z<xe;++z){var We=W-I+z&32767,Xe=v[We],Ze=We-Xe&32767;Ze>ke&&(ke=Ze,K=We)}}}C=K,K=v[C],I+=C-K&32767}if(V){b[$++]=268435456|er[Y]<<18|wr[V];var Te=er[Y]&31,Ge=wr[V]&31;A+=Ut[Te]+Vt[Ge],++_[257+Te],++k[Ge],X=W+Y,++y}else b[$++]=r[W],++_[r[W]]}}for(W=Math.max(W,X);W<a;++W)b[$++]=r[W],++_[r[W]];f=_r(r,c,p,b,_,k,A,$,H,W-H,f),p||(n.r=f&7|c[f/8|0]<<3,f-=7,n.h=g,n.p=v,n.i=W,n.w=X)}else{for(var W=n.w||0;W<a+p;W+=65535){var Ne=W+65535;Ne>=a&&(c[f/8|0]=p,Ne=a),f=Lr(c,f+1,r.subarray(W,Ne))}n.i=a}return Nr(s,0,i+ar(f)+o)},zn=function(r,e,t,i,o){if(!o&&(o={l:1},e.dictionary)){var n=e.dictionary.subarray(-32768),a=new Ie(n.length+r.length);a.set(n),a.set(r,n.length),r=a,o.w=n.length}return Ln(r,e.level==null?6:e.level,e.mem==null?o.l?Math.ceil(Math.max(8,Math.min(13,Math.log(r.length)))*1.5):20:12+e.mem,t,i,o)},Gn=function(r){(r[0]!=31||r[1]!=139||r[2]!=8)&&Ve(6,"invalid gzip data");var e=r[3],t=10;e&4&&(t+=(r[10]|r[11]<<8)+2);for(var i=(e>>3&1)+(e>>4&1);i>0;i-=!r[t++]);return t+(e&2)},Bn=function(r){var e=r.length;return(r[e-4]|r[e-3]<<8|r[e-2]<<16|r[e-1]<<24)>>>0},Cn=function(r,e){return((r[0]&15)!=8||r[0]>>4>7||(r[0]<<8|r[1])%31)&&Ve(6,"invalid zlib data"),(r[1]>>5&1)==1&&Ve(6,"invalid zlib data: "+(r[1]&32?"need":"unexpected")+" dictionary"),(r[1]>>3&4)+2};function Xn(r,e){return zn(r,e||{},0,0)}function Zn(r,e){return sr(r,{i:2},e,e)}function Yn(r,e){var t=Gn(r);return t+8>r.length&&Ve(6,"invalid gzip data"),sr(r.subarray(t,-8),{i:2},new Ie(Bn(r)),e)}function Un(r,e){return sr(r.subarray(Cn(r),-4),{i:2},e,e)}function Vn(r,e){return r[0]==31&&r[1]==139&&r[2]==8?Yn(r,e):(r[0]&15)!=8||r[0]>>4>7||(r[0]<<8|r[1])%31?Zn(r,e):Un(r,e)}var Hn=typeof TextDecoder<"u"&&new TextDecoder,Qn=0;try{Hn.decode(zr,{stream:!0}),Qn=1}catch{}const Gr=Object.freeze({struct:{id:"string",x:"i32",z:"i32",tiles:{array:{type:{struct:{pos:{struct:{x:"i32",z:"i32"}},abs:{struct:{x:"i32",z:"i32"}},noise:"f32",tile:"string"}}}},texture:{struct:{size:"i32",data:{array:{type:"u8"}}}}}}),Jn=r=>Xn(Mn(Gr,r),{level:9}),$n=r=>Fn(Gr,Vn(r)),xr={colorMap:[{level:-1,color:"#000022"},{level:-.95,color:"#000044"},{level:-.9,color:"#001f7f"},{level:-.85,color:"#002b9f"},{level:-.8,color:"#0037bf"},{level:-.75,color:"#0043df"},{level:-.7,color:"#0050ff"},{level:-.65,color:"#0062ff"},{level:-.6,color:"#0074ff"},{level:-.55,color:"#0086ff"},{level:-.5,color:"#0098ff"},{level:-.45,color:"#00aaff"},{level:-.4,color:"#11ccff"},{level:-.35,color:"#33ddff"},{level:-.3,color:"#55eeff"},{level:-.25,color:"#77ffff"},{level:-.2,color:"#ccdd77"},{level:-.15,color:"#eedd66"},{level:-.1,color:"#ffcc44"},{level:-.05,color:"#ffaa22"},{level:0,color:"#44dd44"},{level:.05,color:"#33cc33"},{level:.1,color:"#22bb22"},{level:.15,color:"#22aa22"},{level:.2,color:"#119911"},{level:.25,color:"#008800"},{level:.3,color:"#007700"},{level:.35,color:"#006600"},{level:.4,color:"#005500"},{level:.45,color:"#004c00"},{level:.5,color:"#004400"},{level:.55,color:"#003b00"},{level:.6,color:"#003300"},{level:.65,color:"#778822"},{level:.7,color:"#889933"},{level:.75,color:"#99aa22"},{level:.8,color:"#aaa833"},{level:.85,color:"#bbb844"},{level:.875,color:"#cccc55"},{level:.9,color:"#dddd66"},{level:.925,color:"#666677"},{level:.95,color:"#777788"},{level:.975,color:"#888899"},{level:.99,color:"#aaaaaa"},{level:1,color:"#ffffff"}]},qn=({value:r,defaultColor:e="#ff0000",levels:t})=>[...t].sort((o,n)=>n.level-o.level).find(({level:o})=>r>=o)?.color||e,Kn=({seed:r,plotCount:e,tile:t,scale:i=1,noise:o})=>{const n=1/(e*i),{land:a}=o({seed:r}),s=new Map(Array.from(xr.colorMap,({color:c})=>{const{r:p,g:f,b:l}=on(c);return[c,new Uint8Array([p,f,l,255])]}));return({x:c,z:p})=>{const f=e**2,l=new Array(f),u=new Uint8Array(f*4);for(let h=0;h<l.length;h++){const m=h%e,v=Math.floor(h/e),g=(c*e+h%e)*n,x=(p*e+Math.floor(h/e))*n,w=a(g,x),d=e-1-v;u.set(s.get(qn({value:w,levels:xr.colorMap})),(d*e+m)*4),l[h]={pos:{x:m,z:v},abs:{x:m+c*e,z:v+p*e},noise:w,tile:t.id}}return{id:`${c}:${p}`,x:c,z:p,tiles:l,texture:{size:e,data:u}}}};async function e0({id:r,seed:e,mapId:t,plotCount:i,level:o,x:n,z:a}){const s=Kn({plotCount:i,seed:e,scale:o,noise:({seed:p})=>({land:vn({seed:p})}),tile:{id:"grass"}}),c=`/chunk/${t}/${r}.bin`;return performance.mark(`chunkOf-${r}-start`),new Promise(p=>{kt(c).exists().then(f=>{(f?new Promise(l=>{l(void 0)}):nr(c,Jn(s({x:n,z:a})))).then(()=>{kt(c).arrayBuffer().then(l=>{p($n(new Uint8Array(l))),performance.mark(`chunkOf-${r}-end`),performance.measure(`chunkOf-${r}`,`chunkOf-${r}-start`,`chunkOf-${r}-end`)})})})})}rn.worker({chunkOf:e0});
