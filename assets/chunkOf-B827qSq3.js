var xr=r=>{throw TypeError(r)},kr=(r,e,t)=>e.has(r)||xr("Cannot "+t),me=(r,e,t)=>(kr(r,e,"read from private field"),t?t.call(r):e.get(r)),Ke=(r,e,t)=>e.has(r)?xr("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),Je=(r,e,t,i)=>(kr(r,e,"write to private field"),e.set(r,t),t);const Sr="KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIHUobil7aWYobj09PSIvIilyZXR1cm57cGFyZW50Om51bGwsbmFtZToiIn07Y29uc3QgZT1uLnNwbGl0KCIvIikuZmlsdGVyKGk9PmkubGVuZ3RoPjApO2lmKGUubGVuZ3RoPT09MCl0aHJvdyBFcnJvcigiSW52YWxpZCBwYXRoIik7Y29uc3QgYT1lW2UubGVuZ3RoLTFdLHI9Ii8iK2Uuc2xpY2UoMCwtMSkuam9pbigiLyIpO3JldHVybntuYW1lOmEscGFyZW50OnJ9fWFzeW5jIGZ1bmN0aW9uIHcobixlKXtjb25zdHtwYXJlbnQ6YSxuYW1lOnJ9PXUobik7aWYoYT09bnVsbClyZXR1cm4gYXdhaXQgbmF2aWdhdG9yLnN0b3JhZ2UuZ2V0RGlyZWN0b3J5KCk7Y29uc3QgaT1hLnNwbGl0KCIvIikuZmlsdGVyKHQ9PnQubGVuZ3RoPjApO3RyeXtsZXQgdD1hd2FpdCBuYXZpZ2F0b3Iuc3RvcmFnZS5nZXREaXJlY3RvcnkoKTtmb3IoY29uc3QgcyBvZiBpKXQ9YXdhaXQgdC5nZXREaXJlY3RvcnlIYW5kbGUocyx7Y3JlYXRlOmUuY3JlYXRlfSk7aWYoZS5pc0ZpbGUpcmV0dXJuIGF3YWl0IHQuZ2V0RmlsZUhhbmRsZShyLHtjcmVhdGU6ZS5jcmVhdGV9KX1jYXRjaCh0KXtpZih0Lm5hbWU9PT0iTm90Rm91bmRFcnJvciIpcmV0dXJuIG51bGw7dGhyb3cgdH19Y29uc3QgZj17fTtzZWxmLm9ubWVzc2FnZT1hc3luYyBuPT57dmFyIGk7Y29uc3R7ZXZ0VHlwZTplLGFyZ3M6YX09bi5kYXRhO2xldCByPWZbYS5maWxlSWRdO3RyeXtsZXQgdDtjb25zdCBzPVtdO2lmKGU9PT0icmVnaXN0ZXIiKXtjb25zdCBsPWF3YWl0IHcoYS5maWxlUGF0aCx7Y3JlYXRlOiEwLGlzRmlsZTohMH0pO2lmKGw9PW51bGwpdGhyb3cgRXJyb3IoYG5vdCBmb3VuZCBmaWxlOiAke2EuZmlsZUlkfWApO3I9YXdhaXQgbC5jcmVhdGVTeW5jQWNjZXNzSGFuZGxlKHttb2RlOmEubW9kZX0pLGZbYS5maWxlSWRdPXJ9ZWxzZSBpZihlPT09ImNsb3NlIilhd2FpdCByLmNsb3NlKCksZGVsZXRlIGZbYS5maWxlSWRdO2Vsc2UgaWYoZT09PSJ0cnVuY2F0ZSIpYXdhaXQgci50cnVuY2F0ZShhLm5ld1NpemUpO2Vsc2UgaWYoZT09PSJ3cml0ZSIpe2NvbnN0e2RhdGE6bCxvcHRzOm99PW4uZGF0YS5hcmdzO3Q9YXdhaXQgci53cml0ZShsLG8pfWVsc2UgaWYoZT09PSJyZWFkIil7Y29uc3R7b2Zmc2V0Omwsc2l6ZTpvfT1uLmRhdGEuYXJncyxnPW5ldyBVaW50OEFycmF5KG8pLGQ9YXdhaXQgci5yZWFkKGcse2F0Omx9KSxjPWcuYnVmZmVyO3Q9ZD09PW8/YzooKGk9Yy50cmFuc2Zlcik9PW51bGw/dm9pZCAwOmkuY2FsbChjLGQpKT8/Yy5zbGljZSgwLGQpLHMucHVzaCh0KX1lbHNlIGU9PT0iZ2V0U2l6ZSI/dD1hd2FpdCByLmdldFNpemUoKTplPT09ImZsdXNoIiYmYXdhaXQgci5mbHVzaCgpO3NlbGYucG9zdE1lc3NhZ2Uoe2V2dFR5cGU6ImNhbGxiYWNrIixjYklkOm4uZGF0YS5jYklkLHJldHVyblZhbDp0fSxzKX1jYXRjaCh0KXtjb25zdCBzPXQ7c2VsZi5wb3N0TWVzc2FnZSh7ZXZ0VHlwZToidGhyb3dFcnJvciIsY2JJZDpuLmRhdGEuY2JJZCxlcnJNc2c6cy5uYW1lKyI6ICIrcy5tZXNzYWdlK2AKYCtKU09OLnN0cmluZ2lmeShuLmRhdGEpfSl9fX0pKCk7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPW9wZnMtd29ya2VyLUY0UldscWNfLmpzLm1hcAo=",Br=r=>Uint8Array.from(atob(r),e=>e.charCodeAt(0)),cr=typeof self<"u"&&self.Blob&&new Blob([Br(Sr)],{type:"text/javascript;charset=utf-8"});function Cr(r){let e;try{if(e=cr&&(self.URL||self.webkitURL).createObjectURL(cr),!e)throw"";const t=new Worker(e,{name:r?.name});return t.addEventListener("error",()=>{(self.URL||self.webkitURL).revokeObjectURL(e)}),t}catch{return new Worker("data:text/javascript;base64,"+Sr,{name:r?.name})}finally{e&&(self.URL||self.webkitURL).revokeObjectURL(e)}}async function Zr(r,e,t){const i=Xr();return await i("register",{fileId:r,filePath:e,mode:t}),{read:async(o,n)=>await i("read",{fileId:r,offset:o,size:n}),write:async(o,n)=>await i("write",{fileId:r,data:o,opts:n},[ArrayBuffer.isView(o)?o.buffer:o]),close:async()=>await i("close",{fileId:r}),truncate:async o=>await i("truncate",{fileId:r,newSize:o}),getSize:async()=>await i("getSize",{fileId:r}),flush:async()=>await i("flush",{fileId:r})}}const Lt=[];let Qt=0;function Xr(){if(Lt.length<3){const e=r();return Lt.push(e),e}else{const e=Lt[Qt];return Qt=(Qt+1)%Lt.length,e}function r(){const e=new Cr;let t=0,i={};return e.onmessage=({data:o})=>{var n,s;o.evtType==="callback"?(n=i[o.cbId])==null||n.resolve(o.returnVal):o.evtType==="throwError"&&((s=i[o.cbId])==null||s.reject(Error(o.errMsg))),delete i[o.cbId]},async function(o,n,s=[]){t+=1;const a=new Promise((c,h)=>{i[t]={resolve:c,reject:h}});return e.postMessage({cbId:t,evtType:o,args:n},s),a}}}function Ut(r){if(r==="/")return{parent:null,name:""};const e=r.split("/").filter(o=>o.length>0);if(e.length===0)throw Error("Invalid path");const t=e[e.length-1],i="/"+e.slice(0,-1).join("/");return{name:t,parent:i}}async function dt(r,e){const{parent:t,name:i}=Ut(r);if(t==null)return await navigator.storage.getDirectory();const o=t.split("/").filter(n=>n.length>0);try{let n=await navigator.storage.getDirectory();for(const s of o)n=await n.getDirectoryHandle(s,{create:e.create});return e.isFile?await n.getFileHandle(i,{create:e.create}):await n.getDirectoryHandle(i,{create:e.create})}catch(n){if(n.name==="NotFoundError")return null;throw n}}async function Tr(r){const{parent:e,name:t}=Ut(r);if(e==null){const o=await navigator.storage.getDirectory();for await(const n of o.keys())await o.removeEntry(n,{recursive:!0});return}const i=await dt(e,{create:!1,isFile:!1});i!=null&&await i.removeEntry(t,{recursive:!0})}function Kt(r,e){return`${r}/${e}`.replace("//","/")}function _t(r){return new Mr(r)}var rt,Gt,Rt;const Yr=class Or{constructor(e){Ke(this,rt),Ke(this,Gt),Ke(this,Rt),Je(this,rt,e);const{parent:t,name:i}=Ut(e);Je(this,Gt,i),Je(this,Rt,t)}get kind(){return"dir"}get name(){return me(this,Gt)}get path(){return me(this,rt)}get parent(){return me(this,Rt)==null?null:_t(me(this,Rt))}async create(){return await dt(me(this,rt),{create:!0,isFile:!1}),_t(me(this,rt))}async exists(){return await dt(me(this,rt),{create:!1,isFile:!1})instanceof FileSystemDirectoryHandle}async remove(){for(const e of await this.children())try{await e.remove()}catch(t){console.warn(t)}try{await Tr(me(this,rt))}catch(e){console.warn(e)}}async children(){const e=await dt(me(this,rt),{create:!1,isFile:!1});if(e==null)return[];const t=[];for await(const i of e.values())t.push((i.kind==="file"?xt:_t)(Kt(me(this,rt),i.name)));return t}async copyTo(e){if(!await this.exists())throw Error(`dir ${this.path} not exists`);if(e instanceof Or){const t=await e.exists()?_t(Kt(e.path,this.name)):e;await t.create(),await Promise.all((await this.children()).map(i=>i.copyTo(t)));return}else if(e instanceof FileSystemDirectoryHandle){await Promise.all((await this.children()).map(async t=>{t.kind==="file"?await t.copyTo(await e.getFileHandle(t.name,{create:!0})):await t.copyTo(await e.getDirectoryHandle(t.name,{create:!0}))}));return}throw Error("Illegal target type")}async moveTo(e){await this.copyTo(e),await this.remove()}};rt=new WeakMap,Gt=new WeakMap,Rt=new WeakMap;let Mr=Yr;const lr=new Map;function xt(r,e="rw"){if(e==="rw"){const t=lr.get(r)??new Yt(r,e);return lr.set(r,t),t}return new Yt(r,e)}async function Xt(r,e,t={overwrite:!0}){if(e instanceof Yt){await Xt(r,await e.stream(),t);return}const i=await(r instanceof Yt?r:xt(r,"rw")).createWriter();try{if(t.overwrite&&await i.truncate(0),e instanceof ReadableStream){const o=e.getReader();for(;;){const{done:n,value:s}=await o.read();if(n)break;await i.write(s)}}else await i.write(e)}catch(o){throw o}finally{await i.close()}}let Ur=0;const Vr=()=>++Ur;var nt,Et,Bt,Dt,Ct,pt,Zt,Ft;const Hr=class Wr{constructor(e,t){Ke(this,nt),Ke(this,Et),Ke(this,Bt),Ke(this,Dt),Ke(this,Ct),Ke(this,pt,0),Ke(this,Zt,(()=>{let n=null;return()=>(Je(this,pt,me(this,pt)+1),n??(n=new Promise(async(s,a)=>{try{const c=await Zr(me(this,Ct),me(this,nt),me(this,Dt));s([c,async()=>{Je(this,pt,me(this,pt)-1),!(me(this,pt)>0)&&(n=null,await c.close())}])}catch(c){a(c)}})))})()),Ke(this,Ft,!1),Je(this,Ct,Vr()),Je(this,nt,e),Je(this,Dt,{r:"read-only",rw:"readwrite","rw-unsafe":"readwrite-unsafe"}[t]);const{parent:i,name:o}=Ut(e);if(i==null)throw Error("Invalid path");Je(this,Bt,o),Je(this,Et,i)}get kind(){return"file"}get path(){return me(this,nt)}get name(){return me(this,Bt)}get parent(){return me(this,Et)==null?null:_t(me(this,Et))}async createWriter(){if(me(this,Dt)==="read-only")throw Error("file is read-only");if(me(this,Ft))throw Error("Other writer have not been closed");Je(this,Ft,!0);const e=new TextEncoder,[t,i]=await me(this,Zt).call(this);let o=await t.getSize(),n=!1;return{write:async(s,a={})=>{if(n)throw Error("Writer is closed");const c=typeof s=="string"?e.encode(s):s,h=a.at??o,u=c.byteLength;return o=h+u,await t.write(c,{at:h})},truncate:async s=>{if(n)throw Error("Writer is closed");await t.truncate(s),o>s&&(o=s)},flush:async()=>{if(n)throw Error("Writer is closed");await t.flush()},close:async()=>{if(n)throw Error("Writer is closed");n=!0,Je(this,Ft,!1),await i()}}}async createReader(){const[e,t]=await me(this,Zt).call(this);let i=!1,o=0;return{read:async(n,s={})=>{if(i)throw Error("Reader is closed");const a=s.at??o,c=await e.read(a,n);return o=a+c.byteLength,c},getSize:async()=>{if(i)throw Error("Reader is closed");return await e.getSize()},close:async()=>{i||(i=!0,await t())}}}async text(){return new TextDecoder().decode(await this.arrayBuffer())}async arrayBuffer(){const e=await dt(me(this,nt),{create:!1,isFile:!0});return e==null?new ArrayBuffer(0):(await e.getFile()).arrayBuffer()}async stream(){const e=await this.getOriginFile();return e==null?new ReadableStream({pull:t=>{t.close()}}):e.stream()}async getOriginFile(){var e;return(e=await dt(me(this,nt),{create:!1,isFile:!0}))==null?void 0:e.getFile()}async getSize(){const e=await dt(me(this,nt),{create:!1,isFile:!0});return e==null?0:(await e.getFile()).size}async exists(){return await dt(me(this,nt),{create:!1,isFile:!0})instanceof FileSystemFileHandle}async remove(){if(me(this,pt))throw Error("exists unclosed reader/writer");await Tr(me(this,nt))}async copyTo(e){if(e instanceof Wr){if(e.path===this.path)return;await Xt(e.path,this);return}else if(e instanceof Mr){if(!await this.exists())throw Error(`file ${this.path} not exists`);return await this.copyTo(xt(Kt(e.path,this.name)))}else if(e instanceof FileSystemFileHandle){await(await this.stream()).pipeTo(await e.createWritable());return}throw Error("Illegal target type")}async moveTo(e){await this.copyTo(e),await this.remove()}};nt=new WeakMap,Et=new WeakMap,Bt=new WeakMap,Dt=new WeakMap,Ct=new WeakMap,pt=new WeakMap,Zt=new WeakMap,Ft=new WeakMap;let Yt=Hr;const Pr="/.opfs-tools-temp-dir";async function Rr(r){try{if(r.kind==="file"){if(!await r.exists())return!0;const e=await r.createWriter();await e.truncate(0),await e.close(),await r.remove()}else await r.remove();return!0}catch(e){return console.warn(e),!1}}function Qr(){setInterval(async()=>{for(const r of await _t(Pr).children()){const e=/^\d+-(\d+)$/.exec(r.name);(e==null||Date.now()-Number(e[1])>2592e5)&&await Rr(r)}},60*1e3)}const ur=[];let fr=!1;async function $r(){if(globalThis.localStorage==null)return;const r="OPFS_TOOLS_EXPIRES_TMP_FILES";fr||(fr=!0,globalThis.addEventListener("unload",()=>{ur.length!==0&&localStorage.setItem(r,`${localStorage.getItem(r)??""},${ur.join(",")}`)}));let e=localStorage.getItem(r)??"";for(const t of e.split(","))t.length!==0&&await Rr(xt(`${Pr}/${t}`))&&(e=e.replace(t,""));localStorage.setItem(r,e.replace(/,{2,}/g,","))}(async function(){var r;globalThis.__opfs_tools_tmpfile_init__!==!0&&(globalThis.__opfs_tools_tmpfile_init__=!0,!(globalThis.FileSystemDirectoryHandle==null||globalThis.FileSystemFileHandle==null||((r=globalThis.navigator)==null?void 0:r.storage.getDirectory)==null)&&(Qr(),await $r()))})();function Jr(r){if(r.__esModule)return r;var e=r.default;if(typeof e=="function"){var t=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(i){var o=Object.getOwnPropertyDescriptor(r,i);Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:function(){return r[i]}})}),t}var jt={exports:{}},qr={},Kr=Object.freeze({__proto__:null,default:qr}),vt=Jr(Kr);/**
 * workerpool.js
 * https://github.com/josdejong/workerpool
 *
 * Offload tasks to a pool of workers on node.js and in the browser.
 *
 * @version 9.2.0
 * @date    2024-10-11
 *
 * @license
 * Copyright (C) 2014-2022 Jos de Jong <wjosdejong@gmail.com>
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not
 * use this file except in compliance with the License. You may obtain a copy
 * of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 * License for the specific language governing permissions and limitations under
 * the License.
 */var en=jt.exports,hr;function tn(){return hr||(hr=1,function(r,e){(function(t,i){i(e)})(en,function(t){var i={},o={exports:{}};(function(O){var R=function(Q){return typeof Q<"u"&&Q.versions!=null&&Q.versions.node!=null&&Q+""=="[object process]"};O.exports.isNode=R,O.exports.platform=typeof process<"u"&&R(process)?"node":"browser";var D=O.exports.platform==="node"&&vt;O.exports.isMainThread=O.exports.platform==="node"?(!D||D.isMainThread)&&!process.connected:typeof Window<"u",O.exports.cpus=O.exports.platform==="browser"?self.navigator.hardwareConcurrency:vt.cpus().length})(o);var n=o.exports,s={},a;function c(){if(a)return s;a=1;function O(Q,ye){var S=this;if(!(this instanceof O))throw new SyntaxError("Constructor must be called with the new operator");if(typeof Q!="function")throw new SyntaxError("Function parameter handler(resolve, reject) missing");var be=[],he=[];this.resolved=!1,this.rejected=!1,this.pending=!0;var Pe=function(T,G){be.push(T),he.push(G)};this.then=function(E,T){return new O(function(G,re){var fe=E?R(E,G,re):G,Ge=T?R(T,G,re):re;Pe(fe,Ge)},S)};var ze=function(T){return S.resolved=!0,S.rejected=!1,S.pending=!1,be.forEach(function(G){G(T)}),Pe=function(re,fe){re(T)},ze=F=function(){},S},F=function(T){return S.resolved=!1,S.rejected=!0,S.pending=!1,he.forEach(function(G){G(T)}),Pe=function(re,fe){fe(T)},ze=F=function(){},S};this.cancel=function(){return ye?ye.cancel():F(new D),S},this.timeout=function(E){if(ye)ye.timeout(E);else{var T=setTimeout(function(){F(new oe("Promise timed out after "+E+" ms"))},E);S.always(function(){clearTimeout(T)})}return S},Q(function(E){ze(E)},function(E){F(E)})}function R(Q,ye,S){return function(be){try{var he=Q(be);he&&typeof he.then=="function"&&typeof he.catch=="function"?he.then(ye,S):ye(he)}catch(Pe){S(Pe)}}}O.prototype.catch=function(Q){return this.then(null,Q)},O.prototype.always=function(Q){return this.then(Q,Q)},O.prototype.finally=function(Q){var ye=this,S=function(){return new O(function(he){return he()}).then(Q).then(function(){return ye})};return this.then(S,S)},O.all=function(Q){return new O(function(ye,S){var be=Q.length,he=[];be?Q.forEach(function(Pe,ze){Pe.then(function(F){he[ze]=F,be--,be==0&&ye(he)},function(F){be=0,S(F)})}):ye(he)})},O.defer=function(){var Q={};return Q.promise=new O(function(ye,S){Q.resolve=ye,Q.reject=S}),Q};function D(Q){this.message=Q||"promise cancelled",this.stack=new Error().stack}D.prototype=new Error,D.prototype.constructor=Error,D.prototype.name="CancellationError",O.CancellationError=D;function oe(Q){this.message=Q||"timeout exceeded",this.stack=new Error().stack}return oe.prototype=new Error,oe.prototype.constructor=Error,oe.prototype.name="TimeoutError",O.TimeoutError=oe,s.Promise=O,s}function h(O,R){(R==null||R>O.length)&&(R=O.length);for(var D=0,oe=Array(R);D<R;D++)oe[D]=O[D];return oe}function u(O,R){var D=typeof Symbol<"u"&&O[Symbol.iterator]||O["@@iterator"];if(!D){if(Array.isArray(O)||(D=x(O))||R){D&&(O=D);var oe=0,Q=function(){};return{s:Q,n:function(){return oe>=O.length?{done:!0}:{done:!1,value:O[oe++]}},e:function(he){throw he},f:Q}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ye,S=!0,be=!1;return{s:function(){D=D.call(O)},n:function(){var he=D.next();return S=he.done,he},e:function(he){be=!0,ye=he},f:function(){try{S||D.return==null||D.return()}finally{if(be)throw ye}}}}function l(O,R,D){return(R=y(R))in O?Object.defineProperty(O,R,{value:D,enumerable:!0,configurable:!0,writable:!0}):O[R]=D,O}function f(O,R){var D=Object.keys(O);if(Object.getOwnPropertySymbols){var oe=Object.getOwnPropertySymbols(O);R&&(oe=oe.filter(function(Q){return Object.getOwnPropertyDescriptor(O,Q).enumerable})),D.push.apply(D,oe)}return D}function p(O){for(var R=1;R<arguments.length;R++){var D=arguments[R]!=null?arguments[R]:{};R%2?f(Object(D),!0).forEach(function(oe){l(O,oe,D[oe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(D)):f(Object(D)).forEach(function(oe){Object.defineProperty(O,oe,Object.getOwnPropertyDescriptor(D,oe))})}return O}function m(O,R){if(typeof O!="object"||!O)return O;var D=O[Symbol.toPrimitive];if(D!==void 0){var oe=D.call(O,R);if(typeof oe!="object")return oe;throw new TypeError("@@toPrimitive must return a primitive value.")}return(R==="string"?String:Number)(O)}function y(O){var R=m(O,"string");return typeof R=="symbol"?R:R+""}function v(O){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},v(O)}function x(O,R){if(O){if(typeof O=="string")return h(O,R);var D={}.toString.call(O).slice(8,-1);return D==="Object"&&O.constructor&&(D=O.constructor.name),D==="Map"||D==="Set"?Array.from(O):D==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(D)?h(O,R):void 0}}var g={exports:{}},d={},b;function _(){return b||(b=1,d.validateOptions=function(R,D,oe){if(R){var Q=R?Object.keys(R):[],ye=Q.find(function(be){return!D.includes(be)});if(ye)throw new Error('Object "'+oe+'" contains an unknown option "'+ye+'"');var S=D.find(function(be){return Object.prototype[be]&&!Q.includes(be)});if(S)throw new Error('Object "'+oe+'" contains an inherited option "'+S+'" which is not defined in the object itself but in its prototype. Only plain objects are allowed. Please remove the option from the prototype or override it with a value "undefined".');return R}},d.workerOptsNames=["credentials","name","type"],d.forkOptsNames=["cwd","detached","env","execPath","execArgv","gid","serialization","signal","killSignal","silent","stdio","uid","windowsVerbatimArguments","timeout"],d.workerThreadOptsNames=["argv","env","eval","execArgv","stdin","stdout","stderr","workerData","trackUnmanagedFds","transferList","resourceLimits","name"]),d}var k,w;function j(){return w||(w=1,k=`!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e="undefined"!=typeof globalThis?globalThis:e||self).worker=n()}(this,(function(){"use strict";function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}function n(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var t={};var r=function(e,n){this.message=e,this.transfer=n},o={};function i(e,n){var t=this;if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if("function"!=typeof e)throw new SyntaxError("Function parameter handler(resolve, reject) missing");var r=[],o=[];this.resolved=!1,this.rejected=!1,this.pending=!0;var a=function(e,n){r.push(e),o.push(n)};this.then=function(e,n){return new i((function(t,r){var o=e?u(e,t,r):t,i=n?u(n,t,r):r;a(o,i)}),t)};var f=function(e){return t.resolved=!0,t.rejected=!1,t.pending=!1,r.forEach((function(n){n(e)})),a=function(n,t){n(e)},f=d=function(){},t},d=function(e){return t.resolved=!1,t.rejected=!0,t.pending=!1,o.forEach((function(n){n(e)})),a=function(n,t){t(e)},f=d=function(){},t};this.cancel=function(){return n?n.cancel():d(new s),t},this.timeout=function(e){if(n)n.timeout(e);else{var r=setTimeout((function(){d(new c("Promise timed out after "+e+" ms"))}),e);t.always((function(){clearTimeout(r)}))}return t},e((function(e){f(e)}),(function(e){d(e)}))}function u(e,n,t){return function(r){try{var o=e(r);o&&"function"==typeof o.then&&"function"==typeof o.catch?o.then(n,t):n(o)}catch(e){t(e)}}}function s(e){this.message=e||"promise cancelled",this.stack=(new Error).stack}function c(e){this.message=e||"timeout exceeded",this.stack=(new Error).stack}return i.prototype.catch=function(e){return this.then(null,e)},i.prototype.always=function(e){return this.then(e,e)},i.prototype.finally=function(e){var n=this,t=function(){return new i((function(e){return e()})).then(e).then((function(){return n}))};return this.then(t,t)},i.all=function(e){return new i((function(n,t){var r=e.length,o=[];r?e.forEach((function(e,i){e.then((function(e){o[i]=e,0==--r&&n(o)}),(function(e){r=0,t(e)}))})):n(o)}))},i.defer=function(){var e={};return e.promise=new i((function(n,t){e.resolve=n,e.reject=t})),e},s.prototype=new Error,s.prototype.constructor=Error,s.prototype.name="CancellationError",i.CancellationError=s,c.prototype=new Error,c.prototype.constructor=Error,c.prototype.name="TimeoutError",i.TimeoutError=c,o.Promise=i,function(n){var t=r,i=o.Promise,u="__workerpool-cleanup__",s={exit:function(){}},c={addAbortListener:function(e){s.abortListeners.push(e)},emit:s.emit};if("undefined"!=typeof self&&"function"==typeof postMessage&&"function"==typeof addEventListener)s.on=function(e,n){addEventListener(e,(function(e){n(e.data)}))},s.send=function(e,n){n?postMessage(e,n):postMessage(e)};else{if("undefined"==typeof process)throw new Error("Script must be executed as a worker");var a;try{a=require("worker_threads")}catch(n){if("object"!==e(n)||null===n||"MODULE_NOT_FOUND"!==n.code)throw n}if(a&&null!==a.parentPort){var f=a.parentPort;s.send=f.postMessage.bind(f),s.on=f.on.bind(f),s.exit=process.exit.bind(process)}else s.on=process.on.bind(process),s.send=function(e){process.send(e)},s.on("disconnect",(function(){process.exit(1)})),s.exit=process.exit.bind(process)}function d(e){return Object.getOwnPropertyNames(e).reduce((function(n,t){return Object.defineProperty(n,t,{value:e[t],enumerable:!0})}),{})}function l(e){return e&&"function"==typeof e.then&&"function"==typeof e.catch}s.methods={},s.methods.run=function(e,n){var t=new Function("return ("+e+").apply(this, arguments);");return t.worker=c,t.apply(t,n)},s.methods.methods=function(){return Object.keys(s.methods)},s.terminationHandler=void 0,s.abortListenerTimeout=1e3,s.abortListeners=[],s.terminateAndExit=function(e){var n=function(){s.exit(e)};if(!s.terminationHandler)return n();var t=s.terminationHandler(e);return l(t)?(t.then(n,n),t):(n(),new i((function(e,n){n(new Error("Worker terminating"))})))},s.cleanup=function(e){if(!s.abortListeners.length)return s.send({id:e,method:u,error:d(new Error("Worker terminating"))}),new i((function(e){e()}));var n,t=s.abortListeners.map((function(e){return e()})),r=new i((function(e,t){n=setTimeout((function(){t(new Error("Timeout occured waiting for abort handler, killing worker"))}),s.abortListenerTimeout)})),o=i.all(t).then((function(){clearTimeout(n),s.abortListeners.length||(s.abortListeners=[])}),(function(){clearTimeout(n),s.exit()}));return i.all([o,r]).then((function(){s.send({id:e,method:u,error:null})}),(function(n){s.send({id:e,method:u,error:n?d(n):null})}))};var p=null;s.on("message",(function(e){if("__workerpool-terminate__"===e)return s.terminateAndExit(0);if(e.method===u)return s.cleanup(e.id);try{var n=s.methods[e.method];if(!n)throw new Error('Unknown method "'+e.method+'"');p=e.id;var r=n.apply(n,e.params);l(r)?r.then((function(n){n instanceof t?s.send({id:e.id,result:n.message,error:null},n.transfer):s.send({id:e.id,result:n,error:null}),p=null})).catch((function(n){s.send({id:e.id,result:null,error:d(n)}),p=null})):(r instanceof t?s.send({id:e.id,result:r.message,error:null},r.transfer):s.send({id:e.id,result:r,error:null}),p=null)}catch(n){s.send({id:e.id,result:null,error:d(n)})}})),s.register=function(e,n){if(e)for(var t in e)e.hasOwnProperty(t)&&(s.methods[t]=e[t],s.methods[t].worker=c);n&&(s.terminationHandler=n.onTerminate,s.abortListenerTimeout=n.abortListenerTimeout||1e3),s.send("ready")},s.emit=function(e){if(p){if(e instanceof t)return void s.send({id:p,isEvent:!0,payload:e.message},e.transfer);s.send({id:p,isEvent:!0,payload:e})}},n.add=s.register,n.emit=s.emit}(t),n(t)}));
//# sourceMappingURL=worker.min.js.map
`),k}var M;function J(){if(M)return g.exports;M=1;var O=c(),R=O.Promise,D=n,oe=_(),Q=oe.validateOptions,ye=oe.forkOptsNames,S=oe.workerThreadOptsNames,be=oe.workerOptsNames,he="__workerpool-terminate__",Pe="__workerpool-cleanup__";function ze(){var $=E();if(!$)throw new Error("WorkerPool: workerType = 'thread' is not supported, Node >= 11.7.0 required");return $}function F(){if(typeof Worker!="function"&&((typeof Worker>"u"?"undefined":v(Worker))!=="object"||typeof Worker.prototype.constructor!="function"))throw new Error("WorkerPool: Web Workers not supported")}function E(){try{return vt}catch($){if(v($)==="object"&&$!==null&&$.code==="MODULE_NOT_FOUND")return null;throw $}}function T(){if(D.platform==="browser"){if(typeof Blob>"u")throw new Error("Blob not supported by the browser");if(!window.URL||typeof window.URL.createObjectURL!="function")throw new Error("URL.createObjectURL not supported by the browser");var $=new Blob([j()],{type:"text/javascript"});return window.URL.createObjectURL($)}else return __dirname+"/worker.js"}function G($,ie){if(ie.workerType==="web")return F(),re($,ie.workerOpts,Worker);if(ie.workerType==="thread")return P=ze(),fe($,P,ie);if(ie.workerType==="process"||!ie.workerType)return Ge($,Xe(ie),vt);if(D.platform==="browser")return F(),re($,ie.workerOpts,Worker);var P=E();return P?fe($,P,ie):Ge($,Xe(ie),vt)}function re($,ie,P){Q(ie,be,"workerOpts");var ne=new P($,ie);return ne.isBrowserWorker=!0,ne.on=function(se,pe){this.addEventListener(se,function(ve){pe(ve.data)})},ne.send=function(se,pe){this.postMessage(se,pe)},ne}function fe($,ie,P){var ne,se;Q(P?.workerThreadOpts,S,"workerThreadOpts");var pe=new ie.Worker($,p({stdout:(ne=P?.emitStdStreams)!==null&&ne!==void 0?ne:!1,stderr:(se=P?.emitStdStreams)!==null&&se!==void 0?se:!1},P?.workerThreadOpts));return pe.isWorkerThread=!0,pe.send=function(ve,ce){this.postMessage(ve,ce)},pe.kill=function(){return this.terminate(),!0},pe.disconnect=function(){this.terminate()},P!=null&&P.emitStdStreams&&(pe.stdout.on("data",function(ve){return pe.emit("stdout",ve)}),pe.stderr.on("data",function(ve){return pe.emit("stderr",ve)})),pe}function Ge($,ie,P){Q(ie.forkOpts,ye,"forkOpts");var ne=P.fork($,ie.forkArgs,ie.forkOpts),se=ne.send;return ne.send=function(pe){return se.call(ne,pe)},ie.emitStdStreams&&(ne.stdout.on("data",function(pe){return ne.emit("stdout",pe)}),ne.stderr.on("data",function(pe){return ne.emit("stderr",pe)})),ne.isChildProcess=!0,ne}function Xe($){$=$||{};var ie=process.execArgv.join(" "),P=ie.indexOf("--inspect")!==-1,ne=ie.indexOf("--debug-brk")!==-1,se=[];return P&&(se.push("--inspect="+$.debugPort),ne&&se.push("--debug-brk")),process.execArgv.forEach(function(pe){pe.indexOf("--max-old-space-size")>-1&&se.push(pe)}),Object.assign({},$,{forkArgs:$.forkArgs,forkOpts:Object.assign({},$.forkOpts,{execArgv:($.forkOpts&&$.forkOpts.execArgv||[]).concat(se),stdio:$.emitStdStreams?"pipe":void 0})})}function He($){for(var ie=new Error(""),P=Object.keys($),ne=0;ne<P.length;ne++)ie[P[ne]]=$[P[ne]];return ie}function Qe($,ie){if(Object.keys($.processing).length===1){var P=Object.values($.processing)[0];P.options&&typeof P.options.on=="function"&&P.options.on(ie)}}function ft($,ie){var P=this,ne=ie||{};this.script=$||T(),this.worker=G(this.script,ne),this.debugPort=ne.debugPort,this.forkOpts=ne.forkOpts,this.forkArgs=ne.forkArgs,this.workerOpts=ne.workerOpts,this.workerThreadOpts=ne.workerThreadOpts,this.workerTerminateTimeout=ne.workerTerminateTimeout,$||(this.worker.ready=!0),this.requestQueue=[],this.worker.on("stdout",function(ce){Qe(P,{stdout:ce.toString()})}),this.worker.on("stderr",function(ce){Qe(P,{stderr:ce.toString()})}),this.worker.on("message",function(ce){if(!P.terminated)if(typeof ce=="string"&&ce==="ready")P.worker.ready=!0,pe();else{var Be=ce.id,Oe=P.processing[Be];if(Oe!==void 0&&(ce.isEvent?Oe.options&&typeof Oe.options.on=="function"&&Oe.options.on(ce.payload):(delete P.processing[Be],P.terminating===!0&&P.terminate(),ce.error?Oe.resolver.reject(He(ce.error)):Oe.resolver.resolve(ce.result))),ce.method===Pe){var Ye=P.tracking[ce.id];Ye!==void 0&&(ce.error?(clearTimeout(Ye.timeoutId),Ye.resolver.reject(He(ce.error))):(P.tracking&&clearTimeout(Ye.timeoutId),Ye.resolver.resolve(Ye.result))),delete P.tracking[Be]}}});function se(ce){P.terminated=!0;for(var Be in P.processing)P.processing[Be]!==void 0&&P.processing[Be].resolver.reject(ce);P.processing=Object.create(null)}function pe(){var ce=u(P.requestQueue.splice(0)),Be;try{for(ce.s();!(Be=ce.n()).done;){var Oe=Be.value;P.worker.send(Oe.message,Oe.transfer)}}catch(Ye){ce.e(Ye)}finally{ce.f()}}var ve=this.worker;this.worker.on("error",se),this.worker.on("exit",function(ce,Be){var Oe=`Workerpool Worker terminated Unexpectedly
`;Oe+="    exitCode: `"+ce+"`\n",Oe+="    signalCode: `"+Be+"`\n",Oe+="    workerpool.script: `"+P.script+"`\n",Oe+="    spawnArgs: `"+ve.spawnargs+"`\n",Oe+="    spawnfile: `"+ve.spawnfile+"`\n",Oe+="    stdout: `"+ve.stdout+"`\n",Oe+="    stderr: `"+ve.stderr+"`\n",se(new Error(Oe))}),this.processing=Object.create(null),this.tracking=Object.create(null),this.terminating=!1,this.terminated=!1,this.cleaning=!1,this.terminationHandler=null,this.lastId=0}return ft.prototype.methods=function(){return this.exec("methods")},ft.prototype.exec=function($,ie,P,ne){P||(P=R.defer());var se=++this.lastId;this.processing[se]={id:se,resolver:P,options:ne};var pe={message:{id:se,method:$,params:ie},transfer:ne&&ne.transfer};this.terminated?P.reject(new Error("Worker is terminated")):this.worker.ready?this.worker.send(pe.message,pe.transfer):this.requestQueue.push(pe);var ve=this;return P.promise.catch(function(ce){if(ce instanceof R.CancellationError||ce instanceof R.TimeoutError)return ve.tracking[se]={id:se,resolver:R.defer()},delete ve.processing[se],ve.tracking[se].resolver.promise=ve.tracking[se].resolver.promise.catch(function(Be){delete ve.tracking[se];var Oe=ve.terminateAndNotify(!0).then(function(){throw Be},function(Ye){throw Ye});return Oe}),ve.worker.send({id:se,method:Pe}),ve.tracking[se].timeoutId=setTimeout(function(){ve.tracking[se].resolver.reject(ce)},ve.workerTerminateTimeout),ve.tracking[se].resolver.promise;throw ce})},ft.prototype.busy=function(){return this.cleaning||Object.keys(this.processing).length>0},ft.prototype.terminate=function($,ie){var P=this;if($){for(var ne in this.processing)this.processing[ne]!==void 0&&this.processing[ne].resolver.reject(new Error("Worker terminated"));this.processing=Object.create(null)}for(var se=0,pe=Object.values(P.tracking);se<pe.length;se++){var ve=pe[se];clearTimeout(ve.timeoutId),ve.resolver.reject(new Error("Worker Terminating"))}if(P.tracking=Object.create(null),typeof ie=="function"&&(this.terminationHandler=ie),this.busy())this.terminating=!0;else{var ce=function(Ye){if(P.terminated=!0,P.cleaning=!1,P.worker!=null&&P.worker.removeAllListeners&&P.worker.removeAllListeners("message"),P.worker=null,P.terminating=!1,P.terminationHandler)P.terminationHandler(Ye,P);else if(Ye)throw Ye};if(this.worker)if(typeof this.worker.kill=="function"){if(this.worker.killed){ce(new Error("worker already killed!"));return}var Be=setTimeout(function(){P.worker&&P.worker.kill()},this.workerTerminateTimeout);this.worker.once("exit",function(){clearTimeout(Be),P.worker&&(P.worker.killed=!0),ce()}),this.worker.ready?this.worker.send(he):this.requestQueue.push({message:he}),this.cleaning=!0;return}else if(typeof this.worker.terminate=="function")this.worker.terminate(),this.worker.killed=!0;else throw new Error("Failed to terminate worker");ce()}},ft.prototype.terminateAndNotify=function($,ie){var P=R.defer();return ie&&P.promise.timeout(ie),this.terminate($,function(ne,se){ne?P.reject(ne):P.resolve(se)}),P.promise},g.exports=ft,g.exports._tryRequireWorkerThreads=E,g.exports._setupProcessWorker=Ge,g.exports._setupBrowserWorker=re,g.exports._setupWorkerThreadWorker=fe,g.exports.ensureWorkerThreads=ze,g.exports}var Z,H;function X(){if(H)return Z;H=1;var O=65535;Z=R;function R(){this.ports=Object.create(null),this.length=0}return R.prototype.nextAvailableStartingAt=function(D){for(;this.ports[D]===!0;)D++;if(D>=O)throw new Error("WorkerPool debug port limit reached: "+D+">= "+O);return this.ports[D]=!0,this.length++,D},R.prototype.releasePort=function(D){delete this.ports[D],this.length--},Z}var C,K;function ee(){if(K)return C;K=1;var O=c(),R=O.Promise,D=J(),oe=n,Q=X(),ye=new Q;function S(F,E){typeof F=="string"?this.script=F||null:(this.script=null,E=F),this.workers=[],this.tasks=[],E=E||{},this.forkArgs=Object.freeze(E.forkArgs||[]),this.forkOpts=Object.freeze(E.forkOpts||{}),this.workerOpts=Object.freeze(E.workerOpts||{}),this.workerThreadOpts=Object.freeze(E.workerThreadOpts||{}),this.debugPortStart=E.debugPortStart||43210,this.nodeWorker=E.nodeWorker,this.workerType=E.workerType||E.nodeWorker||"auto",this.maxQueueSize=E.maxQueueSize||1/0,this.workerTerminateTimeout=E.workerTerminateTimeout||1e3,this.onCreateWorker=E.onCreateWorker||function(){return null},this.onTerminateWorker=E.onTerminateWorker||function(){return null},this.emitStdStreams=E.emitStdStreams||!1,E&&"maxWorkers"in E?(be(E.maxWorkers),this.maxWorkers=E.maxWorkers):this.maxWorkers=Math.max((oe.cpus||4)-1,1),E&&"minWorkers"in E&&(E.minWorkers==="max"?this.minWorkers=this.maxWorkers:(he(E.minWorkers),this.minWorkers=E.minWorkers,this.maxWorkers=Math.max(this.minWorkers,this.maxWorkers)),this._ensureMinWorkers()),this._boundNext=this._next.bind(this),this.workerType==="thread"&&D.ensureWorkerThreads()}S.prototype.exec=function(F,E,T){if(E&&!Array.isArray(E))throw new TypeError('Array expected as argument "params"');if(typeof F=="string"){var G=R.defer();if(this.tasks.length>=this.maxQueueSize)throw new Error("Max queue size of "+this.maxQueueSize+" reached");var re=this.tasks,fe={method:F,params:E,resolver:G,timeout:null,options:T};re.push(fe);var Ge=G.promise.timeout;return G.promise.timeout=function(He){return re.indexOf(fe)!==-1?(fe.timeout=He,G.promise):Ge.call(G.promise,He)},this._next(),G.promise}else{if(typeof F=="function")return this.exec("run",[String(F),E],T);throw new TypeError('Function or string expected as argument "method"')}},S.prototype.proxy=function(){if(arguments.length>0)throw new Error("No arguments expected");var F=this;return this.exec("methods").then(function(E){var T={};return E.forEach(function(G){T[G]=function(){return F.exec(G,Array.prototype.slice.call(arguments))}}),T})},S.prototype._next=function(){if(this.tasks.length>0){var F=this._getWorker();if(F){var E=this,T=this.tasks.shift();if(T.resolver.promise.pending){var G=F.exec(T.method,T.params,T.resolver,T.options).then(E._boundNext).catch(function(){if(F.terminated)return E._removeWorker(F)}).then(function(){E._next()});typeof T.timeout=="number"&&G.timeout(T.timeout)}else E._next()}}},S.prototype._getWorker=function(){for(var F=this.workers,E=0;E<F.length;E++){var T=F[E];if(T.busy()===!1)return T}return F.length<this.maxWorkers?(T=this._createWorkerHandler(),F.push(T),T):null},S.prototype._removeWorker=function(F){var E=this;return ye.releasePort(F.debugPort),this._removeWorkerFromList(F),this._ensureMinWorkers(),new R(function(T,G){F.terminate(!1,function(re){E.onTerminateWorker({forkArgs:F.forkArgs,forkOpts:F.forkOpts,workerThreadOpts:F.workerThreadOpts,script:F.script}),re?G(re):T(F)})})},S.prototype._removeWorkerFromList=function(F){var E=this.workers.indexOf(F);E!==-1&&this.workers.splice(E,1)},S.prototype.terminate=function(F,E){var T=this;this.tasks.forEach(function(Xe){Xe.resolver.reject(new Error("Pool terminated"))}),this.tasks.length=0;var G=function(He){ye.releasePort(He.debugPort),this._removeWorkerFromList(He)},re=G.bind(this),fe=[],Ge=this.workers.slice();return Ge.forEach(function(Xe){var He=Xe.terminateAndNotify(F,E).then(re).always(function(){T.onTerminateWorker({forkArgs:Xe.forkArgs,forkOpts:Xe.forkOpts,workerThreadOpts:Xe.workerThreadOpts,script:Xe.script})});fe.push(He)}),R.all(fe)},S.prototype.stats=function(){var F=this.workers.length,E=this.workers.filter(function(T){return T.busy()}).length;return{totalWorkers:F,busyWorkers:E,idleWorkers:F-E,pendingTasks:this.tasks.length,activeTasks:E}},S.prototype._ensureMinWorkers=function(){if(this.minWorkers)for(var F=this.workers.length;F<this.minWorkers;F++)this.workers.push(this._createWorkerHandler())},S.prototype._createWorkerHandler=function(){var F=this.onCreateWorker({forkArgs:this.forkArgs,forkOpts:this.forkOpts,workerOpts:this.workerOpts,workerThreadOpts:this.workerThreadOpts,script:this.script})||{};return new D(F.script||this.script,{forkArgs:F.forkArgs||this.forkArgs,forkOpts:F.forkOpts||this.forkOpts,workerOpts:F.workerOpts||this.workerOpts,workerThreadOpts:F.workerThreadOpts||this.workerThreadOpts,debugPort:ye.nextAvailableStartingAt(this.debugPortStart),workerType:this.workerType,workerTerminateTimeout:this.workerTerminateTimeout,emitStdStreams:this.emitStdStreams})};function be(F){if(!Pe(F)||!ze(F)||F<1)throw new TypeError("Option maxWorkers must be an integer number >= 1")}function he(F){if(!Pe(F)||!ze(F)||F<0)throw new TypeError("Option minWorkers must be an integer number >= 0")}function Pe(F){return typeof F=="number"}function ze(F){return Math.round(F)==F}return C=S,C}var L={},Y,V;function W(){if(V)return Y;V=1;function O(R,D){this.message=R,this.transfer=D}return Y=O,Y}var I;function U(){return I||(I=1,function(O){var R=W(),D=c().Promise,oe="__workerpool-terminate__",Q="__workerpool-cleanup__",ye=1e3,S={exit:function(){}},be={addAbortListener:function(G){S.abortListeners.push(G)},emit:S.emit};if(typeof self<"u"&&typeof postMessage=="function"&&typeof addEventListener=="function")S.on=function(T,G){addEventListener(T,function(re){G(re.data)})},S.send=function(T,G){G?postMessage(T,G):postMessage(T)};else if(typeof process<"u"){var he;try{he=vt}catch(T){if(!(v(T)==="object"&&T!==null&&T.code==="MODULE_NOT_FOUND"))throw T}if(he&&he.parentPort!==null){var Pe=he.parentPort;S.send=Pe.postMessage.bind(Pe),S.on=Pe.on.bind(Pe),S.exit=process.exit.bind(process)}else S.on=process.on.bind(process),S.send=function(T){process.send(T)},S.on("disconnect",function(){process.exit(1)}),S.exit=process.exit.bind(process)}else throw new Error("Script must be executed as a worker");function ze(T){return Object.getOwnPropertyNames(T).reduce(function(G,re){return Object.defineProperty(G,re,{value:T[re],enumerable:!0})},{})}function F(T){return T&&typeof T.then=="function"&&typeof T.catch=="function"}S.methods={},S.methods.run=function(G,re){var fe=new Function("return ("+G+").apply(this, arguments);");return fe.worker=be,fe.apply(fe,re)},S.methods.methods=function(){return Object.keys(S.methods)},S.terminationHandler=void 0,S.abortListenerTimeout=ye,S.abortListeners=[],S.terminateAndExit=function(T){var G=function(){S.exit(T)};if(!S.terminationHandler)return G();var re=S.terminationHandler(T);return F(re)?(re.then(G,G),re):(G(),new D(function(fe,Ge){Ge(new Error("Worker terminating"))}))},S.cleanup=function(T){if(!S.abortListeners.length)return S.send({id:T,method:Q,error:ze(new Error("Worker terminating"))}),new D(function(Qe){Qe()});var G=function(){S.exit()},re=function(){S.abortListeners.length||(S.abortListeners=[])},fe=S.abortListeners.map(function(Qe){return Qe()}),Ge,Xe=new D(function(Qe,ft){Ge=setTimeout(function(){ft(new Error("Timeout occured waiting for abort handler, killing worker"))},S.abortListenerTimeout)}),He=D.all(fe).then(function(){clearTimeout(Ge),re()},function(){clearTimeout(Ge),G()});return D.all([He,Xe]).then(function(){S.send({id:T,method:Q,error:null})},function(Qe){S.send({id:T,method:Q,error:Qe?ze(Qe):null})})};var E=null;S.on("message",function(T){if(T===oe)return S.terminateAndExit(0);if(T.method===Q)return S.cleanup(T.id);try{var G=S.methods[T.method];if(G){E=T.id;var re=G.apply(G,T.params);F(re)?re.then(function(fe){fe instanceof R?S.send({id:T.id,result:fe.message,error:null},fe.transfer):S.send({id:T.id,result:fe,error:null}),E=null}).catch(function(fe){S.send({id:T.id,result:null,error:ze(fe)}),E=null}):(re instanceof R?S.send({id:T.id,result:re.message,error:null},re.transfer):S.send({id:T.id,result:re,error:null}),E=null)}else throw new Error('Unknown method "'+T.method+'"')}catch(fe){S.send({id:T.id,result:null,error:ze(fe)})}}),S.register=function(T,G){if(T)for(var re in T)T.hasOwnProperty(re)&&(S.methods[re]=T[re],S.methods[re].worker=be);G&&(S.terminationHandler=G.onTerminate,S.abortListenerTimeout=G.abortListenerTimeout||ye),S.send("ready")},S.emit=function(T){if(E){if(T instanceof R){S.send({id:E,isEvent:!0,payload:T.message},T.transfer);return}S.send({id:E,isEvent:!0,payload:T})}},O.add=S.register,O.emit=S.emit}(L)),L}var q=n.platform,ue=n.isMainThread,ae=n.cpus;function xe(O,R){var D=ee();return new D(O,R)}var ke=i.pool=xe;function Me(O,R){var D=U();D.add(O,R)}var Ce=i.worker=Me;function Ze(O){var R=U();R.emit(O)}var Te=i.workerEmit=Ze,Le=c(),Ie=Le.Promise,st=i.Promise=Ie,St=i.Transfer=W(),Tt=i.platform=q,at=i.isMainThread=ue,Ot=i.cpus=ae;t.Promise=st,t.Transfer=St,t.cpus=Ot,t.default=i,t.isMainThread=at,t.platform=Tt,t.pool=ke,t.worker=Ce,t.workerEmit=Te,Object.defineProperty(t,"__esModule",{value:!0})})}(jt,jt.exports)),jt.exports}var rn=tn();const $e=Object.freeze({Euclidean:"Euclidean",EuclideanSq:"EuclideanSq",Manhattan:"Manhattan",Hybrid:"Hybrid"}),Re=Object.freeze({CellValue:"CellValue",Distance:"Distance",Distance2:"Distance2",Distance2Add:"Distance2Add",Distance2Sub:"Distance2Sub",Distance2Mul:"Distance2Mul",Distance2Div:"Distance2Div"}),Ne=Object.freeze({OpenSimplex2:"OpenSimplex2",OpenSimplex2Reduced:"OpenSimplex2Reduced",BasicGrid:"BasicGrid"}),et=Object.freeze({None:"None",FBm:"FBm",Ridged:"Ridged",PingPong:"PingPong",DomainWarpProgressive:"DomainWarpProgressive",DomainWarpIndependent:"DomainWarpIndependent"}),it=[.130526192220052,.99144486137381,.38268343236509,.923879532511287,.608761429008721,.793353340291235,.793353340291235,.608761429008721,.923879532511287,.38268343236509,.99144486137381,.130526192220051,.99144486137381,-.130526192220051,.923879532511287,-.38268343236509,.793353340291235,-.60876142900872,.608761429008721,-.793353340291235,.38268343236509,-.923879532511287,.130526192220052,-.99144486137381,-.130526192220052,-.99144486137381,-.38268343236509,-.923879532511287,-.608761429008721,-.793353340291235,-.793353340291235,-.608761429008721,-.923879532511287,-.38268343236509,-.99144486137381,-.130526192220052,-.99144486137381,.130526192220051,-.923879532511287,.38268343236509,-.793353340291235,.608761429008721,-.608761429008721,.793353340291235,-.38268343236509,.923879532511287,-.130526192220052,.99144486137381,.130526192220052,.99144486137381,.38268343236509,.923879532511287,.608761429008721,.793353340291235,.793353340291235,.608761429008721,.923879532511287,.38268343236509,.99144486137381,.130526192220051,.99144486137381,-.130526192220051,.923879532511287,-.38268343236509,.793353340291235,-.60876142900872,.608761429008721,-.793353340291235,.38268343236509,-.923879532511287,.130526192220052,-.99144486137381,-.130526192220052,-.99144486137381,-.38268343236509,-.923879532511287,-.608761429008721,-.793353340291235,-.793353340291235,-.608761429008721,-.923879532511287,-.38268343236509,-.99144486137381,-.130526192220052,-.99144486137381,.130526192220051,-.923879532511287,.38268343236509,-.793353340291235,.608761429008721,-.608761429008721,.793353340291235,-.38268343236509,.923879532511287,-.130526192220052,.99144486137381,.130526192220052,.99144486137381,.38268343236509,.923879532511287,.608761429008721,.793353340291235,.793353340291235,.608761429008721,.923879532511287,.38268343236509,.99144486137381,.130526192220051,.99144486137381,-.130526192220051,.923879532511287,-.38268343236509,.793353340291235,-.60876142900872,.608761429008721,-.793353340291235,.38268343236509,-.923879532511287,.130526192220052,-.99144486137381,-.130526192220052,-.99144486137381,-.38268343236509,-.923879532511287,-.608761429008721,-.793353340291235,-.793353340291235,-.608761429008721,-.923879532511287,-.38268343236509,-.99144486137381,-.130526192220052,-.99144486137381,.130526192220051,-.923879532511287,.38268343236509,-.793353340291235,.608761429008721,-.608761429008721,.793353340291235,-.38268343236509,.923879532511287,-.130526192220052,.99144486137381,.130526192220052,.99144486137381,.38268343236509,.923879532511287,.608761429008721,.793353340291235,.793353340291235,.608761429008721,.923879532511287,.38268343236509,.99144486137381,.130526192220051,.99144486137381,-.130526192220051,.923879532511287,-.38268343236509,.793353340291235,-.60876142900872,.608761429008721,-.793353340291235,.38268343236509,-.923879532511287,.130526192220052,-.99144486137381,-.130526192220052,-.99144486137381,-.38268343236509,-.923879532511287,-.608761429008721,-.793353340291235,-.793353340291235,-.608761429008721,-.923879532511287,-.38268343236509,-.99144486137381,-.130526192220052,-.99144486137381,.130526192220051,-.923879532511287,.38268343236509,-.793353340291235,.608761429008721,-.608761429008721,.793353340291235,-.38268343236509,.923879532511287,-.130526192220052,.99144486137381,.130526192220052,.99144486137381,.38268343236509,.923879532511287,.608761429008721,.793353340291235,.793353340291235,.608761429008721,.923879532511287,.38268343236509,.99144486137381,.130526192220051,.99144486137381,-.130526192220051,.923879532511287,-.38268343236509,.793353340291235,-.60876142900872,.608761429008721,-.793353340291235,.38268343236509,-.923879532511287,.130526192220052,-.99144486137381,-.130526192220052,-.99144486137381,-.38268343236509,-.923879532511287,-.608761429008721,-.793353340291235,-.793353340291235,-.608761429008721,-.923879532511287,-.38268343236509,-.99144486137381,-.130526192220052,-.99144486137381,.130526192220051,-.923879532511287,.38268343236509,-.793353340291235,.608761429008721,-.608761429008721,.793353340291235,-.38268343236509,.923879532511287,-.130526192220052,.99144486137381,.38268343236509,.923879532511287,.923879532511287,.38268343236509,.923879532511287,-.38268343236509,.38268343236509,-.923879532511287,-.38268343236509,-.923879532511287,-.923879532511287,-.38268343236509,-.923879532511287,.38268343236509,-.38268343236509,.923879532511287],lt=[0,1,1,0,0,-1,1,0,0,1,-1,0,0,-1,-1,0,1,0,1,0,-1,0,1,0,1,0,-1,0,-1,0,-1,0,1,1,0,0,-1,1,0,0,1,-1,0,0,-1,-1,0,0,0,1,1,0,0,-1,1,0,0,1,-1,0,0,-1,-1,0,1,0,1,0,-1,0,1,0,1,0,-1,0,-1,0,-1,0,1,1,0,0,-1,1,0,0,1,-1,0,0,-1,-1,0,0,0,1,1,0,0,-1,1,0,0,1,-1,0,0,-1,-1,0,1,0,1,0,-1,0,1,0,1,0,-1,0,-1,0,-1,0,1,1,0,0,-1,1,0,0,1,-1,0,0,-1,-1,0,0,0,1,1,0,0,-1,1,0,0,1,-1,0,0,-1,-1,0,1,0,1,0,-1,0,1,0,1,0,-1,0,-1,0,-1,0,1,1,0,0,-1,1,0,0,1,-1,0,0,-1,-1,0,0,0,1,1,0,0,-1,1,0,0,1,-1,0,0,-1,-1,0,1,0,1,0,-1,0,1,0,1,0,-1,0,-1,0,-1,0,1,1,0,0,-1,1,0,0,1,-1,0,0,-1,-1,0,0,1,1,0,0,0,-1,1,0,-1,1,0,0,0,-1,-1,0],Ee=Object.freeze({OpenSimplex2:"OpenSimplex2",OpenSimplex2S:"OpenSimplex2S",Cellular:"Cellular",Perlin:"Perlin",ValueCubic:"ValueCubic",Value:"Value"}),z=501125321,N=1136930381,le=1720413743,de=[-.2700222198,-.9628540911,.3863092627,-.9223693152,.04444859006,-.999011673,-.5992523158,-.8005602176,-.7819280288,.6233687174,.9464672271,.3227999196,-.6514146797,-.7587218957,.9378472289,.347048376,-.8497875957,-.5271252623,-.879042592,.4767432447,-.892300288,-.4514423508,-.379844434,-.9250503802,-.9951650832,.0982163789,.7724397808,-.6350880136,.7573283322,-.6530343002,-.9928004525,-.119780055,-.0532665713,.9985803285,.9754253726,-.2203300762,-.7665018163,.6422421394,.991636706,.1290606184,-.994696838,.1028503788,-.5379205513,-.84299554,.5022815471,-.8647041387,.4559821461,-.8899889226,-.8659131224,-.5001944266,.0879458407,-.9961252577,-.5051684983,.8630207346,.7753185226,-.6315704146,-.6921944612,.7217110418,-.5191659449,-.8546734591,.8978622882,-.4402764035,-.1706774107,.9853269617,-.9353430106,-.3537420705,-.9992404798,.03896746794,-.2882064021,-.9575683108,-.9663811329,.2571137995,-.8759714238,-.4823630009,-.8303123018,-.5572983775,.05110133755,-.9986934731,-.8558373281,-.5172450752,.09887025282,.9951003332,.9189016087,.3944867976,-.2439375892,-.9697909324,-.8121409387,-.5834613061,-.9910431363,.1335421355,.8492423985,-.5280031709,-.9717838994,-.2358729591,.9949457207,.1004142068,.6241065508,-.7813392434,.662910307,.7486988212,-.7197418176,.6942418282,-.8143370775,-.5803922158,.104521054,-.9945226741,-.1065926113,-.9943027784,.445799684,-.8951327509,.105547406,.9944142724,-.992790267,.1198644477,-.8334366408,.552615025,.9115561563,-.4111755999,.8285544909,-.5599084351,.7217097654,-.6921957921,.4940492677,-.8694339084,-.3652321272,-.9309164803,-.9696606758,.2444548501,.08925509731,-.996008799,.5354071276,-.8445941083,-.1053576186,.9944343981,-.9890284586,.1477251101,.004856104961,.9999882091,.9885598478,.1508291331,.9286129562,-.3710498316,-.5832393863,-.8123003252,.3015207509,.9534596146,-.9575110528,.2883965738,.9715802154,-.2367105511,.229981792,.9731949318,.955763816,-.2941352207,.740956116,.6715534485,-.9971513787,-.07542630764,.6905710663,-.7232645452,-.290713703,-.9568100872,.5912777791,-.8064679708,-.9454592212,-.325740481,.6664455681,.74555369,.6236134912,.7817328275,.9126993851,-.4086316587,-.8191762011,.5735419353,-.8812745759,-.4726046147,.9953313627,.09651672651,.9855650846,-.1692969699,-.8495980887,.5274306472,.6174853946,-.7865823463,.8508156371,.52546432,.9985032451,-.05469249926,.1971371563,-.9803759185,.6607855748,-.7505747292,-.03097494063,.9995201614,-.6731660801,.739491331,-.7195018362,-.6944905383,.9727511689,.2318515979,.9997059088,-.0242506907,.4421787429,-.8969269532,.9981350961,-.061043673,-.9173660799,-.3980445648,-.8150056635,-.5794529907,-.8789331304,.4769450202,.0158605829,.999874213,-.8095464474,.5870558317,-.9165898907,-.3998286786,-.8023542565,.5968480938,-.5176737917,.8555780767,-.8154407307,-.5788405779,.4022010347,-.9155513791,-.9052556868,-.4248672045,.7317445619,.6815789728,-.5647632201,-.8252529947,-.8403276335,-.5420788397,-.9314281527,.363925262,.5238198472,.8518290719,.7432803869,-.6689800195,-.985371561,-.1704197369,.4601468731,.88784281,.825855404,.5638819483,.6182366099,.7859920446,.8331502863,-.553046653,.1500307506,.9886813308,-.662330369,-.7492119075,-.668598664,.743623444,.7025606278,.7116238924,-.5419389763,-.8404178401,-.3388616456,.9408362159,.8331530315,.5530425174,-.2989720662,-.9542618632,.2638522993,.9645630949,.124108739,-.9922686234,-.7282649308,-.6852956957,.6962500149,.7177993569,-.9183535368,.3957610156,-.6326102274,-.7744703352,-.9331891859,-.359385508,-.1153779357,-.9933216659,.9514974788,-.3076565421,-.08987977445,-.9959526224,.6678496916,.7442961705,.7952400393,-.6062947138,-.6462007402,-.7631674805,-.2733598753,.9619118351,.9669590226,-.254931851,-.9792894595,.2024651934,-.5369502995,-.8436138784,-.270036471,-.9628500944,-.6400277131,.7683518247,-.7854537493,-.6189203566,.06005905383,-.9981948257,-.02455770378,.9996984141,-.65983623,.751409442,-.6253894466,-.7803127835,-.6210408851,-.7837781695,.8348888491,.5504185768,-.1592275245,.9872419133,.8367622488,.5475663786,-.8675753916,-.4973056806,-.2022662628,-.9793305667,.9399189937,.3413975472,.9877404807,-.1561049093,-.9034455656,.4287028224,.1269804218,-.9919052235,-.3819600854,.924178821,.9754625894,.2201652486,-.3204015856,-.9472818081,-.9874760884,.1577687387,.02535348474,-.9996785487,.4835130794,-.8753371362,-.2850799925,-.9585037287,-.06805516006,-.99768156,-.7885244045,-.6150034663,.3185392127,-.9479096845,.8880043089,.4598351306,.6476921488,-.7619021462,.9820241299,.1887554194,.9357275128,-.3527237187,-.8894895414,.4569555293,.7922791302,.6101588153,.7483818261,.6632681526,-.7288929755,-.6846276581,.8729032783,-.4878932944,.8288345784,.5594937369,.08074567077,.9967347374,.9799148216,-.1994165048,-.580730673,-.8140957471,-.4700049791,-.8826637636,.2409492979,.9705377045,.9437816757,-.3305694308,-.8927998638,-.4504535528,-.8069622304,.5906030467,.06258973166,.9980393407,-.9312597469,.3643559849,.5777449785,.8162173362,-.3360095855,-.941858566,.697932075,-.7161639607,-.002008157227,-.9999979837,-.1827294312,-.9831632392,-.6523911722,.7578824173,-.4302626911,-.9027037258,-.9985126289,-.05452091251,-.01028102172,-.9999471489,-.4946071129,.8691166802,-.2999350194,.9539596344,.8165471961,.5772786819,.2697460475,.962931498,-.7306287391,-.6827749597,-.7590952064,-.6509796216,-.907053853,.4210146171,-.5104861064,-.8598860013,.8613350597,.5080373165,.5007881595,-.8655698812,-.654158152,.7563577938,-.8382755311,-.545246856,.6940070834,.7199681717,.06950936031,.9975812994,.1702942185,-.9853932612,.2695973274,.9629731466,.5519612192,-.8338697815,.225657487,-.9742067022,.4215262855,-.9068161835,.4881873305,-.8727388672,-.3683854996,-.9296731273,-.9825390578,.1860564427,.81256471,.5828709909,.3196460933,-.9475370046,.9570913859,.2897862643,-.6876655497,-.7260276109,-.9988770922,-.047376731,-.1250179027,.992154486,-.8280133617,.560708367,.9324863769,-.3612051451,.6394653183,.7688199442,-.01623847064,-.9998681473,-.9955014666,-.09474613458,-.81453315,.580117012,.4037327978,-.9148769469,.9944263371,.1054336766,-.1624711654,.9867132919,-.9949487814,-.100383875,-.6995302564,.7146029809,.5263414922,-.85027327,-.5395221479,.841971408,.6579370318,.7530729462,.01426758847,-.9998982128,-.6734383991,.7392433447,.639412098,-.7688642071,.9211571421,.3891908523,-.146637214,-.9891903394,-.782318098,.6228791163,-.5039610839,-.8637263605,-.7743120191,-.6328039957],te=[-.7292736885,-.6618439697,.1735581948,0,.790292081,-.5480887466,-.2739291014,0,.7217578935,.6226212466,-.3023380997,0,.565683137,-.8208298145,-.0790000257,0,.760049034,-.5555979497,-.3370999617,0,.3713945616,.5011264475,.7816254623,0,-.1277062463,-.4254438999,-.8959289049,0,-.2881560924,-.5815838982,.7607405838,0,.5849561111,-.662820239,-.4674352136,0,.3307171178,.0391653737,.94291689,0,.8712121778,-.4113374369,-.2679381538,0,.580981015,.7021915846,.4115677815,0,.503756873,.6330056931,-.5878203852,0,.4493712205,.601390195,.6606022552,0,-.6878403724,.09018890807,-.7202371714,0,-.5958956522,-.6469350577,.475797649,0,-.5127052122,.1946921978,-.8361987284,0,-.9911507142,-.05410276466,-.1212153153,0,-.2149721042,.9720882117,-.09397607749,0,-.7518650936,-.5428057603,.3742469607,0,.5237068895,.8516377189,-.02107817834,0,.6333504779,.1926167129,-.7495104896,0,-.06788241606,.3998305789,.9140719259,0,-.5538628599,-.4729896695,-.6852128902,0,-.7261455366,-.5911990757,.3509933228,0,-.9229274737,-.1782808786,.3412049336,0,-.6968815002,.6511274338,.3006480328,0,.9608044783,-.2098363234,-.1811724921,0,.06817146062,-.9743405129,.2145069156,0,-.3577285196,-.6697087264,-.6507845481,0,-.1868621131,.7648617052,-.6164974636,0,-.6541697588,.3967914832,.6439087246,0,.6993340405,-.6164538506,.3618239211,0,-.1546665739,.6291283928,.7617583057,0,-.6841612949,-.2580482182,-.6821542638,0,.5383980957,.4258654885,.7271630328,0,-.5026987823,-.7939832935,-.3418836993,0,.3202971715,.2834415347,.9039195862,0,.8683227101,-.0003762656404,-.4959995258,0,.791120031,-.08511045745,.6057105799,0,-.04011016052,-.4397248749,.8972364289,0,.9145119872,.3579346169,-.1885487608,0,-.9612039066,-.2756484276,.01024666929,0,.6510361721,-.2877799159,-.7023778346,0,-.2041786351,.7365237271,.644859585,0,-.7718263711,.3790626912,.5104855816,0,-.3060082741,-.7692987727,.5608371729,0,.454007341,-.5024843065,.7357899537,0,.4816795475,.6021208291,-.6367380315,0,.6961980369,-.3222197429,.641469197,0,-.6532160499,-.6781148932,.3368515753,0,.5089301236,-.6154662304,-.6018234363,0,-.1635919754,-.9133604627,-.372840892,0,.52408019,-.8437664109,.1157505864,0,.5902587356,.4983817807,-.6349883666,0,.5863227872,.494764745,.6414307729,0,.6779335087,.2341345225,.6968408593,0,.7177054546,-.6858979348,.120178631,0,-.5328819713,-.5205125012,.6671608058,0,-.8654874251,-.0700727088,-.4960053754,0,-.2861810166,.7952089234,.5345495242,0,-.04849529634,.9810836427,-.1874115585,0,-.6358521667,.6058348682,.4781800233,0,.6254794696,-.2861619734,.7258696564,0,-.2585259868,.5061949264,-.8227581726,0,.02136306781,.5064016808,-.8620330371,0,.200111773,.8599263484,.4695550591,0,.4743561372,.6014985084,-.6427953014,0,.6622993731,-.5202474575,-.5391679918,0,.08084972818,-.6532720452,.7527940996,0,-.6893687501,.0592860349,.7219805347,0,-.1121887082,-.9673185067,.2273952515,0,.7344116094,.5979668656,-.3210532909,0,.5789393465,-.2488849713,.7764570201,0,.6988182827,.3557169806,-.6205791146,0,-.8636845529,-.2748771249,-.4224826141,0,-.4247027957,-.4640880967,.777335046,0,.5257722489,-.8427017621,.1158329937,0,.9343830603,.316302472,-.1639543925,0,-.1016836419,-.8057303073,-.5834887393,0,-.6529238969,.50602126,-.5635892736,0,-.2465286165,-.9668205684,-.06694497494,0,-.9776897119,-.2099250524,-.007368825344,0,.7736893337,.5734244712,.2694238123,0,-.6095087895,.4995678998,.6155736747,0,.5794535482,.7434546771,.3339292269,0,-.8226211154,.08142581855,.5627293636,0,-.510385483,.4703667658,.7199039967,0,-.5764971849,-.07231656274,-.8138926898,0,.7250628871,.3949971505,-.5641463116,0,-.1525424005,.4860840828,-.8604958341,0,-.5550976208,-.4957820792,.667882296,0,-.1883614327,.9145869398,.357841725,0,.7625556724,-.5414408243,-.3540489801,0,-.5870231946,-.3226498013,-.7424963803,0,.3051124198,.2262544068,-.9250488391,0,.6379576059,.577242424,-.5097070502,0,-.5966775796,.1454852398,-.7891830656,0,-.658330573,.6555487542,-.3699414651,0,.7434892426,.2351084581,.6260573129,0,.5562114096,.8264360377,-.0873632843,0,-.3028940016,-.8251527185,.4768419182,0,.1129343818,-.985888439,-.1235710781,0,.5937652891,-.5896813806,.5474656618,0,.6757964092,-.5835758614,-.4502648413,0,.7242302609,-.1152719764,.6798550586,0,-.9511914166,.0753623979,-.2992580792,0,.2539470961,-.1886339355,.9486454084,0,.571433621,-.1679450851,-.8032795685,0,-.06778234979,.3978269256,.9149531629,0,.6074972649,.733060024,-.3058922593,0,-.5435478392,.1675822484,.8224791405,0,-.5876678086,-.3380045064,-.7351186982,0,-.7967562402,.04097822706,-.6029098428,0,-.1996350917,.8706294745,.4496111079,0,-.02787660336,-.9106232682,-.4122962022,0,-.7797625996,-.6257634692,.01975775581,0,-.5211232846,.7401644346,-.4249554471,0,.8575424857,.4053272873,-.3167501783,0,.1045223322,.8390195772,-.5339674439,0,.3501822831,.9242524096,-.1520850155,0,.1987849858,.07647613266,.9770547224,0,.7845996363,.6066256811,-.1280964233,0,.09006737436,-.9750989929,-.2026569073,0,-.8274343547,-.542299559,.1458203587,0,-.3485797732,-.415802277,.840000362,0,-.2471778936,-.7304819962,-.6366310879,0,-.3700154943,.8577948156,.3567584454,0,.5913394901,-.548311967,-.5913303597,0,.1204873514,-.7626472379,-.6354935001,0,.616959265,.03079647928,.7863922953,0,.1258156836,-.6640829889,-.7369967419,0,-.6477565124,-.1740147258,-.7417077429,0,.6217889313,-.7804430448,-.06547655076,0,.6589943422,-.6096987708,.4404473475,0,-.2689837504,-.6732403169,-.6887635427,0,-.3849775103,.5676542638,.7277093879,0,.5754444408,.8110471154,-.1051963504,0,.9141593684,.3832947817,.131900567,0,-.107925319,.9245493968,.3654593525,0,.377977089,.3043148782,.8743716458,0,-.2142885215,-.8259286236,.5214617324,0,.5802544474,.4148098596,-.7008834116,0,-.1982660881,.8567161266,-.4761596756,0,-.03381553704,.3773180787,-.9254661404,0,-.6867922841,-.6656597827,.2919133642,0,.7731742607,-.2875793547,-.5652430251,0,-.09655941928,.9193708367,-.3813575004,0,.2715702457,-.9577909544,-.09426605581,0,.2451015704,-.6917998565,-.6792188003,0,.977700782,-.1753855374,.1155036542,0,-.5224739938,.8521606816,.02903615945,0,-.7734880599,-.5261292347,.3534179531,0,-.7134492443,-.269547243,.6467878011,0,.1644037271,.5105846203,-.8439637196,0,.6494635788,.05585611296,.7583384168,0,-.4711970882,.5017280509,-.7254255765,0,-.6335764307,-.2381686273,-.7361091029,0,-.9021533097,-.270947803,-.3357181763,0,-.3793711033,.872258117,.3086152025,0,-.6855598966,-.3250143309,.6514394162,0,.2900942212,-.7799057743,-.5546100667,0,-.2098319339,.85037073,.4825351604,0,-.4592603758,.6598504336,-.5947077538,0,.8715945488,.09616365406,-.4807031248,0,-.6776666319,.7118504878,-.1844907016,0,.7044377633,.312427597,.637304036,0,-.7052318886,-.2401093292,-.6670798253,0,.081921007,-.7207336136,-.6883545647,0,-.6993680906,-.5875763221,-.4069869034,0,-.1281454481,.6419895885,.7559286424,0,-.6337388239,-.6785471501,-.3714146849,0,.5565051903,-.2168887573,-.8020356851,0,-.5791554484,.7244372011,-.3738578718,0,.1175779076,-.7096451073,.6946792478,0,-.6134619607,.1323631078,.7785527795,0,.6984635305,-.02980516237,-.715024719,0,.8318082963,-.3930171956,.3919597455,0,.1469576422,.05541651717,-.9875892167,0,.708868575,-.2690503865,.6520101478,0,.2726053183,.67369766,-.68688995,0,-.6591295371,.3035458599,-.6880466294,0,.4815131379,-.7528270071,.4487723203,0,.9430009463,.1675647412,-.2875261255,0,.434802957,.7695304522,-.4677277752,0,.3931996188,.594473625,.7014236729,0,.7254336655,-.603925654,.3301814672,0,.7590235227,-.6506083235,.02433313207,0,-.8552768592,-.3430042733,.3883935666,0,-.6139746835,.6981725247,.3682257648,0,-.7465905486,-.5752009504,.3342849376,0,.5730065677,.810555537,-.1210916791,0,-.9225877367,-.3475211012,-.167514036,0,-.7105816789,-.4719692027,-.5218416899,0,-.08564609717,.3583001386,.929669703,0,-.8279697606,-.2043157126,.5222271202,0,.427944023,.278165994,.8599346446,0,.5399079671,-.7857120652,-.3019204161,0,.5678404253,-.5495413974,-.6128307303,0,-.9896071041,.1365639107,-.04503418428,0,-.6154342638,-.6440875597,.4543037336,0,.1074204368,-.7946340692,.5975094525,0,-.3595449969,-.8885529948,.28495784,0,-.2180405296,.1529888965,.9638738118,0,-.7277432317,-.6164050508,-.3007234646,0,.7249729114,-.00669719484,.6887448187,0,-.5553659455,-.5336586252,.6377908264,0,.5137558015,.7976208196,-.3160000073,0,-.3794024848,.9245608561,-.03522751494,0,.8229248658,.2745365933,-.4974176556,0,-.5404114394,.6091141441,.5804613989,0,.8036581901,-.2703029469,.5301601931,0,.6044318879,.6832968393,.4095943388,0,.06389988817,.9658208605,-.2512108074,0,.1087113286,.7402471173,-.6634877936,0,-.713427712,-.6926784018,.1059128479,0,.6458897819,-.5724548511,-.5050958653,0,-.6553931414,.7381471625,.159995615,0,.3910961323,.9188871375,-.05186755998,0,-.4879022471,-.5904376907,.6429111375,0,.6014790094,.7707441366,-.2101820095,0,-.5677173047,.7511360995,.3368851762,0,.7858573506,.226674665,.5753666838,0,-.4520345543,-.604222686,-.6561857263,0,.002272116345,.4132844051,-.9105991643,0,-.5815751419,-.5162925989,.6286591339,0,-.03703704785,.8273785755,.5604221175,0,-.5119692504,.7953543429,-.3244980058,0,-.2682417366,-.9572290247,-.1084387619,0,-.2322482736,-.9679131102,-.09594243324,0,.3554328906,-.8881505545,.2913006227,0,.7346520519,-.4371373164,.5188422971,0,.9985120116,.04659011161,-.02833944577,0,-.3727687496,-.9082481361,.1900757285,0,.91737377,-.3483642108,.1925298489,0,.2714911074,.4147529736,-.8684886582,0,.5131763485,-.7116334161,.4798207128,0,-.8737353606,.18886992,-.4482350644,0,.8460043821,-.3725217914,.3814499973,0,.8978727456,-.1780209141,-.4026575304,0,.2178065647,-.9698322841,-.1094789531,0,-.1518031304,-.7788918132,-.6085091231,0,-.2600384876,-.4755398075,-.8403819825,0,.572313509,-.7474340931,-.3373418503,0,-.7174141009,.1699017182,-.6756111411,0,-.684180784,.02145707593,-.7289967412,0,-.2007447902,.06555605789,-.9774476623,0,-.1148803697,-.8044887315,.5827524187,0,-.7870349638,.03447489231,.6159443543,0,-.2015596421,.6859872284,.6991389226,0,-.08581082512,-.10920836,-.9903080513,0,.5532693395,.7325250401,-.396610771,0,-.1842489331,-.9777375055,-.1004076743,0,.0775473789,-.9111505856,.4047110257,0,.1399838409,.7601631212,-.6344734459,0,.4484419361,-.845289248,.2904925424,0],Mt=Object.freeze({None:"None",ImproveXYPlanes:"ImproveXYPlanes",ImproveXZPlanes:"ImproveXZPlanes"}),Se=Object.freeze({None:"None",ImproveXYPlanes:"ImproveXYPlanes",ImproveXZPlanes:"ImproveXZPlanes",DefaultOpenSimplex2:"DefaultOpenSimplex2"});class gt{x;y;constructor(e,t){this.x=e,this.y=t}}class wt{x;y;z;constructor(e,t,i){this.x=e,this.y=t,this.z=i}}const ge=(r,e,t,i,o)=>{const n=i-t-(r-e);return o*o*o*n+o*o*(r-e-n)+o*(t-r)+e},Fe=(r,e,t)=>{let i=r^e^t;return i=Math.imul(i,668265261),i},De=(r,e,t,i,o)=>{let n=Fe(r,e,t);n^=n>>15,n&=254;const s=it[n],a=it[n|1];return i*s+o*a},je=(r,e,t,i)=>{let o=r^e^t^i;return o=Math.imul(o,668265261),o},we=(r,e,t,i,o,n,s)=>{let a=je(r,e,t,i);a^=a>>15,a&=252;const c=lt[a],h=lt[a|1],u=lt[a|2];return o*c+n*h+s*u},tt=r=>r*r*(3-2*r),At=r=>r*r*r*(r*(r*6-15)+10),B=(r,e,t)=>r+t*(e-r),pr=r=>(r-=Math.trunc(r*.5)*2,r<1?r:2-r),nn=(r,e,t)=>{let i=Math.floor(e),o=Math.floor(t);const n=e-i,s=t-o,a=n-1,c=s-1,h=At(n),u=At(s);i=Math.imul(i,z),o=Math.imul(o,N);const l=i+z,f=o+N,p=B(De(r,i,o,n,s),De(r,l,o,a,s),h),m=B(De(r,i,f,n,c),De(r,l,f,a,c),h);return B(p,m,u)*1.4247691104677813},We=(r,e,t)=>{let i=Fe(r,e,t);return i=Math.imul(i,i),i^=i<<19,i*(1/2147483648)},A=(r,e,t,i)=>{let o=je(r,e,t,i);return o=Math.imul(o,o),o^=o<<19,o*(1/2147483648)};class It{_Seed;_Frequency=.01;_NoiseType=Ee.OpenSimplex2;_RotationType3D=Mt.None;_TransformType3D=Se.DefaultOpenSimplex2;_DomainWarpAmp=1;_FractalType=et.None;_Octaves=3;_Lacunarity=2;_Gain=.5;_WeightedStrength=0;_PingPongStrength=2;_FractalBounding=1/1.75;_CellularDistanceFunction=$e.EuclideanSq;_CellularReturnType=Re.Distance;_CellularJitterModifier=1;_DomainWarpType=Ne.OpenSimplex2;_WarpTransformType3D=Se.DefaultOpenSimplex2;static NoiseType=Ee;static FractalType=et;static CellularDistanceFunction=$e;static CellularReturnType=Re;static DomainWarpType=Ne;constructor(e){this._Seed=e}SetFrequency(e){this._Frequency=e}SetNoiseType(e){this._NoiseType=e,this._UpdateTransformType3D()}SetRotationType3D(e){this._RotationType3D=e,this._UpdateTransformType3D(),this._UpdateWarpTransformType3D()}SetFractalType(e){this._FractalType=e}SetFractalOctaves(e){this._Octaves=e,this._CalculateFractalBounding()}SetFractalLacunarity(e){this._Lacunarity=e}SetFractalGain(e){this._Gain=e,this._CalculateFractalBounding()}SetFractalWeightedStrength(e){this._WeightedStrength=e}SetFractalPingPongStrength(e){this._PingPongStrength=e}SetCellularDistanceFunction(e){this._CellularDistanceFunction=e}SetCellularReturnType(e){this._CellularReturnType=e}SetCellularJitter(e){this._CellularJitterModifier=e}SetDomainWarpType(e){this._DomainWarpType=e,this._UpdateWarpTransformType3D()}SetDomainWarpAmp(e){this._DomainWarpAmp=e}GetNoise(e,t,i){const o=(s,a)=>{switch(s*=this._Frequency,a*=this._Frequency,this._NoiseType){case Ee.OpenSimplex2:case Ee.OpenSimplex2S:{const h=.5*(1.7320508075688772-1),u=(s+a)*h;s+=u,a+=u;break}}switch(this._FractalType){case et.FBm:return this._GenFractalFBmR2(s,a);case et.Ridged:return this._GenFractalRidgedR2(s,a);case et.PingPong:return this._GenFractalPingPongR2(s,a);default:return this._GenNoiseSingleR2(this._Seed,s,a)}},n=(s,a,c)=>{switch(s*=this._Frequency,a*=this._Frequency,c*=this._Frequency,this._TransformType3D){case Se.ImproveXYPlanes:{const h=s+a,u=h*-.211324865405187;c*=.577350269189626,s+=u-c,a+=u-c,c+=h*.577350269189626;break}case Se.ImproveXZPlanes:{const h=s+c,u=h*-.211324865405187;a*=.577350269189626,s+=u-a,c+=u-a,a+=h*.577350269189626;break}case Se.DefaultOpenSimplex2:{const u=(s+a+c)*.6666666666666666;s=u-s,a=u-a,c=u-c;break}}switch(this._FractalType){case et.FBm:return this._GenFractalFBmR3(s,a,c);case et.Ridged:return this._GenFractalRidgedR3(s,a,c);case et.PingPong:return this._GenFractalPingPongR3(s,a,c);default:return this._GenNoiseSingleR3(this._Seed,s,a,c)}};return arguments.length===2?o(e,t):arguments.length===3&&i!==void 0?n(e,t,i):0}DomainWrap(e){switch(this._FractalType){case et.DomainWarpProgressive:this._DomainWarpFractalProgressive(e);break;case et.DomainWarpIndependent:this._DomainWarpFractalIndependent(e);break;default:this._DomainWarpSingle(e);break}}_CalculateFractalBounding(){const e=Math.abs(this._Gain);let t=e,i=1;for(let o=1;o<this._Octaves;o++)i+=t,t*=e;this._FractalBounding=1/i}_GenNoiseSingleR2(e,t,i){switch(this._NoiseType){case Ee.OpenSimplex2:return this._SingleOpenSimplex2R2(e,t,i);case Ee.OpenSimplex2S:return this._SingleOpenSimplex2SR2(e,t,i);case Ee.Cellular:return this._SingleCellularR2(e,t,i);case Ee.Perlin:return nn(e,t,i);case Ee.ValueCubic:return this._SingleValueCubicR2(e,t,i);case Ee.Value:return this._SingleValueR2(e,t,i);default:return 0}}_GenNoiseSingleR3(e,t,i,o){switch(this._NoiseType){case Ee.OpenSimplex2:return this._SingleOpenSimplex2R3(e,t,i,o);case Ee.OpenSimplex2S:return this._SingleOpenSimplex2SR3(e,t,i,o);case Ee.Cellular:return this._SingleCellularR3(e,t,i,o);case Ee.Perlin:return this._SinglePerlinR3(e,t,i,o);case Ee.ValueCubic:return this._SingleValueCubicR3(e,t,i,o);case Ee.Value:return this._SingleValueR3(e,t,i,o);default:return 0}}_UpdateTransformType3D(){switch(this._RotationType3D){case Mt.ImproveXYPlanes:this._TransformType3D=Se.ImproveXYPlanes;break;case Mt.ImproveXZPlanes:this._TransformType3D=Se.ImproveXZPlanes;break;default:switch(this._NoiseType){case Ee.OpenSimplex2:case Ee.OpenSimplex2S:this._TransformType3D=Se.DefaultOpenSimplex2;break;default:this._TransformType3D=Se.None;break}break}}_UpdateWarpTransformType3D(){switch(this._RotationType3D){case Mt.ImproveXYPlanes:this._WarpTransformType3D=Se.ImproveXYPlanes;break;case Mt.ImproveXZPlanes:this._WarpTransformType3D=Se.ImproveXZPlanes;break;default:switch(this._DomainWarpType){case Ne.OpenSimplex2:case Ne.OpenSimplex2Reduced:this._WarpTransformType3D=Se.DefaultOpenSimplex2;break;default:this._WarpTransformType3D=Se.None;break}break}}_GenFractalFBmR2(e,t){let i=this._Seed,o=0,n=this._FractalBounding;for(let s=0;s<this._Octaves;s++){const a=this._GenNoiseSingleR2(i++,e,t);o+=a*n,n*=B(1,Math.min(a+1,2)*.5,this._WeightedStrength),e*=this._Lacunarity,t*=this._Lacunarity,n*=this._Gain}return o}_GenFractalFBmR3(e,t,i){let o=this._Seed,n=0,s=this._FractalBounding;for(let a=0;a<this._Octaves;a++){const c=this._GenNoiseSingleR3(o++,e,t,i);n+=c*s,s*=B(1,(c+1)*.5,this._WeightedStrength),e*=this._Lacunarity,t*=this._Lacunarity,i*=this._Lacunarity,s*=this._Gain}return n}_GenFractalRidgedR2(e,t){let i=this._Seed,o=0,n=this._FractalBounding;for(let s=0;s<this._Octaves;s++){const a=Math.abs(this._GenNoiseSingleR2(i++,e,t));o+=(a*-2+1)*n,n*=B(1,1-a,this._WeightedStrength),e*=this._Lacunarity,t*=this._Lacunarity,n*=this._Gain}return o}_GenFractalRidgedR3(e,t,i){let o=this._Seed,n=0,s=this._FractalBounding;for(let a=0;a<this._Octaves;a++){const c=Math.abs(this._GenNoiseSingleR3(o++,e,t,i));n+=(c*-2+1)*s,s*=B(1,1-c,this._WeightedStrength),e*=this._Lacunarity,t*=this._Lacunarity,i*=this._Lacunarity,s*=this._Gain}return n}_GenFractalPingPongR2(e,t){let i=this._Seed,o=0,n=this._FractalBounding;for(let s=0;s<this._Octaves;s++){const a=pr((this._GenNoiseSingleR2(i++,e,t)+1)*this._PingPongStrength);o+=(a-.5)*2*n,n*=B(1,a,this._WeightedStrength),e*=this._Lacunarity,t*=this._Lacunarity,n*=this._Gain}return o}_GenFractalPingPongR3(e,t,i){let o=this._Seed,n=0,s=this._FractalBounding;for(let a=0;a<this._Octaves;a++){const c=pr((this._GenNoiseSingleR3(o++,e,t,i)+1)*this._PingPongStrength);n+=(c-.5)*2*s,s*=B(1,c,this._WeightedStrength),e*=this._Lacunarity,t*=this._Lacunarity,i*=this._Lacunarity,s*=this._Gain}return n}_SingleOpenSimplex2R2(e,t,i){const n=(3-1.7320508075688772)/6;let s=Math.floor(t),a=Math.floor(i);const c=t-s,h=i-a,u=(c+h)*n,l=c-u,f=h-u;s=Math.imul(s,z),a=Math.imul(a,N);let p,m,y;const v=.5-l*l-f*f;v<=0?p=0:p=v*v*(v*v)*De(e,s,a,l,f);const x=2*(1-2*n)*(1/n-2)*u+(-2*(1-2*n)*(1-2*n)+v);if(x<=0)y=0;else{const g=l+(2*n-1),d=f+(2*n-1);y=x*x*(x*x)*De(e,s+z,a+N,g,d)}if(f>l){const g=l+n,d=f+(n-1),b=.5-g*g-d*d;b<=0?m=0:m=b*b*(b*b)*De(e,s,a+N,g,d)}else{const g=l+(n-1),d=f+n,b=.5-g*g-d*d;b<=0?m=0:m=b*b*(b*b)*De(e,s+z,a,g,d)}return(p+m+y)*99.83685446303647}_SingleOpenSimplex2R3(e,t,i,o){let n=Math.round(t),s=Math.round(i),a=Math.round(o),c=t-n,h=i-s,u=o-a,l=Math.trunc(-1-h|1),f=Math.trunc(-1-c|1),p=Math.trunc(-1-u|1),m=f*-c,y=l*-h,v=p*-u;n=Math.imul(n,z),s=Math.imul(s,N),a=Math.imul(a,le);let x=0,g=.6-c*c-(h*h+u*u);for(let d=0;;d++){if(g>0&&(x+=g*g*(g*g)*we(e,n,s,a,c,h,u)),m>=y&&m>=v){let b=g+m+m;b>1&&(b-=1,x+=b*b*(b*b)*we(e,n-f*z,s,a,c+f,h,u))}else if(y>m&&y>=v){let b=g+y+y;b>1&&(b-=1,x+=b*b*(b*b)*we(e,n,s-l*N,a,c,h+l,u))}else{let b=g+v+v;b>1&&(b-=1,x+=b*b*(b*b)*we(e,n,s,a-p*le,c,h,u+p))}if(d===1)break;m=.5-m,y=.5-y,v=.5-v,c=f*m,h=l*y,u=p*v,g+=.75-m-(y+v),n+=f>>1&z,s+=l>>1&N,a+=p>>1&le,f=-f,l=-l,p=-p,e=~e}return x*32.69428253173828}_SingleOpenSimplex2SR2(e,t,i){const n=(3-1.7320508075688772)/6;let s=Math.floor(t),a=Math.floor(i);const c=t-s,h=i-a;s=Math.imul(s,z),a=Math.imul(a,N);const u=s+z,l=a+N,f=(c+h)*n,p=c-f,m=h-f,y=2/3-p*p-m*m;let v=y*y*(y*y)*De(e,s,a,p,m);const x=2*(1-2*n)*(1/n-2)*f+(-2*(1-2*n)*(1-2*n)+y),g=p-(1-2*n),d=m-(1-2*n);v+=x*x*(x*x)*De(e,u,l,g,d);const b=c-h;if(f>n){if(c+b>1){const _=p+(3*n-2),k=m+(3*n-1),w=2/3-_*_-k*k;w>0&&(v+=w*w*(w*w)*De(e,s+(z<<1),a+N,_,k))}else{const _=p+n,k=m+(n-1),w=2/3-_*_-k*k;w>0&&(v+=w*w*(w*w)*De(e,s,a+N,_,k))}if(h-b>1){const _=p+(3*n-1),k=m+(3*n-2),w=2/3-_*_-k*k;w>0&&(v+=w*w*(w*w)*De(e,s+z,a+(N<<1),_,k))}else{const _=p+(n-1),k=m+n,w=2/3-_*_-k*k;w>0&&(v+=w*w*(w*w)*De(e,s+z,a,_,k))}}else{if(c+b<0){const _=p+(1-n),k=m-n,w=2/3-_*_-k*k;w>0&&(v+=w*w*(w*w)*De(e,s-z,a,_,k))}else{const _=p+(n-1),k=m+n,w=2/3-_*_-k*k;w>0&&(v+=w*w*(w*w)*De(e,s+z,a,_,k))}if(h<b){const _=p-n,k=m-(n-1),w=2/3-_*_-k*k;w>0&&(v+=w*w*(w*w)*De(e,s,a-N,_,k))}else{const _=p+n,k=m+(n-1),w=2/3-_*_-k*k;w>0&&(v+=w*w*(w*w)*De(e,s,a+N,_,k))}}return v*18.24196194486065}_SingleOpenSimplex2SR3(e,t,i,o){let n=Math.floor(t),s=Math.floor(i),a=Math.floor(o);const c=t-n,h=i-s,u=o-a;n=Math.imul(n,z),s=Math.imul(s,N),a=Math.imul(a,le);const l=e+1293373,f=Math.trunc(-.5-c),p=Math.trunc(-.5-h),m=Math.trunc(-.5-u),y=c+f,v=h+p,x=u+m,g=.75-y*y-v*v-x*x;let d=g*g*(g*g)*we(e,n+(f&z),s+(p&N),a+(m&le),y,v,x);const b=c-.5,_=h-.5,k=u-.5,w=.75-b*b-_*_-k*k;d+=w*w*(w*w)*we(l,n+z,s+N,a+le,b,_,k);const j=((f|1)<<1)*b,M=((p|1)<<1)*_,J=((m|1)<<1)*k,Z=(-2-(f<<2))*b-1,H=(-2-(p<<2))*_-1,X=(-2-(m<<2))*k-1;let C=!1;const K=j+g;if(K>0){const W=y-(f|1);d+=K*K*(K*K)*we(e,n+(~f&z),s+(p&N),a+(m&le),W,v,x)}else{const W=M+J+g;if(W>0){const U=y,q=v-(p|1),ue=x-(m|1);d+=W*W*(W*W)*we(e,n+(f&z),s+(~p&N),a+(~m&le),U,q,ue)}const I=Z+w;if(I>0){const U=(f|1)+b;d+=I*I*(I*I)*we(l,n+(f&z*2),s+N,a+le,U,_,k),C=!0}}let ee=!1;const L=M+g;if(L>0){const W=y,I=v-(p|1);d+=L*L*(L*L)*we(e,n+(f&z),s+(~p&N),a+(m&le),W,I,x)}else{const W=j+J+g;if(W>0){const U=y-(f|1),q=v,ue=x-(m|1);d+=W*W*(W*W)*we(e,n+(~f&z),s+(p&N),a+(~m&le),U,q,ue)}const I=H+w;if(I>0){const U=b,q=(p|1)+_;d+=I*I*(I*I)*we(l,n+z,s+(p&N<<1),a+le,U,q,k),ee=!0}}let Y=!1;const V=J+g;if(V>0){const W=y,I=v,U=x-(m|1);d+=V*V*(V*V)*we(e,n+(f&z),s+(p&N),a+(~m&le),W,I,U)}else{const W=j+M+g;if(W>0){const U=y-(f|1),q=v-(p|1);d+=W*W*(W*W)*we(e,n+(~f&z),s+(~p&N),a+(m&le),U,q,x)}const I=X+w;if(I>0){const U=b,q=_,ue=(m|1)+k;d+=I*I*(I*I)*we(l,n+z,s+N,a+(m&le<<1),U,q,ue),Y=!0}}if(!C){const W=H+X+w;if(W>0){const I=b,U=(p|1)+_,q=(m|1)+k;d+=W*W*(W*W)*we(l,n+z,s+(p&N<<1),a+(m&le<<1),I,U,q)}}if(!ee){const W=Z+X+w;if(W>0){const I=(f|1)+b,U=_,q=(m|1)+k;d+=W*W*(W*W)*we(l,n+(f&z*2),s+N,a+(m&le<<1),I,U,q)}}if(!Y){const W=Z+H+w;if(W>0){const I=(f|1)+b,U=(p|1)+_;d+=W*W*(W*W)*we(l,n+(f&z<<1),s+(p&N<<1),a+le,I,U,k)}}return d*9.046026385208288}_SingleCellularR2(e,t,i){const o=Math.round(t),n=Math.round(i);let s=Number.MAX_VALUE,a=Number.MAX_VALUE,c=0;const h=.43701595*this._CellularJitterModifier;let u=(o-1)*z;const l=(n-1)*N;switch(this._CellularDistanceFunction){default:case $e.Euclidean:case $e.EuclideanSq:for(let f=o-1;f<=o+1;f++){let p=l;for(let m=n-1;m<=n+1;m++){const y=Fe(e,u,p),v=y&510,x=f-t+de[v]*h,g=m-i+de[v|1]*h,d=x*x+g*g;a=Math.max(Math.min(a,d),s),d<s&&(s=d,c=y),p+=N}u+=z}break;case $e.Manhattan:for(let f=o-1;f<=o+1;f++){let p=l;for(let m=n-1;m<=n+1;m++){const y=Fe(e,u,p),v=y&510,x=f-t+de[v]*h,g=m-i+de[v|1]*h,d=Math.abs(x)+Math.abs(g);a=Math.max(Math.min(a,d),s),d<s&&(s=d,c=y),p+=N}u+=z}break;case $e.Hybrid:for(let f=o-1;f<=o+1;f++){let p=l;for(let m=n-1;m<=n+1;m++){const y=Fe(e,u,p),v=y&510,x=f-t+de[v]*h,g=m-i+de[v|1]*h,d=Math.abs(x)+Math.abs(g)+(x*x+g*g);a=Math.max(Math.min(a,d),s),d<s&&(s=d,c=y),p+=N}u+=z}break}switch(this._CellularDistanceFunction===$e.Euclidean&&this._CellularReturnType!==Re.CellValue&&(s=Math.sqrt(s),a=Math.sqrt(a)),this._CellularReturnType){case Re.CellValue:return c*(1/2147483648);case Re.Distance:return s-1;case Re.Distance2:return a-1;case Re.Distance2Add:return(a+s)*.5-1;case Re.Distance2Sub:return a-s-1;case Re.Distance2Mul:return a*s*.5-1;case Re.Distance2Div:return s/a-1;default:return 0}}_SingleCellularR3(e,t,i,o){const n=Math.round(t),s=Math.round(i),a=Math.round(o);let c=Number.MAX_VALUE,h=Number.MAX_VALUE,u=0;const l=.39614353*this._CellularJitterModifier;let f=(n-1)*z;const p=(s-1)*N,m=(a-1)*le;switch(this._CellularDistanceFunction){case $e.Euclidean:case $e.EuclideanSq:for(let y=n-1;y<=n+1;y++){let v=p;for(let x=s-1;x<=s+1;x++){let g=m;for(let d=a-1;d<=a+1;d++){const b=je(e,f,v,g),_=b&1020,k=y-t+te[_]*l,w=x-i+te[_|1]*l,j=d-o+te[_|2]*l,M=k*k+w*w+j*j;h=Math.max(Math.min(h,M),c),M<c&&(c=M,u=b),g+=le}v+=N}f+=z}break;case $e.Manhattan:for(let y=n-1;y<=n+1;y++){let v=p;for(let x=s-1;x<=s+1;x++){let g=m;for(let d=a-1;d<=a+1;d++){const b=je(e,f,v,g),_=b&1020,k=y-t+te[_]*l,w=x-i+te[_|1]*l,j=d-o+te[_|2]*l,M=Math.abs(k)+Math.abs(w)+Math.abs(j);h=Math.max(Math.min(h,M),c),M<c&&(c=M,u=b),g+=le}v+=N}f+=z}break;case $e.Hybrid:for(let y=n-1;y<=n+1;y++){let v=p;for(let x=s-1;x<=s+1;x++){let g=m;for(let d=a-1;d<=a+1;d++){const b=je(e,f,v,g),_=b&1020,k=y-t+te[_]*l,w=x-i+te[_|1]*l,j=d-o+te[_|2]*l,M=Math.abs(k)+Math.abs(w)+Math.abs(j)+(k*k+w*w+j*j);h=Math.max(Math.min(h,M),c),M<c&&(c=M,u=b),g+=le}v+=N}f+=z}break}switch(this._CellularDistanceFunction===$e.Euclidean&&this._CellularReturnType!==Re.CellValue&&(c=Math.sqrt(c),h=Math.sqrt(h)),this._CellularReturnType){case Re.CellValue:return u*(1/2147483648);case Re.Distance:return c-1;case Re.Distance2:return h-1;case Re.Distance2Add:return(h+c)*.5-1;case Re.Distance2Sub:return h-c-1;case Re.Distance2Mul:return h*c*.5-1;case Re.Distance2Div:return c/h-1;default:return 0}}_SinglePerlinR3(e,t,i,o){let n=Math.floor(t),s=Math.floor(i),a=Math.floor(o);const c=t-n,h=i-s,u=o-a,l=c-1,f=h-1,p=u-1,m=At(c),y=At(h),v=At(u);n=Math.imul(n,z),s=Math.imul(s,N),a=Math.imul(a,le);const x=n+z,g=s+N,d=a+le,b=B(we(e,n,s,a,c,h,u),we(e,x,s,a,l,h,u),m),_=B(we(e,n,g,a,c,f,u),we(e,x,g,a,l,f,u),m),k=B(we(e,n,s,d,c,h,p),we(e,x,s,d,l,h,p),m),w=B(we(e,n,g,d,c,f,p),we(e,x,g,d,l,f,p),m),j=B(b,_,y),M=B(k,w,y);return B(j,M,v)*.9649214148521423}_SingleValueCubicR2(e,t,i){let o=Math.floor(t),n=Math.floor(i);const s=t-o,a=i-n;o=Math.imul(o,z),n=Math.imul(n,N);const c=o-z,h=n-N,u=o+z,l=n+N,f=o+(z<<1),p=n+(N<<1);return ge(ge(We(e,c,h),We(e,o,h),We(e,u,h),We(e,f,h),s),ge(We(e,c,n),We(e,o,n),We(e,u,n),We(e,f,n),s),ge(We(e,c,l),We(e,o,l),We(e,u,l),We(e,f,l),s),ge(We(e,c,p),We(e,o,p),We(e,u,p),We(e,f,p),s),a)*(1/(1.5*1.5))}_SingleValueCubicR3(e,t,i,o){let n=Math.floor(t),s=Math.floor(i),a=Math.floor(o);const c=t-n,h=i-s,u=o-a;n=Math.imul(n,z),s=Math.imul(s,N),a=Math.imul(a,le);const l=n-z,f=s-N,p=a-le,m=n+z,y=s+N,v=a+le,x=n+(z<<1),g=s+(N<<1),d=a+(le<<1);return ge(ge(ge(A(e,l,f,p),A(e,n,f,p),A(e,m,f,p),A(e,x,f,p),c),ge(A(e,l,s,p),A(e,n,s,p),A(e,m,s,p),A(e,x,s,p),c),ge(A(e,l,y,p),A(e,n,y,p),A(e,m,y,p),A(e,x,y,p),c),ge(A(e,l,g,p),A(e,n,g,p),A(e,m,g,p),A(e,x,g,p),c),h),ge(ge(A(e,l,f,a),A(e,n,f,a),A(e,m,f,a),A(e,x,f,a),c),ge(A(e,l,s,a),A(e,n,s,a),A(e,m,s,a),A(e,x,s,a),c),ge(A(e,l,y,a),A(e,n,y,a),A(e,m,y,a),A(e,x,y,a),c),ge(A(e,l,g,a),A(e,n,g,a),A(e,m,g,a),A(e,x,g,a),c),h),ge(ge(A(e,l,f,v),A(e,n,f,v),A(e,m,f,v),A(e,x,f,v),c),ge(A(e,l,s,v),A(e,n,s,v),A(e,m,s,v),A(e,x,s,v),c),ge(A(e,l,y,v),A(e,n,y,v),A(e,m,y,v),A(e,x,y,v),c),ge(A(e,l,g,v),A(e,n,g,v),A(e,m,g,v),A(e,x,g,v),c),h),ge(ge(A(e,l,f,d),A(e,n,f,d),A(e,m,f,d),A(e,x,f,d),c),ge(A(e,l,s,d),A(e,n,s,d),A(e,m,s,d),A(e,x,s,d),c),ge(A(e,l,y,d),A(e,n,y,d),A(e,m,y,d),A(e,x,y,d),c),ge(A(e,l,g,d),A(e,n,g,d),A(e,m,g,d),A(e,x,g,d),c),h),u)*(1/(1.5*1.5*1.5))}_SingleValueR2(e,t,i){let o=Math.floor(t),n=Math.floor(i);const s=tt(t-o),a=tt(i-n);o=Math.imul(o,z),n=Math.imul(n,N);const c=o+z,h=n+N,u=B(We(e,o,n),We(e,c,n),s),l=B(We(e,o,h),We(e,c,h),s);return B(u,l,a)}_SingleValueR3(e,t,i,o){let n=Math.floor(t),s=Math.floor(i),a=Math.floor(o);const c=tt(t-n),h=tt(i-s),u=tt(o-a);n=Math.imul(n,z),s=Math.imul(s,N),a=Math.imul(a,le);const l=n+z,f=s+N,p=a+le,m=B(A(e,n,s,a),A(e,l,s,a),c),y=B(A(e,n,f,a),A(e,l,f,a),c),v=B(A(e,n,s,p),A(e,l,s,p),c),x=B(A(e,n,f,p),A(e,l,f,p),c),g=B(m,y,h),d=B(v,x,h);return B(g,d,u)}_DoSingleDomainWarp(e,t,i,o,n,s,a){const c=(u,l,f,p,m,y)=>{switch(this._DomainWarpType){case Ne.OpenSimplex2:this._SingleDomainWarpOpenSimplex2Gradient(u,l*38.283687591552734,f,p,!1,m,y);break;case Ne.OpenSimplex2Reduced:this._SingleDomainWarpOpenSimplex2Gradient(u,l*16,f,p,!0,m,y);break;case Ne.BasicGrid:this._SingleDomainWarpBasicGrid(u,l,f,p,m,y);break}},h=(u,l,f,p,m,y,v)=>{switch(this._DomainWarpType){case Ne.OpenSimplex2:this._SingleDomainWarpOpenSimplex2Gradient(u,l*32.69428253173828,f,p,!1,m,y,v);break;case Ne.OpenSimplex2Reduced:this._SingleDomainWarpOpenSimplex2Gradient(u,l*7.71604938271605,f,p,!0,m,y,v);break;case Ne.BasicGrid:this._SingleDomainWarpBasicGrid(u,l,f,p,m,y,v);break}};if(o instanceof gt)return c(e,t,i,o,n,s);if(o instanceof wt&&a!==void 0)return h(e,t,i,o,n,s,a)}_DomainWarpSingle(e){const t=o=>{const n=this._Seed,s=this._DomainWarpAmp*this._FractalBounding,a=this._Frequency;let c=o.x,h=o.y;switch(this._DomainWarpType){case Ne.OpenSimplex2:case Ne.OpenSimplex2Reduced:{const l=.5*(1.7320508075688772-1),f=(c+h)*l;c+=f,h+=f;break}}this._DoSingleDomainWarp(n,s,a,o,c,h)},i=o=>{const n=this._Seed,s=this._DomainWarpAmp*this._FractalBounding,a=this._Frequency;let c=o.x,h=o.y,u=o.z;switch(this._WarpTransformType3D){case Se.ImproveXYPlanes:{const l=c+h,f=l*-.211324865405187;u*=.577350269189626,c+=f-u,h=h+f-u,u+=l*.577350269189626}break;case Se.ImproveXZPlanes:{const l=c+u,f=l*-.211324865405187;h*=.577350269189626,c+=f-h,u+=f-h,h+=l*.577350269189626}break;case Se.DefaultOpenSimplex2:{const f=(c+h+u)*.6666666666666666;c=f-c,h=f-h,u=f-u;break}}this._DoSingleDomainWarp(n,s,a,o,c,h,u)};if(e instanceof gt)return t(e);if(e instanceof wt)return i(e)}_DomainWarpFractalProgressive(e){const t=o=>{let n=this._Seed,s=this._DomainWarpAmp*this._FractalBounding,a=this._Frequency;for(let c=0;c<this._Octaves;c++){let h=o.x,u=o.y;switch(this._DomainWarpType){case Ne.OpenSimplex2:case Ne.OpenSimplex2Reduced:{const f=.5*(1.7320508075688772-1),p=(h+u)*f;h+=p,u+=p;break}}this._DoSingleDomainWarp(n,s,a,o,h,u),n++,s*=this._Gain,a*=this._Lacunarity}},i=o=>{let n=this._Seed,s=this._DomainWarpAmp*this._FractalBounding,a=this._Frequency;for(let c=0;c<this._Octaves;c++){let h=o.x,u=o.y,l=o.z;switch(this._WarpTransformType3D){case Se.ImproveXYPlanes:{const f=h+u,p=f*-.211324865405187;l*=.577350269189626,h+=p-l,u=u+p-l,l+=f*.577350269189626}break;case Se.ImproveXZPlanes:{const f=h+l,p=f*-.211324865405187;u*=.577350269189626,h+=p-u,l+=p-u,u+=f*.577350269189626}break;case Se.DefaultOpenSimplex2:{const p=(h+u+l)*.6666666666666666;h=p-h,u=p-u,l=p-l}break}this._DoSingleDomainWarp(n,s,a,o,h,u,l),n++,s*=this._Gain,a*=this._Lacunarity}};if(e instanceof gt)return t(e);if(e instanceof wt)return i(e)}_DomainWarpFractalIndependent(e){const t=o=>{let n=o.x,s=o.y;switch(this._DomainWarpType){case Ne.OpenSimplex2:case Ne.OpenSimplex2Reduced:{const l=.5*(1.7320508075688772-1),f=(n+s)*l;n+=f,s+=f;break}}let a=this._Seed,c=this._DomainWarpAmp*this._FractalBounding,h=this._Frequency;for(let u=0;u<this._Octaves;u++)this._DoSingleDomainWarp(a,c,h,o,n,s),a++,c*=this._Gain,h*=this._Lacunarity},i=o=>{let n=o.x,s=o.y,a=o.z;switch(this._WarpTransformType3D){case Se.ImproveXYPlanes:{const l=n+s,f=l*-.211324865405187;a*=.577350269189626,n+=f-a,s=s+f-a,a+=l*.577350269189626}break;case Se.ImproveXZPlanes:{const l=n+a,f=l*-.211324865405187;s*=.577350269189626,n+=f-s,a+=f-s,s+=l*.577350269189626}break;case Se.DefaultOpenSimplex2:{const f=(n+s+a)*.6666666666666666;n=f-n,s=f-s,a=f-a}break}let c=this._Seed,h=this._DomainWarpAmp*this._FractalBounding,u=this._Frequency;for(let l=0;l<this._Octaves;l++)this._DoSingleDomainWarp(c,h,u,o,n,s,a),c++,h*=this._Gain,u*=this._Lacunarity};if(e instanceof gt)return t(e);if(e instanceof wt)return i(e)}_SingleDomainWarpBasicGrid(e,t,i,o,n,s,a){const c=(u,l,f,p,m,y)=>{const v=m*f,x=y*f;let g=Math.floor(v),d=Math.floor(x);const b=tt(v-g),_=tt(x-d);g=Math.imul(g,z),d=Math.imul(d,N);const k=g+z,w=d+N;let j=Fe(u,g,d)&510,M=Fe(u,k,d)&510;const J=B(de[j],de[M],b),Z=B(de[j|1],de[M|1],b);j=Fe(u,g,w)&510,M=Fe(u,k,w)&510;const H=B(de[j],de[M],b),X=B(de[j|1],de[M|1],b);p.x+=B(J,H,_)*l,p.y+=B(Z,X,_)*l},h=(u,l,f,p,m,y,v)=>{const x=m*f,g=y*f,d=v*f;let b=Math.floor(x),_=Math.floor(g),k=Math.floor(d);const w=tt(x-b),j=tt(g-_),M=tt(d-k);b=Math.imul(b,z),_=Math.imul(_,N),k=Math.imul(k,le);const J=b+z,Z=_+N,H=k+le;let X=je(u,b,_,k)&1020,C=je(u,J,_,k)&1020,K=B(te[X],te[C],w),ee=B(te[X|1],te[C|1],w),L=B(te[X|2],te[C|2],w);X=je(u,b,Z,k)&1020,C=je(u,J,Z,k)&1020;let Y=B(te[X],te[C],w),V=B(te[X|1],te[C|1],w),W=B(te[X|2],te[C|2],w);const I=B(K,Y,j),U=B(ee,V,j),q=B(L,W,j);X=je(u,b,_,H)&1020,C=je(u,J,_,H)&1020,K=B(te[X],te[C],w),ee=B(te[X|1],te[C|1],w),L=B(te[X|2],te[C|2],w),X=je(u,b,Z,H)&1020,C=je(u,J,Z,H)&1020,Y=B(te[X],te[C],w),V=B(te[X|1],te[C|1],w),W=B(te[X|2],te[C|2],w),p.x+=B(I,B(K,Y,j),M)*l,p.y+=B(U,B(ee,V,j),M)*l,p.z+=B(q,B(L,W,j),M)*l};o instanceof gt&&c(e,t,i,o,n,s),o instanceof wt&&a!==void 0&&h(e,t,i,o,n,s,a)}_SingleDomainWarpOpenSimplex2Gradient(e,t,i,o,n,s,a,c){const h=(l,f,p,m,y,v,x)=>{const d=(3-1.7320508075688772)/6;v*=p,x*=p;let b=Math.floor(v),_=Math.floor(x);const k=v-b,w=x-_,j=(k+w)*d,M=k-j,J=w-j;b=Math.imul(b,z),_=Math.imul(_,N);let Z,H;Z=H=0;const X=.5-M*M-J*J;if(X>0){const K=X*X*(X*X);let ee,L;if(y){const Y=Fe(l,b,_)&510;ee=de[Y],L=de[Y|1]}else{const Y=Fe(l,b,_),V=Y&254,W=Y>>7&510,I=it[V],U=it[V|1],q=M*I+J*U,ue=de[W],ae=de[W|1];ee=q*ue,L=q*ae}Z+=K*ee,H+=K*L}const C=2*(1-2*d)*(1/d-2)*j+(-2*(1-2*d)*(1-2*d)+X);if(C>0){const K=M+(2*d-1),ee=J+(2*d-1),L=C*C*(C*C);let Y,V;if(y){const W=Fe(l,b+z,_+N)&510;Y=de[W],V=de[W|1]}else{const W=Fe(l,b+z,_+N),I=W&254,U=W>>7&510,q=it[I],ue=it[I|1],ae=K*q+ee*ue,xe=de[U],ke=de[U|1];Y=ae*xe,V=ae*ke}Z+=L*Y,H+=L*V}if(J>M){const K=M+d,ee=J+(d-1),L=.5-K*K-ee*ee;if(L>0){const Y=L*L*(L*L);let V,W;if(y){const I=Fe(l,b,_+N)&510;V=de[I],W=de[I|1]}else{const I=Fe(l,b,_+N),U=I&254,q=I>>7&510,ue=it[U],ae=it[U|1],xe=K*ue+ee*ae,ke=de[q],Me=de[q|1];V=xe*ke,W=xe*Me}Z+=Y*V,H+=Y*W}}else{const K=M+(d-1),ee=J+d,L=.5-K*K-ee*ee;if(L>0){const Y=L*L*(L*L);let V,W;if(y){const I=Fe(l,b+z,_)&510;V=de[I],W=de[I|1]}else{const I=Fe(l,b+z,_),U=I&254,q=I>>7&510,ue=it[U],ae=it[U|1],xe=K*ue+ee*ae,ke=de[q],Me=de[q|1];V=xe*ke,W=xe*Me}Z+=Y*V,H+=Y*W}}m.x+=Z*f,m.y+=H*f},u=(l,f,p,m,y,v,x,g)=>{v*=p,x*=p,g*=p;let d=Math.round(v),b=Math.round(x),_=Math.round(g),k=v-d,w=x-b,j=g-_,M=-k-1|1,J=-w-1|1,Z=-j-1|1,H=M*-k,X=J*-w,C=Z*-j;d=Math.imul(d,z),b=Math.imul(b,N),_=Math.imul(_,le);let K,ee,L;K=ee=L=0;let Y=.6-k*k-(w*w+j*j);for(let V=0;;V++){if(Y>0){const ke=Y*Y*(Y*Y);let Me,Ce,Ze;if(y){const Te=je(l,d,b,_)&1020;Me=te[Te],Ce=te[Te|1],Ze=te[Te|2]}else{const Te=je(l,d,b,_),Le=Te&252,Ie=Te>>6&1020,st=lt[Le],St=lt[Le|1],Tt=lt[Le|2],at=k*st+w*St+j*Tt,Ot=te[Ie],O=te[Ie|1],R=te[Ie|2];Me=at*Ot,Ce=at*O,Ze=at*R}K+=ke*Me,ee+=ke*Ce,L+=ke*Ze}let W=Y,I=d,U=b,q=_,ue=k,ae=w,xe=j;if(H>=X&&H>=C?(ue+=M,W=W+H+H,I-=M*z):X>H&&X>=C?(ae+=J,W=W+X+X,U-=J*N):(xe+=Z,W=W+C+C,q-=Z*le),W>1){W-=1;const ke=W*W*(W*W);let Me,Ce,Ze;if(y){const Te=je(l,I,U,q)&1020;Me=te[Te],Ce=te[Te|1],Ze=te[Te|2]}else{const Te=je(l,I,U,q),Le=Te&252,Ie=Te>>6&1020,st=lt[Le],St=lt[Le|1],Tt=lt[Le|2],at=ue*st+ae*St+xe*Tt,Ot=te[Ie],O=te[Ie|1],R=te[Ie|2];Me=at*Ot,Ce=at*O,Ze=at*R}K+=ke*Me,ee+=ke*Ce,L+=ke*Ze}if(V===1)break;H=.5-H,X=.5-X,C=.5-C,k=M*H,w=J*X,j=Z*C,Y+=.75-H-(X+C),d+=M>>1&z,b+=J>>1&N,_+=Z>>1&le,M=-M,J=-J,Z=-Z,l+=1293373}m.x+=K*f,m.y+=ee*f,m.z+=L*f};o instanceof gt&&h(e,t,i,o,n,s,a),o instanceof wt&&c!==void 0&&u(e,t,i,o,n,s,a,c)}}const on=([r,e,t,i])=>{e/=100,t/=100;const o=(1-Math.abs(2*t-1))*e,n=o*(1-Math.abs(r/60%2-1)),s=t-o/2;let a=0,c=0,h=0;return r>=0&&r<60?(a=o,c=n,h=0):r>=60&&r<120?(a=n,c=o,h=0):r>=120&&r<180?(a=0,c=o,h=n):r>=180&&r<240?(a=0,c=n,h=o):r>=240&&r<300?(a=n,c=0,h=o):r>=300&&r<360&&(a=o,c=0,h=n),[Math.round((a+s)*255),Math.round((c+s)*255),Math.round((h+s)*255),Math.round(i*255)]},sn=({value:r,input:e,output:t})=>(r-e.min)/(e.max-e.min)*(t.max-t.min)+t.min,an=r=>{let e=0;for(let t=0;t<r.length;t++)e=(e<<5)-e+r.charCodeAt(t),e|=0;return Math.abs(e)};class zt{constructor(e,t){this.max=e,this._seed=t}cast(e,t){return BigInt.asUintN(t,e)}checkNum(e){if(e>this.max)throw new Error(`Number greater than ${this.max}`)}reset(){if(this.constructor===zt)throw new Error("Method not implemented")}_int(){if(this.constructor===zt)throw new Error("Method not implemented");return BigInt(0)}bool(){return this.float()>=.5}coin(e=.5){return this.float()<e}int(){return Number(this._int())}bigInt(){return this._int()}float(){return this.int()*(1/this.max)}float53(){const e=this.int()>>>5,t=this.int()>>>6;return(e*67108864+t)*(1/9007199254740992)}randRange(e,t){const i=t-e,o=this.max%i;let n=this.int();for(;n<o;)n=this.int();return e+n%i}randBelow(e){return this.randRange(0,e)}choice(e){return e[this.randBelow(e.length)]}shuffle(e,t=!0){let i=e;t||(i=Array.from(i));for(let o=i.length-1;o>0;o--){const n=this.randRange(0,o),s=i[o];i[o]=i[n],i[n]=s}return i}initArray(e,t){return Array.from({length:e},t)}boolArray(e){return this.initArray(e,()=>this.bool())}coinArray(e,t=.5){return this.initArray(e,()=>this.coin(t))}intArray(e){return this.initArray(e,()=>this.int())}bigIntArray(e){return this.initArray(e,()=>this.bigInt())}randRangeArray(e,t,i){return this.initArray(e,()=>this.randRange(t,i))}floatArray(e){return this.initArray(e,()=>this.float())}float53Array(e){return this.initArray(e,()=>this.float53())}}class cn extends zt{constructor(e,t){super(e,t)}int(){return Number(this._int()>>11n)}float(){return this.int()/this.max}float53(){return this.float()}}const ln=2**32,un=2**53;class Er extends cn{constructor(e=Date.now(),t=13,i=7,o=17){super(un,BigInt(e)),this.seed=e,this.a=this.cast(BigInt(t),64),this.b=this.cast(BigInt(i),64),this.c=this.cast(BigInt(o),64)}reset(){this.x=this.seed}get seed(){return this._seed}set seed(e){this._seed=this.cast(BigInt(e),64),this.x=this._seed}_int(){let{x:e}=this;return e^=e<<this.a,e=this.cast(e,64),e^=e>>this.b,e^=e<<this.c,e=this.cast(e,64),this.x=e,e}}class fn extends zt{constructor(e=Date.now(),t=362436069,i=521288629,o=88675123,n=5783321,s=6615241,a=362437){super(ln,BigInt(e)),this._seed=this.cast(this._seed,32),this.x=this._seed,this.y=this.cast(BigInt(t),32),this.z=this.cast(BigInt(i),32),this.w=this.cast(BigInt(o),32),this.v=this.cast(BigInt(n),32),this.d=this.cast(BigInt(s),32),this.weyl=this.cast(BigInt(a),32),this.origParams={y:this.y,z:this.z,w:this.w,v:this.v,d:this.d}}reset(){this.x=this.seed,Object.assign(this,this.origParams)}get seed(){return this._seed}set seed(e){this._seed=this.cast(BigInt(e),32),this.reset()}_int(){let e=this.x,{v:t}=this;return e^=e>>2n,e^=e<<1n,t^=t<<4n,this.x=this.y,this.y=this.z,this.z=this.w,this.w=this.v,this.v=this.cast(t^e,32),this.d+=this.weyl,this.cast(this.d+this.v,32)}}new Er(Date.now());new Er(Date.now());const Dr=({seed:r})=>{const e=new fn(an(r)),t=new It(e.float());return t.SetFrequency(1),t},dr=(r,e,t,i,o)=>{const n=i.map(({noise:a,name:c})=>o[a](`${t}-${c}`)),s=i.filter(a=>!a.disabled).reduce((a,{scale:c,inverse:h,weight:u,limit:l},f)=>{let p=n[f](r*c,e*c);return u&&(p*=u),h&&(p*=-1),l&&(l.min!==void 0&&(p=Math.max(l.min,p)),l.max!==void 0&&(p=Math.min(l.max,p))),p=a+p,p},0);return Math.max(-1,Math.min(1,s))},mt=({seed:r,noise:e,layers:t,variation:i=[]})=>(o,n)=>{let s=dr(o,n,r,t,e);const a=i.find(({min:c,max:h})=>c<=s&&s<=h);if(a){const c=dr(o,n,r,a.layers,e);s=sn({value:c,input:{min:-1,max:1},output:a})*a.weight}return Math.max(-1,Math.min(1,s))},hn={name:"Greenland",weight:1,colorMap:{heightmap:Array.from({length:21},(r,e)=>{const t=-1+e*2/20,i=40+e*40/20,o=20+e*50/20;return{noise:t,color:[120,i,o,1]}}).sort((r,e)=>e.noise-r.noise),biome:[{noise:-1,color:[0,-5,-3,.05]},{noise:-.5,color:[0,-3,-2,.05]},{noise:0,color:[0,0,0,0]},{noise:.5,color:[0,3,2,.05]},{noise:1,color:[0,5,3,.05]}].sort((r,e)=>e.noise-r.noise),temperature:Array.from({length:51},(r,e)=>{const t=1-e*2/50;let i,o,n,s;if(t>0)i=-5*t,o=2*t,n=0,s=.05*t;else if(t<0){const a=Math.abs(t);i=5*a,o=2*a,n=0,s=.05*a}else i=o=n=s=0;return{noise:t,color:[i,o,n,s]}}).sort((r,e)=>e.noise-r.noise),moisture:[{noise:-1,color:[0,-4,-3,.05]},{noise:-.5,color:[0,-2,-1,.05]},{noise:0,color:[0,0,0,0]},{noise:.5,color:[0,2,1,.05]},{noise:1,color:[0,4,3,.05]}].sort((r,e)=>e.noise-r.noise)},noise({seed:r}){const e={cubic:t=>{const i=Dr({seed:t});return i.SetNoiseType(It.NoiseType.ValueCubic),i.SetFractalType(It.FractalType.PingPong),i.SetFractalOctaves(6),i.SetFractalWeightedStrength(-.75),(o,n)=>i.GetNoise(o,n)}};return{heightmap:mt({seed:`${r}-greenland-heightmap`,noise:e,layers:[{name:"base",noise:"cubic",scale:.025}]}),biome:mt({seed:`${r}-greenland-biome`,noise:e,layers:[{name:"base",noise:"cubic",scale:1.5}]}),temperature:mt({seed:`${r}-greenland-temperature`,noise:e,layers:[{name:"base",noise:"cubic",scale:.05}]}),moisture:mt({seed:`${r}-greenland-moisture`,noise:e,layers:[{name:"base",noise:"cubic",scale:1}]})}}},pn={name:"Ocean",weight:.75,colorMap:{heightmap:Array.from({length:21},(r,e)=>{const t=-1+e*2/20,i=(t+1)/2,o=210+-10*i,n=80+-30*i,s=20+60*i;return{noise:t,color:[o,n,s,1]}}).sort((r,e)=>e.noise-r.noise),biome:[{noise:-1,color:[0,2,-3,.05]},{noise:-.5,color:[0,1,-2,.05]},{noise:0,color:[0,0,0,0]},{noise:.5,color:[0,-1,2,.05]},{noise:1,color:[0,-2,3,.05]}].sort((r,e)=>e.noise-r.noise),temperature:Array.from({length:51},(r,e)=>{const t=1-e*2/50;let i,o,n,s;if(t>0)i=-5*t,o=1*t,n=0,s=.05*t;else if(t<0){const a=Math.abs(t);i=5*a,o=1*a,n=0,s=.05*a}else i=o=n=s=0;return{noise:t,color:[i,o,n,s]}}).sort((r,e)=>e.noise-r.noise),moisture:[{noise:-1,color:[0,2,-2,.05]},{noise:-.5,color:[0,1,-1,.05]},{noise:0,color:[0,0,0,0]},{noise:.5,color:[0,-1,1,.05]},{noise:1,color:[0,-2,2,.05]}].sort((r,e)=>e.noise-r.noise)},noise({seed:r}){const e={cubic:t=>{const i=Dr({seed:t});return i.SetNoiseType(It.NoiseType.ValueCubic),i.SetFractalType(It.FractalType.PingPong),i.SetFractalOctaves(6),i.SetFractalWeightedStrength(-.75),(o,n)=>i.GetNoise(o,n)}};return{heightmap:mt({seed:`${r}-ocean-heightmap`,noise:e,layers:[{name:"base",noise:"cubic",scale:.025}]}),biome:mt({seed:`${r}-ocean-biome`,noise:e,layers:[{name:"base",noise:"cubic",scale:1.5}]}),temperature:mt({seed:`${r}-ocean-temperature`,noise:e,layers:[{name:"base",noise:"cubic",scale:.05}]}),moisture:mt({seed:`${r}-ocean-moisture`,noise:e,layers:[{name:"base",noise:"cubic",scale:1}]})}}},dn={plotCount:256,chunkSize:16*256,biome:[pn,hn]};var ir=["u8","u16","u32","u64","u128","i8","i16","i32","i64","i128","f32","f64"],mn=function(){function r(){this.offset=0,this.buffer_size=256,this.buffer=new ArrayBuffer(this.buffer_size),this.view=new DataView(this.buffer)}return r.prototype.resize_if_necessary=function(e){if(this.buffer_size-this.offset<e){this.buffer_size=Math.max(this.buffer_size*2,this.buffer_size+e);var t=new ArrayBuffer(this.buffer_size);new Uint8Array(t).set(new Uint8Array(this.buffer)),this.buffer=t,this.view=new DataView(t)}},r.prototype.get_used_buffer=function(){return new Uint8Array(this.buffer).slice(0,this.offset)},r.prototype.store_value=function(e,t){var i=t.substring(1),o=parseInt(i)/8;this.resize_if_necessary(o);var n=t[0]==="f"?"setFloat".concat(i):t[0]==="i"?"setInt".concat(i):"setUint".concat(i);this.view[n](this.offset,e,!0),this.offset+=o},r.prototype.store_bytes=function(e){this.resize_if_necessary(e.length),new Uint8Array(this.buffer).set(new Uint8Array(e),this.offset),this.offset+=e.length},r}(),yn=function(){function r(e){this.offset=0,this.buffer_size=e.length,this.buffer=new ArrayBuffer(e.length),new Uint8Array(this.buffer).set(e),this.view=new DataView(this.buffer)}return r.prototype.assert_enough_buffer=function(e){if(this.offset+e>this.buffer.byteLength)throw new Error("Error in schema, the buffer is smaller than expected")},r.prototype.consume_value=function(e){var t=e.substring(1),i=parseInt(t)/8;this.assert_enough_buffer(i);var o=e[0]==="f"?"getFloat".concat(t):e[0]==="i"?"getInt".concat(t):"getUint".concat(t),n=this.view[o](this.offset,!0);return this.offset+=i,n},r.prototype.consume_bytes=function(e){this.assert_enough_buffer(e);var t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t},r}(),vn=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(i[n]=o[n])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();function gn(r){return Array.isArray(r)||!!r&&typeof r=="object"&&"length"in r&&typeof r.length=="number"&&(r.length===0||r.length>0&&r.length-1 in r)}function bt(r,e,t){if(typeof r!==e)throw new Error("Expected ".concat(e," not ").concat(typeof r,"(").concat(r,") at ").concat(t.join(".")))}function wn(r,e){var t=["number","string","bigint","boolean"].includes(typeof r),i=typeof r=="object"&&r!==null&&"toString"in r;if(!t&&!i)throw new Error("Expected bigint, number, boolean or string not ".concat(typeof r,"(").concat(r,") at ").concat(e.join(".")))}function mr(r,e,t){if(r!==e)throw new Error("Array length ".concat(r," does not match schema length ").concat(e," at ").concat(t.join(".")))}function bn(r,e){if(typeof r!="object"||r===null)throw new Error("Expected object not ".concat(typeof r,"(").concat(r,") at ").concat(e.join(".")))}var yr=ir.concat(["bool","string"]),vr=["option","enum","array","set","map","struct"],kt=function(r){vn(e,r);function e(t,i){var o="Invalid schema: ".concat(JSON.stringify(t)," expected ").concat(i);return r.call(this,o)||this}return e}(Error);function ut(r){if(!(typeof r=="string"&&yr.includes(r))){if(r&&typeof r=="object"){var e=Object.keys(r);if(e.length===1&&vr.includes(e[0])){var t=e[0];if(t==="option")return ut(r[t]);if(t==="enum")return _n(r[t]);if(t==="array")return xn(r[t]);if(t==="set")return ut(r[t]);if(t==="map")return kn(r[t]);if(t==="struct")return Sn(r[t])}}throw new kt(r,vr.join(", ")+" or "+yr.join(", "))}}function _n(r){if(!Array.isArray(r))throw new kt(r,"Array");for(var e=0,t=r;e<t.length;e++){var i=t[e];if(typeof i!="object"||!("struct"in i))throw new Error('Missing "struct" key in enum schema');if(typeof i.struct!="object"||Object.keys(i.struct).length!==1)throw new Error('The "struct" in each enum must have a single key');ut({struct:i.struct})}}function xn(r){if(typeof r!="object")throw new kt(r,"{ type, len? }");if(r.len&&typeof r.len!="number")throw new Error("Invalid schema: ".concat(r));if("type"in r)return ut(r.type);throw new kt(r,"{ type, len? }")}function kn(r){if(typeof r=="object"&&"key"in r&&"value"in r)ut(r.key),ut(r.value);else throw new kt(r,"{ key, value }")}function Sn(r){if(typeof r!="object")throw new kt(r,"object");for(var e in r)ut(r[e])}var Tn=function(){function r(e){this.encoded=new mn,this.fieldPath=["value"],this.checkTypes=e}return r.prototype.encode=function(e,t){return this.encode_value(e,t),this.encoded.get_used_buffer()},r.prototype.encode_value=function(e,t){if(typeof t=="string"){if(ir.includes(t))return this.encode_integer(e,t);if(t==="string")return this.encode_string(e);if(t==="bool")return this.encode_boolean(e)}if(typeof t=="object"){if("option"in t)return this.encode_option(e,t);if("enum"in t)return this.encode_enum(e,t);if("array"in t)return this.encode_array(e,t);if("set"in t)return this.encode_set(e,t);if("map"in t)return this.encode_map(e,t);if("struct"in t)return this.encode_struct(e,t)}},r.prototype.encode_integer=function(e,t){var i=parseInt(t.substring(1));i<=32||t=="f64"?(this.checkTypes&&bt(e,"number",this.fieldPath),this.encoded.store_value(e,t)):(this.checkTypes&&wn(e,this.fieldPath),this.encode_bigint(BigInt(e),i))},r.prototype.encode_bigint=function(e,t){for(var i=t/8,o=new Uint8Array(i),n=0;n<i;n++)o[n]=Number(e&BigInt(255)),e=e>>BigInt(8);this.encoded.store_bytes(new Uint8Array(o))},r.prototype.encode_string=function(e){this.checkTypes&&bt(e,"string",this.fieldPath);for(var t=e,i=[],o=0;o<t.length;o++){var n=t.charCodeAt(o);n<128?i.push(n):n<2048?i.push(192|n>>6,128|n&63):n<55296||n>=57344?i.push(224|n>>12,128|n>>6&63,128|n&63):(o++,n=65536+((n&1023)<<10|t.charCodeAt(o)&1023),i.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63))}this.encoded.store_value(i.length,"u32"),this.encoded.store_bytes(new Uint8Array(i))},r.prototype.encode_boolean=function(e){this.checkTypes&&bt(e,"boolean",this.fieldPath),this.encoded.store_value(e?1:0,"u8")},r.prototype.encode_option=function(e,t){e==null?this.encoded.store_value(0,"u8"):(this.encoded.store_value(1,"u8"),this.encode_value(e,t.option))},r.prototype.encode_enum=function(e,t){this.checkTypes&&bn(e,this.fieldPath);for(var i=Object.keys(e)[0],o=0;o<t.enum.length;o++){var n=t.enum[o];if(i===Object.keys(n.struct)[0])return this.encoded.store_value(o,"u8"),this.encode_struct(e,n)}throw new Error("Enum key (".concat(i,") not found in enum schema: ").concat(JSON.stringify(t)," at ").concat(this.fieldPath.join(".")))},r.prototype.encode_array=function(e,t){if(gn(e))return this.encode_arraylike(e,t);if(e instanceof ArrayBuffer)return this.encode_buffer(e,t);throw new Error("Expected Array-like not ".concat(typeof e,"(").concat(e,") at ").concat(this.fieldPath.join(".")))},r.prototype.encode_arraylike=function(e,t){t.array.len?mr(e.length,t.array.len,this.fieldPath):this.encoded.store_value(e.length,"u32");for(var i=0;i<e.length;i++)this.encode_value(e[i],t.array.type)},r.prototype.encode_buffer=function(e,t){t.array.len?mr(e.byteLength,t.array.len,this.fieldPath):this.encoded.store_value(e.byteLength,"u32"),this.encoded.store_bytes(new Uint8Array(e))},r.prototype.encode_set=function(e,t){this.checkTypes&&bt(e,"object",this.fieldPath);var i=e instanceof Set,o=i?Array.from(e.values()):Object.values(e);this.encoded.store_value(o.length,"u32");for(var n=0,s=o;n<s.length;n++){var a=s[n];this.encode_value(a,t.set)}},r.prototype.encode_map=function(e,t){this.checkTypes&&bt(e,"object",this.fieldPath);var i=e instanceof Map,o=i?Array.from(e.keys()):Object.keys(e);this.encoded.store_value(o.length,"u32");for(var n=0,s=o;n<s.length;n++){var a=s[n];this.encode_value(a,t.map.key),this.encode_value(i?e.get(a):e[a],t.map.value)}},r.prototype.encode_struct=function(e,t){this.checkTypes&&bt(e,"object",this.fieldPath);for(var i=0,o=Object.keys(t.struct);i<o.length;i++){var n=o[i];this.fieldPath.push(n),this.encode_value(e[n],t.struct[n]),this.fieldPath.pop()}},r}(),On=function(){function r(e){this.buffer=new yn(e)}return r.prototype.decode=function(e){return this.decode_value(e)},r.prototype.decode_value=function(e){if(typeof e=="string"){if(ir.includes(e))return this.decode_integer(e);if(e==="string")return this.decode_string();if(e==="bool")return this.decode_boolean()}if(typeof e=="object"){if("option"in e)return this.decode_option(e);if("enum"in e)return this.decode_enum(e);if("array"in e)return this.decode_array(e);if("set"in e)return this.decode_set(e);if("map"in e)return this.decode_map(e);if("struct"in e)return this.decode_struct(e)}throw new Error("Unsupported type: ".concat(e))},r.prototype.decode_integer=function(e){var t=parseInt(e.substring(1));return t<=32||e=="f64"?this.buffer.consume_value(e):this.decode_bigint(t,e.startsWith("i"))},r.prototype.decode_bigint=function(e,t){t===void 0&&(t=!1);var i=e/8,o=new Uint8Array(this.buffer.consume_bytes(i)),n=o.reduceRight(function(s,a){return s+a.toString(16).padStart(2,"0")},"");return t&&o[i-1]?BigInt.asIntN(e,BigInt("0x".concat(n))):BigInt("0x".concat(n))},r.prototype.decode_string=function(){for(var e=this.decode_integer("u32"),t=new Uint8Array(this.buffer.consume_bytes(e)),i=[],o=0;o<e;++o){var n=t[o];if(n<128)i.push(n);else if(n<224)i.push((n&31)<<6|t[++o]&63);else if(n<240)i.push((n&15)<<12|(t[++o]&63)<<6|t[++o]&63);else{var s=(n&7)<<18|(t[++o]&63)<<12|(t[++o]&63)<<6|t[++o]&63;i.push(s)}}return String.fromCodePoint.apply(String,i)},r.prototype.decode_boolean=function(){return this.buffer.consume_value("u8")>0},r.prototype.decode_option=function(e){var t=this.buffer.consume_value("u8");if(t===1)return this.decode_value(e.option);if(t!==0)throw new Error("Invalid option ".concat(t));return null},r.prototype.decode_enum=function(e){var t,i=this.buffer.consume_value("u8");if(i>e.enum.length)throw new Error("Enum option ".concat(i," is not available"));var o=e.enum[i].struct,n=Object.keys(o)[0];return t={},t[n]=this.decode_value(o[n]),t},r.prototype.decode_array=function(e){for(var t=[],i=e.array.len?e.array.len:this.decode_integer("u32"),o=0;o<i;++o)t.push(this.decode_value(e.array.type));return t},r.prototype.decode_set=function(e){for(var t=this.decode_integer("u32"),i=new Set,o=0;o<t;++o)i.add(this.decode_value(e.set));return i},r.prototype.decode_map=function(e){for(var t=this.decode_integer("u32"),i=new Map,o=0;o<t;++o){var n=this.decode_value(e.map.key),s=this.decode_value(e.map.value);i.set(n,s)}return i},r.prototype.decode_struct=function(e){var t={};for(var i in e.struct)t[i]=this.decode_value(e.struct[i]);return t},r}();function Mn(r,e,t){t===void 0&&(t=!0),t&&ut(r);var i=new Tn(t);return i.encode(e,r)}function Wn(r,e,t){t===void 0&&(t=!0),t&&ut(r);var i=new On(e);return i.decode(r)}var Ae=Uint8Array,Ve=Uint16Array,or=Int32Array,Vt=new Ae([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Ht=new Ae([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),er=new Ae([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Fr=function(r,e){for(var t=new Ve(31),i=0;i<31;++i)t[i]=e+=1<<r[i-1];for(var o=new or(t[30]),i=1;i<30;++i)for(var n=t[i];n<t[i+1];++n)o[n]=n-t[i]<<5|i;return{b:t,r:o}},jr=Fr(Vt,2),Ar=jr.b,tr=jr.r;Ar[28]=258,tr[258]=28;var Ir=Fr(Ht,0),Pn=Ir.b,gr=Ir.r,rr=new Ve(32768);for(var _e=0;_e<32768;++_e){var ht=(_e&43690)>>1|(_e&21845)<<1;ht=(ht&52428)>>2|(ht&13107)<<2,ht=(ht&61680)>>4|(ht&3855)<<4,rr[_e]=((ht&65280)>>8|(ht&255)<<8)>>1}var ot=function(r,e,t){for(var i=r.length,o=0,n=new Ve(e);o<i;++o)r[o]&&++n[r[o]-1];var s=new Ve(e);for(o=1;o<e;++o)s[o]=s[o-1]+n[o-1]<<1;var a;if(t){a=new Ve(1<<e);var c=15-e;for(o=0;o<i;++o)if(r[o])for(var h=o<<4|r[o],u=e-r[o],l=s[r[o]-1]++<<u,f=l|(1<<u)-1;l<=f;++l)a[rr[l]>>c]=h}else for(a=new Ve(i),o=0;o<i;++o)r[o]&&(a[o]=rr[s[r[o]-1]++]>>15-r[o]);return a},yt=new Ae(288);for(var _e=0;_e<144;++_e)yt[_e]=8;for(var _e=144;_e<256;++_e)yt[_e]=9;for(var _e=256;_e<280;++_e)yt[_e]=7;for(var _e=280;_e<288;++_e)yt[_e]=8;var Nt=new Ae(32);for(var _e=0;_e<32;++_e)Nt[_e]=5;var Rn=ot(yt,9,0),En=ot(yt,9,1),Dn=ot(Nt,5,0),Fn=ot(Nt,5,1),$t=function(r){for(var e=r[0],t=1;t<r.length;++t)r[t]>e&&(e=r[t]);return e},qe=function(r,e,t){var i=e/8|0;return(r[i]|r[i+1]<<8)>>(e&7)&t},Jt=function(r,e){var t=e/8|0;return(r[t]|r[t+1]<<8|r[t+2]<<16)>>(e&7)},sr=function(r){return(r+7)/8|0},zr=function(r,e,t){return(t==null||t>r.length)&&(t=r.length),new Ae(r.subarray(e,t))},jn=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Ue=function(r,e,t){var i=new Error(e||jn[r]);if(i.code=r,Error.captureStackTrace&&Error.captureStackTrace(i,Ue),!t)throw i;return i},ar=function(r,e,t,i){var o=r.length,n=0;if(!o||e.f&&!e.l)return t||new Ae(0);var s=!t,a=s||e.i!=2,c=e.i;s&&(t=new Ae(o*3));var h=function(Te){var Le=t.length;if(Te>Le){var Ie=new Ae(Math.max(Le*2,Te));Ie.set(t),t=Ie}},u=e.f||0,l=e.p||0,f=e.b||0,p=e.l,m=e.d,y=e.m,v=e.n,x=o*8;do{if(!p){u=qe(r,l,1);var g=qe(r,l+1,3);if(l+=3,g)if(g==1)p=En,m=Fn,y=9,v=5;else if(g==2){var k=qe(r,l,31)+257,w=qe(r,l+10,15)+4,j=k+qe(r,l+5,31)+1;l+=14;for(var M=new Ae(j),J=new Ae(19),Z=0;Z<w;++Z)J[er[Z]]=qe(r,l+Z*3,7);l+=w*3;for(var H=$t(J),X=(1<<H)-1,C=ot(J,H,1),Z=0;Z<j;){var K=C[qe(r,l,X)];l+=K&15;var d=K>>4;if(d<16)M[Z++]=d;else{var ee=0,L=0;for(d==16?(L=3+qe(r,l,3),l+=2,ee=M[Z-1]):d==17?(L=3+qe(r,l,7),l+=3):d==18&&(L=11+qe(r,l,127),l+=7);L--;)M[Z++]=ee}}var Y=M.subarray(0,k),V=M.subarray(k);y=$t(Y),v=$t(V),p=ot(Y,y,1),m=ot(V,v,1)}else Ue(1);else{var d=sr(l)+4,b=r[d-4]|r[d-3]<<8,_=d+b;if(_>o){c&&Ue(0);break}a&&h(f+b),t.set(r.subarray(d,_),f),e.b=f+=b,e.p=l=_*8,e.f=u;continue}if(l>x){c&&Ue(0);break}}a&&h(f+131072);for(var W=(1<<y)-1,I=(1<<v)-1,U=l;;U=l){var ee=p[Jt(r,l)&W],q=ee>>4;if(l+=ee&15,l>x){c&&Ue(0);break}if(ee||Ue(2),q<256)t[f++]=q;else if(q==256){U=l,p=null;break}else{var ue=q-254;if(q>264){var Z=q-257,ae=Vt[Z];ue=qe(r,l,(1<<ae)-1)+Ar[Z],l+=ae}var xe=m[Jt(r,l)&I],ke=xe>>4;xe||Ue(3),l+=xe&15;var V=Pn[ke];if(ke>3){var ae=Ht[ke];V+=Jt(r,l)&(1<<ae)-1,l+=ae}if(l>x){c&&Ue(0);break}a&&h(f+131072);var Me=f+ue;if(f<V){var Ce=n-V,Ze=Math.min(V,Me);for(Ce+f<0&&Ue(3);f<Ze;++f)t[f]=i[Ce+f]}for(;f<Me;++f)t[f]=t[f-V]}}e.l=p,e.p=U,e.b=f,e.f=u,p&&(u=1,e.m=y,e.d=m,e.n=v)}while(!u);return f!=t.length&&s?zr(t,0,f):t.subarray(0,f)},ct=function(r,e,t){t<<=e&7;var i=e/8|0;r[i]|=t,r[i+1]|=t>>8},Wt=function(r,e,t){t<<=e&7;var i=e/8|0;r[i]|=t,r[i+1]|=t>>8,r[i+2]|=t>>16},qt=function(r,e){for(var t=[],i=0;i<r.length;++i)r[i]&&t.push({s:i,f:r[i]});var o=t.length,n=t.slice();if(!o)return{t:Lr,l:0};if(o==1){var s=new Ae(t[0].s+1);return s[t[0].s]=1,{t:s,l:1}}t.sort(function(_,k){return _.f-k.f}),t.push({s:-1,f:25001});var a=t[0],c=t[1],h=0,u=1,l=2;for(t[0]={s:-1,f:a.f+c.f,l:a,r:c};u!=o-1;)a=t[t[h].f<t[l].f?h++:l++],c=t[h!=u&&t[h].f<t[l].f?h++:l++],t[u++]={s:-1,f:a.f+c.f,l:a,r:c};for(var f=n[0].s,i=1;i<o;++i)n[i].s>f&&(f=n[i].s);var p=new Ve(f+1),m=nr(t[u-1],p,0);if(m>e){var i=0,y=0,v=m-e,x=1<<v;for(n.sort(function(k,w){return p[w.s]-p[k.s]||k.f-w.f});i<o;++i){var g=n[i].s;if(p[g]>e)y+=x-(1<<m-p[g]),p[g]=e;else break}for(y>>=v;y>0;){var d=n[i].s;p[d]<e?y-=1<<e-p[d]++-1:++i}for(;i>=0&&y;--i){var b=n[i].s;p[b]==e&&(--p[b],++y)}m=e}return{t:new Ae(p),l:m}},nr=function(r,e,t){return r.s==-1?Math.max(nr(r.l,e,t+1),nr(r.r,e,t+1)):e[r.s]=t},wr=function(r){for(var e=r.length;e&&!r[--e];);for(var t=new Ve(++e),i=0,o=r[0],n=1,s=function(c){t[i++]=c},a=1;a<=e;++a)if(r[a]==o&&a!=e)++n;else{if(!o&&n>2){for(;n>138;n-=138)s(32754);n>2&&(s(n>10?n-11<<5|28690:n-3<<5|12305),n=0)}else if(n>3){for(s(o),--n;n>6;n-=6)s(8304);n>2&&(s(n-3<<5|8208),n=0)}for(;n--;)s(o);n=1,o=r[a]}return{c:t.subarray(0,i),n:e}},Pt=function(r,e){for(var t=0,i=0;i<e.length;++i)t+=r[i]*e[i];return t},Nr=function(r,e,t){var i=t.length,o=sr(e+2);r[o]=i&255,r[o+1]=i>>8,r[o+2]=r[o]^255,r[o+3]=r[o+1]^255;for(var n=0;n<i;++n)r[o+n+4]=t[n];return(o+4+i)*8},br=function(r,e,t,i,o,n,s,a,c,h,u){ct(e,u++,t),++o[256];for(var l=qt(o,15),f=l.t,p=l.l,m=qt(n,15),y=m.t,v=m.l,x=wr(f),g=x.c,d=x.n,b=wr(y),_=b.c,k=b.n,w=new Ve(19),j=0;j<g.length;++j)++w[g[j]&31];for(var j=0;j<_.length;++j)++w[_[j]&31];for(var M=qt(w,7),J=M.t,Z=M.l,H=19;H>4&&!J[er[H-1]];--H);var X=h+5<<3,C=Pt(o,yt)+Pt(n,Nt)+s,K=Pt(o,f)+Pt(n,y)+s+14+3*H+Pt(w,J)+2*w[16]+3*w[17]+7*w[18];if(c>=0&&X<=C&&X<=K)return Nr(e,u,r.subarray(c,c+h));var ee,L,Y,V;if(ct(e,u,1+(K<C)),u+=2,K<C){ee=ot(f,p,0),L=f,Y=ot(y,v,0),V=y;var W=ot(J,Z,0);ct(e,u,d-257),ct(e,u+5,k-1),ct(e,u+10,H-4),u+=14;for(var j=0;j<H;++j)ct(e,u+3*j,J[er[j]]);u+=3*H;for(var I=[g,_],U=0;U<2;++U)for(var q=I[U],j=0;j<q.length;++j){var ue=q[j]&31;ct(e,u,W[ue]),u+=J[ue],ue>15&&(ct(e,u,q[j]>>5&127),u+=q[j]>>12)}}else ee=Rn,L=yt,Y=Dn,V=Nt;for(var j=0;j<a;++j){var ae=i[j];if(ae>255){var ue=ae>>18&31;Wt(e,u,ee[ue+257]),u+=L[ue+257],ue>7&&(ct(e,u,ae>>23&31),u+=Vt[ue]);var xe=ae&31;Wt(e,u,Y[xe]),u+=V[xe],xe>3&&(Wt(e,u,ae>>5&8191),u+=Ht[xe])}else Wt(e,u,ee[ae]),u+=L[ae]}return Wt(e,u,ee[256]),u+L[256]},An=new or([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Lr=new Ae(0),In=function(r,e,t,i,o,n){var s=n.z||r.length,a=new Ae(i+s+5*(1+Math.ceil(s/7e3))+o),c=a.subarray(i,a.length-o),h=n.l,u=(n.r||0)&7;if(e){u&&(c[0]=n.r>>3);for(var l=An[e-1],f=l>>13,p=l&8191,m=(1<<t)-1,y=n.p||new Ve(32768),v=n.h||new Ve(m+1),x=Math.ceil(t/3),g=2*x,d=function(st){return(r[st]^r[st+1]<<x^r[st+2]<<g)&m},b=new or(25e3),_=new Ve(288),k=new Ve(32),w=0,j=0,M=n.i||0,J=0,Z=n.w||0,H=0;M+2<s;++M){var X=d(M),C=M&32767,K=v[X];if(y[C]=K,v[X]=C,Z<=M){var ee=s-M;if((w>7e3||J>24576)&&(ee>423||!h)){u=br(r,c,0,b,_,k,j,J,H,M-H,u),J=w=j=0,H=M;for(var L=0;L<286;++L)_[L]=0;for(var L=0;L<30;++L)k[L]=0}var Y=2,V=0,W=p,I=C-K&32767;if(ee>2&&X==d(M-I))for(var U=Math.min(f,ee)-1,q=Math.min(32767,M),ue=Math.min(258,ee);I<=q&&--W&&C!=K;){if(r[M+Y]==r[M+Y-I]){for(var ae=0;ae<ue&&r[M+ae]==r[M+ae-I];++ae);if(ae>Y){if(Y=ae,V=I,ae>U)break;for(var xe=Math.min(I,ae-2),ke=0,L=0;L<xe;++L){var Me=M-I+L&32767,Ce=y[Me],Ze=Me-Ce&32767;Ze>ke&&(ke=Ze,K=Me)}}}C=K,K=y[C],I+=C-K&32767}if(V){b[J++]=268435456|tr[Y]<<18|gr[V];var Te=tr[Y]&31,Le=gr[V]&31;j+=Vt[Te]+Ht[Le],++_[257+Te],++k[Le],Z=M+Y,++w}else b[J++]=r[M],++_[r[M]]}}for(M=Math.max(M,Z);M<s;++M)b[J++]=r[M],++_[r[M]];u=br(r,c,h,b,_,k,j,J,H,M-H,u),h||(n.r=u&7|c[u/8|0]<<3,u-=7,n.h=v,n.p=y,n.i=M,n.w=Z)}else{for(var M=n.w||0;M<s+h;M+=65535){var Ie=M+65535;Ie>=s&&(c[u/8|0]=h,Ie=s),u=Nr(c,u+1,r.subarray(M,Ie))}n.i=s}return zr(a,0,i+sr(u)+o)},zn=function(r,e,t,i,o){if(!o&&(o={l:1},e.dictionary)){var n=e.dictionary.subarray(-32768),s=new Ae(n.length+r.length);s.set(n),s.set(r,n.length),r=s,o.w=n.length}return In(r,e.level==null?6:e.level,e.mem==null?o.l?Math.ceil(Math.max(8,Math.min(13,Math.log(r.length)))*1.5):20:12+e.mem,t,i,o)},Nn=function(r){(r[0]!=31||r[1]!=139||r[2]!=8)&&Ue(6,"invalid gzip data");var e=r[3],t=10;e&4&&(t+=(r[10]|r[11]<<8)+2);for(var i=(e>>3&1)+(e>>4&1);i>0;i-=!r[t++]);return t+(e&2)},Ln=function(r){var e=r.length;return(r[e-4]|r[e-3]<<8|r[e-2]<<16|r[e-1]<<24)>>>0},Gn=function(r,e){return((r[0]&15)!=8||r[0]>>4>7||(r[0]<<8|r[1])%31)&&Ue(6,"invalid zlib data"),(r[1]>>5&1)==1&&Ue(6,"invalid zlib data: "+(r[1]&32?"need":"unexpected")+" dictionary"),(r[1]>>3&4)+2};function Bn(r,e){return zn(r,e||{},0,0)}function Cn(r,e){return ar(r,{i:2},e,e)}function Zn(r,e){var t=Nn(r);return t+8>r.length&&Ue(6,"invalid gzip data"),ar(r.subarray(t,-8),{i:2},new Ae(Ln(r)),e)}function Xn(r,e){return ar(r.subarray(Gn(r),-4),{i:2},e,e)}function Yn(r,e){return r[0]==31&&r[1]==139&&r[2]==8?Zn(r,e):(r[0]&15)!=8||r[0]>>4>7||(r[0]<<8|r[1])%31?Cn(r,e):Xn(r,e)}var Un=typeof TextDecoder<"u"&&new TextDecoder,Vn=0;try{Un.decode(Lr,{stream:!0}),Vn=1}catch{}const Gr=Object.freeze({struct:{id:"string",size:"i32",x:"i32",z:"i32",level:"u8",texture:{struct:{size:"i32",data:{array:{type:"u8"}}}}}}),_r=r=>Bn(Mn(Gr,r),{level:9}),Hn=r=>Wn(Gr,Yn(r)),Qn=({biomes:r,defaultColor:e=[0,0,0,0]})=>{const t=r.map(({map:h,heightmap:u,biome:l,temperature:f,moisture:p,weight:m})=>{const y=h.heightmap.find(({noise:d})=>u>=d)?.color||e,v=h.biome.find(({noise:d})=>l>=d)?.color||e,x=h.temperature.find(({noise:d})=>f>=d)?.color||e,g=h.moisture.find(({noise:d})=>p>=d)?.color||e;return{color:on([Math.max(0,Math.min(360,y[0]+v[0]+x[0]+g[0])),Math.max(0,Math.min(100,y[1]+v[1]+x[1]+g[1])),Math.max(0,Math.min(100,y[2]+v[2]+x[2]+g[2])),Math.max(0,Math.min(1,y[3]+v[3]+x[3]+g[3]))]),weight:m}}),i=2;let o=0,[n,s,a,c]=[0,0,0,0];for(const{color:h,weight:u}of t){const l=u**i;n+=h[0]*l,s+=h[1]*l,a+=h[2]*l,c+=h[3]*l,o+=l}return o>0&&(n/=o,s/=o,a/=o,c/=o),[n,s,a,c]},$n=({seed:r,gameConfig:e,level:t})=>{const i=1/(e.plotCount*(1/t.layer.level)),o=e.biome.map(n=>n.noise({seed:r}));return({x:n,z:s})=>{const a=e.plotCount**2,c=new Uint8Array(a*4);for(let l=0;l<a;l++){const f=l%e.plotCount,p=Math.floor(l/e.plotCount),m=(n*e.plotCount+l%e.plotCount)*i,y=(s*e.plotCount+Math.floor(l/e.plotCount))*i;c.set(Qn({biomes:o.map((v,x)=>({map:e.biome[x].colorMap,weight:e.biome[x].weight,heightmap:v.heightmap(m,y),biome:v.biome(m,y),temperature:v.temperature(m,y),moisture:v.moisture(m,y)}))}),((e.plotCount-1-p)*e.plotCount+f)*4)}const h=e.chunkSize*t.layer.level,u=e.chunkSize*(t.layer.level-1)/2;return{id:`${n}:${s}:${t.layer.level}`,x:n*h+u,z:s*h+u,size:h,level:t.layer.level,texture:{size:e.plotCount,data:c}}}};async function Jn({id:r,mapId:e,level:t,x:i,z:o}){const n=$n({gameConfig:dn,seed:e,level:t}),s=`/chunk/${e}/${r}.bin`;return new Promise(a=>{xt(s).exists().then(c=>{(c?Xt(s,_r(n({x:i,z:o}))).then(()=>!1):Xt(s,_r(n({x:i,z:o}))).then(()=>!1)).then(h=>{xt(s).arrayBuffer().then(u=>{a({hit:h,chunk:Hn(new Uint8Array(u))})})})})})}rn.worker({chunkOf:Jn});
